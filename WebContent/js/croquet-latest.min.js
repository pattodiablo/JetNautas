parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"gS1u":[function(require,module,exports) {
function r(r){if(Array.isArray(r))return r}module.exports=r;
},{}],"xf9w":[function(require,module,exports) {
function r(r,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var e=[],n=!0,o=!1,l=void 0;try{for(var i,u=r[Symbol.iterator]();!(n=(i=u.next()).done)&&(e.push(i.value),!t||e.length!==t);n=!0);}catch(a){o=!0,l=a}finally{try{n||null==u.return||u.return()}finally{if(o)throw l}}return e}}module.exports=r;
},{}],"h39S":[function(require,module,exports) {
function n(n,r){(null==r||r>n.length)&&(r=n.length);for(var e=0,l=new Array(r);e<r;e++)l[e]=n[e];return l}module.exports=n;
},{}],"FHJE":[function(require,module,exports) {
var r=require("./arrayLikeToArray");function t(t,e){if(t){if("string"==typeof t)return r(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?r(t,e):void 0}}module.exports=t;
},{"./arrayLikeToArray":"h39S"}],"XxeS":[function(require,module,exports) {
function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}module.exports=e;
},{}],"qmoa":[function(require,module,exports) {
var r=require("./arrayWithHoles"),e=require("./iterableToArrayLimit"),t=require("./unsupportedIterableToArray"),i=require("./nonIterableRest");function u(u,a){return r(u)||e(u,a)||t(u,a)||i()}module.exports=u;
},{"./arrayWithHoles":"gS1u","./iterableToArrayLimit":"xf9w","./unsupportedIterableToArray":"FHJE","./nonIterableRest":"XxeS"}],"rsNN":[function(require,module,exports) {
function n(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}module.exports=n;
},{}],"rYje":[function(require,module,exports) {
function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function r(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}module.exports=r;
},{}],"Vopi":[function(require,module,exports) {
var r=require("./arrayLikeToArray");function a(a){if(Array.isArray(a))return r(a)}module.exports=a;
},{"./arrayLikeToArray":"h39S"}],"dzIy":[function(require,module,exports) {
function e(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}module.exports=e;
},{}],"qtGd":[function(require,module,exports) {
function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}module.exports=e;
},{}],"wyMK":[function(require,module,exports) {
var r=require("./arrayWithoutHoles"),e=require("./iterableToArray"),u=require("./unsupportedIterableToArray"),a=require("./nonIterableSpread");function o(o){return r(o)||e(o)||u(o)||a()}module.exports=o;
},{"./arrayWithoutHoles":"Vopi","./iterableToArray":"dzIy","./unsupportedIterableToArray":"FHJE","./nonIterableSpread":"qtGd"}],"RTfL":[function(require,module,exports) {
function o(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?module.exports=o=function(o){return typeof o}:module.exports=o=function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},o(t)}module.exports=o;
},{}],"PLl6":[function(require,module,exports) {
function e(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}module.exports=e;
},{}],"xxUX":[function(require,module,exports) {
var t=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,r,e,n){var o=r&&r.prototype instanceof v?r:v,i=Object.create(o.prototype),a=new k(n||[]);return i._invoke=function(t,r,e){var n=f;return function(o,i){if(n===l)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return N()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=_(a,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===f)throw n=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=l;var u=h(t,r,e);if("normal"===u.type){if(n=e.done?p:s,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=p,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=u;var f="suspendedStart",s="suspendedYield",l="executing",p="completed",y={};function v(){}function d(){}function g(){}var m={};m[i]=function(){return this};var w=Object.getPrototypeOf,L=w&&w(w(G([])));L&&L!==e&&n.call(L,i)&&(m=L);var x=g.prototype=v.prototype=Object.create(m);function E(t){["next","throw","return"].forEach(function(r){t[r]=function(t){return this._invoke(r,t)}})}function b(t,r){var e;this._invoke=function(o,i){function a(){return new r(function(e,a){!function e(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var f=u.arg,s=f.value;return s&&"object"==typeof s&&n.call(s,"__await")?r.resolve(s.__await).then(function(t){e("next",t,a,c)},function(t){e("throw",t,a,c)}):r.resolve(s).then(function(t){f.value=t,a(f)},function(t){return e("throw",t,a,c)})}c(u.arg)}(o,i,e,a)})}return e=e?e.then(a,a):a()}}function _(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,_(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function j(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function O(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function G(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:N}}function N(){return{value:r,done:!0}}return d.prototype=x.constructor=g,g.constructor=d,g[c]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},E(b.prototype),b.prototype[a]=function(){return this},t.AsyncIterator=b,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var a=new b(u(r,e,n,o),i);return t.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(x),x[c]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=G,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),O(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;O(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:G(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}
},{}],"wCDd":[function(require,module,exports) {
module.exports=require("regenerator-runtime");
},{"regenerator-runtime":"xxUX"}],"zdnk":[function(require,module,exports) {
function n(n,t,o,r,e,i,u){try{var c=n[i](u),v=c.value}catch(a){return void o(a)}c.done?t(v):Promise.resolve(v).then(r,e)}function t(t){return function(){var o=this,r=arguments;return new Promise(function(e,i){var u=t.apply(o,r);function c(t){n(u,e,i,c,v,"next",t)}function v(t){n(u,e,i,c,v,"throw",t)}c(void 0)})}}module.exports=t;
},{}],"vwDV":[function(require,module,exports) {
"use strict";module.exports=function(r,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var e,n="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(e=t.cmp,function(r){return function(t,n){var i={key:t,value:r[t]},u={key:n,value:r[n]};return e(i,u)}}),u=[];return function r(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var e,o;if(Array.isArray(t)){for(o="[",e=0;e<t.length;e++)e&&(o+=","),o+=r(t[e])||"null";return o+"]"}if(null===t)return"null";if(-1!==u.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var f=u.push(t)-1,c=Object.keys(t).sort(i&&i(t));for(o="",e=0;e<c.length;e++){var l=c[e],y=r(t[l]);y&&(o&&(o+=","),o+=JSON.stringify(l)+":"+y)}return u.splice(f,1),"{"+o+"}"}}(r)};
},{}],"D2QR":[function(require,module,exports) {
!function(t,o){"object"==typeof module&&module.exports?module.exports=o():t.Toastify=o()}(this,function(t){var o=function(t){return new o.lib.init(t)};function i(t,o){return!(!t||"string"!=typeof o)&&!!(t.className&&t.className.trim().split(/\s+/gi).indexOf(o)>-1)}return o.lib=o.prototype={toastify:"1.7.0",constructor:o,init:function(t){return t||(t={}),this.options={},this.toastElement=null,this.options.text=t.text||"Hi there!",this.options.duration=0===t.duration?0:t.duration||3e3,this.options.selector=t.selector,this.options.callback=t.callback||function(){},this.options.destination=t.destination,this.options.newWindow=t.newWindow||!1,this.options.close=t.close||!1,this.options.gravity="bottom"===t.gravity?"toastify-bottom":"toastify-top",this.options.positionLeft=t.positionLeft||!1,this.options.position=t.position||"",this.options.backgroundColor=t.backgroundColor,this.options.avatar=t.avatar||"",this.options.className=t.className||"",this.options.stopOnFocus=void 0===t.stopOnFocus||t.stopOnFocus,this.options.onClick=t.onClick,this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var t=document.createElement("div");if(t.className="toastify on "+this.options.className,this.options.position?t.className+=" toastify-"+this.options.position:!0===this.options.positionLeft?(t.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):t.className+=" toastify-right",t.className+=" "+this.options.gravity,this.options.backgroundColor&&(t.style.background=this.options.backgroundColor),t.innerHTML=this.options.text,""!==this.options.avatar){var o=document.createElement("img");o.src=this.options.avatar,o.className="toastify-avatar","left"==this.options.position||!0===this.options.positionLeft?t.appendChild(o):t.insertAdjacentElement("beforeend",o)}if(!0===this.options.close){var i=document.createElement("span");i.innerHTML="&#10006;",i.className="toast-close",i.addEventListener("click",function(t){t.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}.bind(this));var s=window.innerWidth>0?window.innerWidth:screen.width;("left"==this.options.position||!0===this.options.positionLeft)&&s>360?t.insertAdjacentElement("afterbegin",i):t.appendChild(i)}if(this.options.stopOnFocus&&this.options.duration>0){const o=this;t.addEventListener("mouseover",function(o){window.clearTimeout(t.timeOutValue)}),t.addEventListener("mouseleave",function(){t.timeOutValue=window.setTimeout(function(){o.removeElement(t)},o.options.duration)})}return void 0!==this.options.destination&&t.addEventListener("click",function(t){t.stopPropagation(),!0===this.options.newWindow?window.open(this.options.destination,"_blank"):window.location=this.options.destination}.bind(this)),"function"==typeof this.options.onClick&&void 0===this.options.destination&&t.addEventListener("click",function(t){t.stopPropagation(),this.options.onClick()}.bind(this)),t},showToast:function(){var t;if(this.toastElement=this.buildToast(),!(t=void 0===this.options.selector?document.body:document.getElementById(this.options.selector)))throw"Root element is not defined";return t.insertBefore(this.toastElement,t.firstChild),o.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout(function(){this.removeElement(this.toastElement)}.bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(t){t.className=t.className.replace(" on",""),window.setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t),this.options.callback.call(t),o.reposition()}.bind(this),400)}},o.reposition=function(){for(var t,o={top:15,bottom:15},s={top:15,bottom:15},n={top:15,bottom:15},e=document.getElementsByClassName("toastify"),a=0;a<e.length;a++){t=!0===i(e[a],"toastify-top")?"toastify-top":"toastify-bottom";var r=e[a].offsetHeight;t=t.substr(9,t.length-1);(window.innerWidth>0?window.innerWidth:screen.width)<=360?(e[a].style[t]=n[t]+"px",n[t]+=r+15):!0===i(e[a],"toastify-left")?(e[a].style[t]=o[t]+"px",o[t]+=r+15):(e[a].style[t]=s[t]+"px",s[t]+=r+15)}return this},o.lib.init.prototype=o.lib,o});
},{}],"KVVd":[function(require,module,exports) {

},{}],"u80Q":[function(require,module,exports) {
var global = arguments[3];
var define;
var r,n=arguments[3];!function(n,t){var e,o=(0,eval)("this"),u=256,i=6,a="random",c=t.pow(u,i),f=t.pow(2,52),s=2*f,l=u-1;function p(r,l,p){var v=[],m=h(function r(n,t){var e,o=[],u=typeof n;if(t&&"object"==u)for(e in n)try{o.push(r(n[e],t-1))}catch(i){}return o.length?o:"string"==u?n:n+"\0"}((l=1==l?{entropy:!0}:l||{}).entropy?[r,d(n)]:null==r?function(){try{var r;return e&&(r=e.randomBytes)?r=r(u):(r=new Uint8Array(u),(o.crypto||o.msCrypto).getRandomValues(r)),d(r)}catch(a){var t=o.navigator,i=t&&t.plugins;return[+new Date,o,i,o.screen,d(n)]}}():r,3),v),j=new g(v),S=function(){for(var r=j.g(i),n=c,t=0;r<f;)r=(r+t)*u,n*=u,t=j.g(1);for(;r>=s;)r/=2,n/=2,t>>>=1;return(r+t)/n};return S.int32=function(){return 0|j.g(4)},S.quick=function(){return j.g(4)/4294967296},S.double=S,h(d(j.S),n),(l.pass||p||function(r,n,e,o){return o&&(o.S&&y(o,j),r.state=function(){return y(j,{})}),e?(t[a]=r,n):r})(S,m,"global"in l?l.global:this==t,l.state)}function g(r){var n,t=r.length,e=this,o=0,i=e.i=e.j=0,a=e.S=[];for(t||(r=[t++]);o<u;)a[o]=o++;for(o=0;o<u;o++)a[o]=a[i=l&i+r[o%t]+(n=a[o])],a[i]=n;(e.g=function(r){for(var n,t=0,o=e.i,i=e.j,a=e.S;r--;)n=a[o=l&o+1],t=t*u+a[l&(a[o]=a[i=l&i+n])+(a[i]=n)];return e.i=o,e.j=i,t})(u)}function y(r,n){return n.i=r.i,n.j=r.j,n.S=r.S.slice(),n}function h(r,n){for(var t,e=r+"",o=0;o<e.length;)n[l&o]=l&(t^=19*n[l&o])+e.charCodeAt(o++);return d(n)}function d(r){return String.fromCharCode.apply(0,r)}if(t["seed"+a]=p,h(t.random(),n),"object"==typeof module&&module.exports){module.exports=p;try{e=require("crypto")}catch(v){}}else"function"==typeof r&&r.amd&&r(function(){return p})}([],Math);
},{"crypto":"KVVd"}],"Mrsy":[function(require,module,exports) {
function t(e){return module.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t(e)}module.exports=t;
},{}],"jOCc":[function(require,module,exports) {
var r=require("./getPrototypeOf");function e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}module.exports=e;
},{"./getPrototypeOf":"Mrsy"}],"V9yb":[function(require,module,exports) {
var e=require("./superPropBase");function t(r,o,u){return"undefined"!=typeof Reflect&&Reflect.get?module.exports=t=Reflect.get:module.exports=t=function(t,r,o){var u=e(t,r);if(u){var l=Object.getOwnPropertyDescriptor(u,r);return l.get?l.get.call(o):l.value}},t(r,o,u||r)}module.exports=t;
},{"./superPropBase":"jOCc"}],"fHK5":[function(require,module,exports) {
function t(o,e){return module.exports=t=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},t(o,e)}module.exports=t;
},{}],"NdUb":[function(require,module,exports) {
var e=require("./setPrototypeOf");function r(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&e(r,t)}module.exports=r;
},{"./setPrototypeOf":"fHK5"}],"KZS0":[function(require,module,exports) {
function e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}module.exports=e;
},{}],"Guyn":[function(require,module,exports) {
var e=require("../helpers/typeof"),r=require("./assertThisInitialized");function t(t,i){return!i||"object"!==e(i)&&"function"!=typeof i?r(t):i}module.exports=t;
},{"../helpers/typeof":"RTfL","./assertThisInitialized":"KZS0"}],"wmWq":[function(require,module,exports) {
"use strict";var t=function(t,r){return t<r};function r(i){if(!(this instanceof r))return new r(i);this.array=[],this.size=0,this.compare=i||t}r.prototype.clone=function(){var t=new r(this.compare);t.size=this.size;for(var i=0;i<this.size;i++)t.array.push(this.array[i]);return t},r.prototype.add=function(t){var r,i,e=this.size;for(this.array[this.size]=t,this.size+=1;e>0&&(r=e-1>>1,i=this.array[r],this.compare(t,i));)this.array[e]=i,e=r;this.array[e]=t},r.prototype.heapify=function(t){var r;for(this.array=t,this.size=t.length,r=this.size>>1;r>=0;r--)this._percolateDown(r)},r.prototype._percolateUp=function(t,r){for(var i,e,a=this.array[t];t>0&&(i=t-1>>1,e=this.array[i],r||this.compare(a,e));)this.array[t]=e,t=i;this.array[t]=a},r.prototype._percolateDown=function(t){for(var r,i,e,a=this.size,s=this.size>>>1,o=this.array[t];t<s&&(i=(r=1+(t<<1))+1,e=this.array[r],i<a&&this.compare(this.array[i],e)&&(r=i,e=this.array[i]),this.compare(e,o));)this.array[t]=e,t=r;this.array[t]=o},r.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()},r.prototype.remove=function(t){for(var r=0;r<this.size;r++)if(!this.compare(this.array[r],t)&&!this.compare(t,this.array[r]))return this._removeAt(r),!0;return!1},r.prototype._batchRemove=function(t,r){var i=new Array(r||this.size),e=0;if("function"==typeof t&&this.size)for(var a=0;a<this.size&&e<i.length;)t(this.array[a])?(i[e]=this._removeAt(a),e++,a>>=1):a++;return i.length=e,i},r.prototype.removeOne=function(t){var r=this._batchRemove(t,1);return r.length>0?r[0]:void 0},r.prototype.removeMany=function(t,r){return this._batchRemove(t,r)},r.prototype.peek=function(){if(0!=this.size)return this.array[0]},r.prototype.poll=function(){if(0!=this.size){var t=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,t}},r.prototype.replaceTop=function(t){if(0!=this.size){var r=this.array[0];return this.array[0]=t,this._percolateDown(0),r}},r.prototype.trim=function(){this.array=this.array.slice(0,this.size)},r.prototype.isEmpty=function(){return 0===this.size},r.prototype.forEach=function(t){if(!this.isEmpty()&&"function"==typeof t)for(var r=0,i=this.clone();!i.isEmpty();)t(i.poll(),r++)},r.prototype.kSmallest=function(t){if(0==this.size)return[];var i=this.compare,e=this.array,a=new r(function(t,r){return i(e[t],e[r])});t=Math.min(this.size,t);var s=new Array(t),o=0;for(a.add(0);o<t;){var h=a.poll();s[o++]=this.array[h];var n=1+(h<<1),p=n+1;n<this.size&&a.add(n),p<this.size&&a.add(p)}return s};var i=function(){var t=new r(function(t,r){return t<r});for(t.add(1),t.add(0),t.add(5),t.add(4),t.add(3);!t.isEmpty();)console.log(t.poll())};require.main===module&&i(),module.exports=r;
},{}],"AhBs":[function(require,module,exports) {
var r=require("./arrayWithHoles"),e=require("./iterableToArray"),t=require("./unsupportedIterableToArray"),u=require("./nonIterableRest");function a(a){return r(a)||e(a)||t(a)||u()}module.exports=a;
},{"./arrayWithHoles":"gS1u","./iterableToArray":"dzIy","./unsupportedIterableToArray":"FHJE","./nonIterableRest":"XxeS"}],"Euax":[function(require,module,exports) {
function t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}module.exports=t;
},{}],"lHWF":[function(require,module,exports) {
var e=require("./setPrototypeOf"),t=require("./isNativeReflectConstruct");function r(o,u,n){return t()?module.exports=r=Reflect.construct:module.exports=r=function(t,r,o){var u=[null];u.push.apply(u,r);var n=new(Function.bind.apply(t,u));return o&&e(n,o.prototype),n},r.apply(null,arguments)}module.exports=r;
},{"./setPrototypeOf":"fHK5","./isNativeReflectConstruct":"Euax"}],"JNpU":[function(require,module,exports) {
"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function t(r,t){return Object.prototype.hasOwnProperty.call(r,t)}exports.assign=function(r){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var a in n)t(n,a)&&(r[a]=n[a])}}return r},exports.shrinkBuf=function(r,t){return r.length===t?r:r.subarray?r.subarray(0,t):(r.length=t,r)};var e={arraySet:function(r,t,e,n,a){if(t.subarray&&r.subarray)r.set(t.subarray(e,e+n),a);else for(var o=0;o<n;o++)r[a+o]=t[e+o]},flattenChunks:function(r){var t,e,n,a,o,s;for(n=0,t=0,e=r.length;t<e;t++)n+=r[t].length;for(s=new Uint8Array(n),a=0,t=0,e=r.length;t<e;t++)o=r[t],s.set(o,a),a+=o.length;return s}},n={arraySet:function(r,t,e,n,a){for(var o=0;o<n;o++)r[a+o]=t[e+o]},flattenChunks:function(r){return[].concat.apply([],r)}};exports.setTyped=function(r){r?(exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,e)):(exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,n))},exports.setTyped(r);
},{}],"ckcG":[function(require,module,exports) {
"use strict";var e=require("../utils/common"),t=4,n=0,_=1,r=2;function a(e){for(var t=e.length;--t>=0;)e[t]=0}var i=0,l=1,d=2,f=3,o=258,b=29,s=256,u=s+1+b,c=30,p=19,h=2*u+1,v=15,y=16,x=7,g=256,m=16,w=17,A=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=512,B=new Array(2*(u+2));a(B);var C=new Array(2*c);a(C);var D=new Array(j);a(D);var E=new Array(o-f+1);a(E);var F=new Array(b);a(F);var G,H,I,J=new Array(c);function K(e,t,n,_,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=_,this.max_length=r,this.has_stree=e&&e.length}function L(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function M(e){return e<256?D[e]:D[256+(e>>>7)]}function N(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function O(e,t,n){e.bi_valid>y-n?(e.bi_buf|=t<<e.bi_valid&65535,N(e,e.bi_buf),e.bi_buf=t>>y-e.bi_valid,e.bi_valid+=n-y):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function P(e,t,n){O(e,n[2*t],n[2*t+1])}function Q(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function R(e){16===e.bi_valid?(N(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function T(e,t){var n,_,r,a,i,l,d=t.dyn_tree,f=t.max_code,o=t.stat_desc.static_tree,b=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,u=t.stat_desc.extra_base,c=t.stat_desc.max_length,p=0;for(a=0;a<=v;a++)e.bl_count[a]=0;for(d[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<h;n++)(a=d[2*d[2*(_=e.heap[n])+1]+1]+1)>c&&(a=c,p++),d[2*_+1]=a,_>f||(e.bl_count[a]++,i=0,_>=u&&(i=s[_-u]),l=d[2*_],e.opt_len+=l*(a+i),b&&(e.static_len+=l*(o[2*_+1]+i)));if(0!==p){do{for(a=c-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[c]--,p-=2}while(p>0);for(a=c;0!==a;a--)for(_=e.bl_count[a];0!==_;)(r=e.heap[--n])>f||(d[2*r+1]!==a&&(e.opt_len+=(a-d[2*r+1])*d[2*r],d[2*r+1]=a),_--)}}function U(e,t,n){var _,r,a=new Array(v+1),i=0;for(_=1;_<=v;_++)a[_]=i=i+n[_-1]<<1;for(r=0;r<=t;r++){var l=e[2*r+1];0!==l&&(e[2*r]=Q(a[l]++,l))}}function V(){var e,t,n,_,r,a=new Array(v+1);for(n=0,_=0;_<b-1;_++)for(F[_]=n,e=0;e<1<<k[_];e++)E[n++]=_;for(E[n-1]=_,r=0,_=0;_<16;_++)for(J[_]=r,e=0;e<1<<q[_];e++)D[r++]=_;for(r>>=7;_<c;_++)for(J[_]=r<<7,e=0;e<1<<q[_]-7;e++)D[256+r++]=_;for(t=0;t<=v;t++)a[t]=0;for(e=0;e<=143;)B[2*e+1]=8,e++,a[8]++;for(;e<=255;)B[2*e+1]=9,e++,a[9]++;for(;e<=279;)B[2*e+1]=7,e++,a[7]++;for(;e<=287;)B[2*e+1]=8,e++,a[8]++;for(U(B,u+1,a),e=0;e<c;e++)C[2*e+1]=5,C[2*e]=Q(e,5);G=new K(B,k,s+1,u,v),H=new K(C,q,0,c,v),I=new K(new Array(0),z,0,p,x)}function W(e){var t;for(t=0;t<u;t++)e.dyn_ltree[2*t]=0;for(t=0;t<c;t++)e.dyn_dtree[2*t]=0;for(t=0;t<p;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*g]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function X(e){e.bi_valid>8?N(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Y(t,n,_,r){X(t),r&&(N(t,_),N(t,~_)),e.arraySet(t.pending_buf,t.window,n,_,t.pending),t.pending+=_}function Z(e,t,n,_){var r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&_[t]<=_[n]}function $(e,t,n){for(var _=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&Z(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Z(t,_,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=_}function ee(e,t,n){var _,r,a,i,l=0;if(0!==e.last_lit)do{_=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],r=e.pending_buf[e.l_buf+l],l++,0===_?P(e,r,t):(P(e,(a=E[r])+s+1,t),0!==(i=k[a])&&O(e,r-=F[a],i),P(e,a=M(--_),n),0!==(i=q[a])&&O(e,_-=J[a],i))}while(l<e.last_lit);P(e,g,t)}function te(e,t){var n,_,r,a=t.dyn_tree,i=t.stat_desc.static_tree,l=t.stat_desc.has_stree,d=t.stat_desc.elems,f=-1;for(e.heap_len=0,e.heap_max=h,n=0;n<d;n++)0!==a[2*n]?(e.heap[++e.heap_len]=f=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=f<2?++f:0)]=1,e.depth[r]=0,e.opt_len--,l&&(e.static_len-=i[2*r+1]);for(t.max_code=f,n=e.heap_len>>1;n>=1;n--)$(e,a,n);r=d;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$(e,a,1),_=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=_,a[2*r]=a[2*n]+a[2*_],e.depth[r]=(e.depth[n]>=e.depth[_]?e.depth[n]:e.depth[_])+1,a[2*n+1]=a[2*_+1]=r,e.heap[1]=r++,$(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],T(e,t),U(a,f,e.bl_count)}function ne(e,t,n){var _,r,a=-1,i=t[1],l=0,d=7,f=4;for(0===i&&(d=138,f=3),t[2*(n+1)+1]=65535,_=0;_<=n;_++)r=i,i=t[2*(_+1)+1],++l<d&&r===i||(l<f?e.bl_tree[2*r]+=l:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[2*m]++):l<=10?e.bl_tree[2*w]++:e.bl_tree[2*A]++,l=0,a=r,0===i?(d=138,f=3):r===i?(d=6,f=3):(d=7,f=4))}function _e(e,t,n){var _,r,a=-1,i=t[1],l=0,d=7,f=4;for(0===i&&(d=138,f=3),_=0;_<=n;_++)if(r=i,i=t[2*(_+1)+1],!(++l<d&&r===i)){if(l<f)do{P(e,r,e.bl_tree)}while(0!=--l);else 0!==r?(r!==a&&(P(e,r,e.bl_tree),l--),P(e,m,e.bl_tree),O(e,l-3,2)):l<=10?(P(e,w,e.bl_tree),O(e,l-3,3)):(P(e,A,e.bl_tree),O(e,l-11,7));l=0,a=r,0===i?(d=138,f=3):r===i?(d=6,f=3):(d=7,f=4)}}function re(e){var t;for(ne(e,e.dyn_ltree,e.l_desc.max_code),ne(e,e.dyn_dtree,e.d_desc.max_code),te(e,e.bl_desc),t=p-1;t>=3&&0===e.bl_tree[2*S[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function ae(e,t,n,_){var r;for(O(e,t-257,5),O(e,n-1,5),O(e,_-4,4),r=0;r<_;r++)O(e,e.bl_tree[2*S[r]+1],3);_e(e,e.dyn_ltree,t-1),_e(e,e.dyn_dtree,n-1)}function ie(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return n;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return _;for(t=32;t<s;t++)if(0!==e.dyn_ltree[2*t])return _;return n}a(J);var le=!1;function de(e){le||(V(),le=!0),e.l_desc=new L(e.dyn_ltree,G),e.d_desc=new L(e.dyn_dtree,H),e.bl_desc=new L(e.bl_tree,I),e.bi_buf=0,e.bi_valid=0,W(e)}function fe(e,t,n,_){O(e,(i<<1)+(_?1:0),3),Y(e,t,n,!0)}function oe(e){O(e,l<<1,3),P(e,g,B),R(e)}function be(e,n,_,a){var i,f,o=0;e.level>0?(e.strm.data_type===r&&(e.strm.data_type=ie(e)),te(e,e.l_desc),te(e,e.d_desc),o=re(e),i=e.opt_len+3+7>>>3,(f=e.static_len+3+7>>>3)<=i&&(i=f)):i=f=_+5,_+4<=i&&-1!==n?fe(e,n,_,a):e.strategy===t||f===i?(O(e,(l<<1)+(a?1:0),3),ee(e,B,C)):(O(e,(d<<1)+(a?1:0),3),ae(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),ee(e,e.dyn_ltree,e.dyn_dtree)),W(e),a&&X(e)}function se(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(E[n]+s+1)]++,e.dyn_dtree[2*M(t)]++),e.last_lit===e.lit_bufsize-1}exports._tr_init=de,exports._tr_stored_block=fe,exports._tr_flush_block=be,exports._tr_tally=se,exports._tr_align=oe;
},{"../utils/common":"JNpU"}],"PDe7":[function(require,module,exports) {
"use strict";function e(e,r,o,t){for(var u=65535&e|0,i=e>>>16&65535|0,n=0;0!==o;){o-=n=o>2e3?2e3:o;do{i=i+(u=u+r[t++]|0)|0}while(--n);u%=65521,i%=65521}return u|i<<16|0}module.exports=e;
},{}],"Nls6":[function(require,module,exports) {
"use strict";function r(){for(var r,o=[],t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;o[t]=r}return o}var o=r();function t(r,t,n,u){var a=o,e=u+n;r^=-1;for(var f=u;f<e;f++)r=r>>>8^a[255&(r^t[f])];return-1^r}module.exports=t;
},{}],"NGcu":[function(require,module,exports) {
"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};
},{}],"X2fg":[function(require,module,exports) {
"use strict";var t,a=require("../utils/common"),e=require("./trees"),s=require("./adler32"),i=require("./crc32"),r=require("./messages"),n=0,h=1,l=3,_=4,d=5,o=0,u=1,g=-2,f=-3,c=-5,p=-1,m=1,w=2,v=3,k=4,z=0,b=2,x=8,y=9,B=15,S=8,q=29,I=256,A=I+1+q,C=30,R=19,j=2*A+1,D=15,E=3,H=258,K=H+E+1,N=32,F=42,G=69,J=73,L=91,M=103,O=113,P=666,Q=1,T=2,U=3,V=4,W=3;function X(t,a){return t.msg=r[a],a}function Y(t){return(t<<1)-(t>4?9:0)}function Z(t){for(var a=t.length;--a>=0;)t[a]=0}function $(t){var e=t.state,s=e.pending;s>t.avail_out&&(s=t.avail_out),0!==s&&(a.arraySet(t.output,e.pending_buf,e.pending_out,s,t.next_out),t.next_out+=s,e.pending_out+=s,t.total_out+=s,t.avail_out-=s,e.pending-=s,0===e.pending&&(e.pending_out=0))}function tt(t,a){e._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,a),t.block_start=t.strstart,$(t.strm)}function at(t,a){t.pending_buf[t.pending++]=a}function et(t,a){t.pending_buf[t.pending++]=a>>>8&255,t.pending_buf[t.pending++]=255&a}function st(t,e,r,n){var h=t.avail_in;return h>n&&(h=n),0===h?0:(t.avail_in-=h,a.arraySet(e,t.input,t.next_in,h,r),1===t.state.wrap?t.adler=s(t.adler,e,h,r):2===t.state.wrap&&(t.adler=i(t.adler,e,h,r)),t.next_in+=h,t.total_in+=h,h)}function it(t,a){var e,s,i=t.max_chain_length,r=t.strstart,n=t.prev_length,h=t.nice_match,l=t.strstart>t.w_size-K?t.strstart-(t.w_size-K):0,_=t.window,d=t.w_mask,o=t.prev,u=t.strstart+H,g=_[r+n-1],f=_[r+n];t.prev_length>=t.good_match&&(i>>=2),h>t.lookahead&&(h=t.lookahead);do{if(_[(e=a)+n]===f&&_[e+n-1]===g&&_[e]===_[r]&&_[++e]===_[r+1]){r+=2,e++;do{}while(_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&r<u);if(s=H-(u-r),r=u-H,s>n){if(t.match_start=a,n=s,s>=h)break;g=_[r+n-1],f=_[r+n]}}}while((a=o[a&d])>l&&0!=--i);return n<=t.lookahead?n:t.lookahead}function rt(t){var e,s,i,r,n,h=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=h+(h-K)){a.arraySet(t.window,t.window,h,h,0),t.match_start-=h,t.strstart-=h,t.block_start-=h,e=s=t.hash_size;do{i=t.head[--e],t.head[e]=i>=h?i-h:0}while(--s);e=s=h;do{i=t.prev[--e],t.prev[e]=i>=h?i-h:0}while(--s);r+=h}if(0===t.strm.avail_in)break;if(s=st(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=s,t.lookahead+t.insert>=E)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=(t.ins_h<<t.hash_shift^t.window[n+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[n+E-1])&t.hash_mask,t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<E)););}while(t.lookahead<K&&0!==t.strm.avail_in)}function nt(t,a){var e=65535;for(e>t.pending_buf_size-5&&(e=t.pending_buf_size-5);;){if(t.lookahead<=1){if(rt(t),0===t.lookahead&&a===n)return Q;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var s=t.block_start+e;if((0===t.strstart||t.strstart>=s)&&(t.lookahead=t.strstart-s,t.strstart=s,tt(t,!1),0===t.strm.avail_out))return Q;if(t.strstart-t.block_start>=t.w_size-K&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=0,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):(t.strstart>t.block_start&&(tt(t,!1),t.strm.avail_out),Q)}function ht(t,a){for(var s,i;;){if(t.lookahead<K){if(rt(t),t.lookahead<K&&a===n)return Q;if(0===t.lookahead)break}if(s=0,t.lookahead>=E&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==s&&t.strstart-s<=t.w_size-K&&(t.match_length=it(t,s)),t.match_length>=E)if(i=e._tr_tally(t,t.strstart-t.match_start,t.match_length-E),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=E){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=t.strstart<E-1?t.strstart:E-1,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function lt(t,a){for(var s,i,r;;){if(t.lookahead<K){if(rt(t),t.lookahead<K&&a===n)return Q;if(0===t.lookahead)break}if(s=0,t.lookahead>=E&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=E-1,0!==s&&t.prev_length<t.max_lazy_match&&t.strstart-s<=t.w_size-K&&(t.match_length=it(t,s),t.match_length<=5&&(t.strategy===m||t.match_length===E&&t.strstart-t.match_start>4096)&&(t.match_length=E-1)),t.prev_length>=E&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-E,i=e._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-E),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=E-1,t.strstart++,i&&(tt(t,!1),0===t.strm.avail_out))return Q}else if(t.match_available){if((i=e._tr_tally(t,0,t.window[t.strstart-1]))&&tt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Q}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=e._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<E-1?t.strstart:E-1,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function _t(t,a){for(var s,i,r,h,l=t.window;;){if(t.lookahead<=H){if(rt(t),t.lookahead<=H&&a===n)return Q;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=E&&t.strstart>0&&(i=l[r=t.strstart-1])===l[++r]&&i===l[++r]&&i===l[++r]){h=t.strstart+H;do{}while(i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&r<h);t.match_length=H-(h-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=E?(s=e._tr_tally(t,1,t.match_length-E),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(s=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),s&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=0,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function dt(t,a){for(var s;;){if(0===t.lookahead&&(rt(t),0===t.lookahead)){if(a===n)return Q;break}if(t.match_length=0,s=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,s&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=0,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function ot(t,a,e,s,i){this.good_length=t,this.max_lazy=a,this.nice_length=e,this.max_chain=s,this.func=i}function ut(a){a.window_size=2*a.w_size,Z(a.head),a.max_lazy_match=t[a.level].max_lazy,a.good_match=t[a.level].good_length,a.nice_match=t[a.level].nice_length,a.max_chain_length=t[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=E-1,a.match_available=0,a.ins_h=0}function gt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*j),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*R+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(D+1),this.heap=new a.Buf16(2*A+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*A+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ft(t){var a;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=b,(a=t.state).pending=0,a.pending_out=0,a.wrap<0&&(a.wrap=-a.wrap),a.status=a.wrap?F:O,t.adler=2===a.wrap?0:1,a.last_flush=n,e._tr_init(a),o):X(t,g)}function ct(t){var a=ft(t);return a===o&&ut(t.state),a}function pt(t,a){return t&&t.state?2!==t.state.wrap?g:(t.state.gzhead=a,o):g}function mt(t,e,s,i,r,n){if(!t)return g;var h=1;if(e===p&&(e=6),i<0?(h=0,i=-i):i>15&&(h=2,i-=16),r<1||r>y||s!==x||i<8||i>15||e<0||e>9||n<0||n>k)return X(t,g);8===i&&(i=9);var l=new gt;return t.state=l,l.strm=t,l.wrap=h,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+E-1)/E),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=n,l.method=s,ct(t)}function wt(t,a){return mt(t,a,x,B,S,z)}function vt(a,s){var r,f,p,m;if(!a||!a.state||s>d||s<0)return a?X(a,g):g;if(f=a.state,!a.output||!a.input&&0!==a.avail_in||f.status===P&&s!==_)return X(a,0===a.avail_out?c:g);if(f.strm=a,r=f.last_flush,f.last_flush=s,f.status===F)if(2===f.wrap)a.adler=0,at(f,31),at(f,139),at(f,8),f.gzhead?(at(f,(f.gzhead.text?1:0)+(f.gzhead.hcrc?2:0)+(f.gzhead.extra?4:0)+(f.gzhead.name?8:0)+(f.gzhead.comment?16:0)),at(f,255&f.gzhead.time),at(f,f.gzhead.time>>8&255),at(f,f.gzhead.time>>16&255),at(f,f.gzhead.time>>24&255),at(f,9===f.level?2:f.strategy>=w||f.level<2?4:0),at(f,255&f.gzhead.os),f.gzhead.extra&&f.gzhead.extra.length&&(at(f,255&f.gzhead.extra.length),at(f,f.gzhead.extra.length>>8&255)),f.gzhead.hcrc&&(a.adler=i(a.adler,f.pending_buf,f.pending,0)),f.gzindex=0,f.status=G):(at(f,0),at(f,0),at(f,0),at(f,0),at(f,0),at(f,9===f.level?2:f.strategy>=w||f.level<2?4:0),at(f,W),f.status=O);else{var k=x+(f.w_bits-8<<4)<<8;k|=(f.strategy>=w||f.level<2?0:f.level<6?1:6===f.level?2:3)<<6,0!==f.strstart&&(k|=N),k+=31-k%31,f.status=O,et(f,k),0!==f.strstart&&(et(f,a.adler>>>16),et(f,65535&a.adler)),a.adler=1}if(f.status===G)if(f.gzhead.extra){for(p=f.pending;f.gzindex<(65535&f.gzhead.extra.length)&&(f.pending!==f.pending_buf_size||(f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),$(a),p=f.pending,f.pending!==f.pending_buf_size));)at(f,255&f.gzhead.extra[f.gzindex]),f.gzindex++;f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),f.gzindex===f.gzhead.extra.length&&(f.gzindex=0,f.status=J)}else f.status=J;if(f.status===J)if(f.gzhead.name){p=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),$(a),p=f.pending,f.pending===f.pending_buf_size)){m=1;break}m=f.gzindex<f.gzhead.name.length?255&f.gzhead.name.charCodeAt(f.gzindex++):0,at(f,m)}while(0!==m);f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),0===m&&(f.gzindex=0,f.status=L)}else f.status=L;if(f.status===L)if(f.gzhead.comment){p=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),$(a),p=f.pending,f.pending===f.pending_buf_size)){m=1;break}m=f.gzindex<f.gzhead.comment.length?255&f.gzhead.comment.charCodeAt(f.gzindex++):0,at(f,m)}while(0!==m);f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),0===m&&(f.status=M)}else f.status=M;if(f.status===M&&(f.gzhead.hcrc?(f.pending+2>f.pending_buf_size&&$(a),f.pending+2<=f.pending_buf_size&&(at(f,255&a.adler),at(f,a.adler>>8&255),a.adler=0,f.status=O)):f.status=O),0!==f.pending){if($(a),0===a.avail_out)return f.last_flush=-1,o}else if(0===a.avail_in&&Y(s)<=Y(r)&&s!==_)return X(a,c);if(f.status===P&&0!==a.avail_in)return X(a,c);if(0!==a.avail_in||0!==f.lookahead||s!==n&&f.status!==P){var z=f.strategy===w?dt(f,s):f.strategy===v?_t(f,s):t[f.level].func(f,s);if(z!==U&&z!==V||(f.status=P),z===Q||z===U)return 0===a.avail_out&&(f.last_flush=-1),o;if(z===T&&(s===h?e._tr_align(f):s!==d&&(e._tr_stored_block(f,0,0,!1),s===l&&(Z(f.head),0===f.lookahead&&(f.strstart=0,f.block_start=0,f.insert=0))),$(a),0===a.avail_out))return f.last_flush=-1,o}return s!==_?o:f.wrap<=0?u:(2===f.wrap?(at(f,255&a.adler),at(f,a.adler>>8&255),at(f,a.adler>>16&255),at(f,a.adler>>24&255),at(f,255&a.total_in),at(f,a.total_in>>8&255),at(f,a.total_in>>16&255),at(f,a.total_in>>24&255)):(et(f,a.adler>>>16),et(f,65535&a.adler)),$(a),f.wrap>0&&(f.wrap=-f.wrap),0!==f.pending?o:u)}function kt(t){var a;return t&&t.state?(a=t.state.status)!==F&&a!==G&&a!==J&&a!==L&&a!==M&&a!==O&&a!==P?X(t,g):(t.state=null,a===O?X(t,f):o):g}function zt(t,e){var i,r,n,h,l,_,d,u,f=e.length;if(!t||!t.state)return g;if(2===(h=(i=t.state).wrap)||1===h&&i.status!==F||i.lookahead)return g;for(1===h&&(t.adler=s(t.adler,e,f,0)),i.wrap=0,f>=i.w_size&&(0===h&&(Z(i.head),i.strstart=0,i.block_start=0,i.insert=0),u=new a.Buf8(i.w_size),a.arraySet(u,e,f-i.w_size,i.w_size,0),e=u,f=i.w_size),l=t.avail_in,_=t.next_in,d=t.input,t.avail_in=f,t.next_in=0,t.input=e,rt(i);i.lookahead>=E;){r=i.strstart,n=i.lookahead-(E-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+E-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++}while(--n);i.strstart=r,i.lookahead=E-1,rt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=E-1,i.match_available=0,t.next_in=_,t.input=d,t.avail_in=l,i.wrap=h,o}t=[new ot(0,0,0,0,nt),new ot(4,4,8,4,ht),new ot(4,5,16,8,ht),new ot(4,6,32,32,ht),new ot(4,4,16,16,lt),new ot(8,16,32,32,lt),new ot(8,16,128,128,lt),new ot(8,32,128,256,lt),new ot(32,128,258,1024,lt),new ot(32,258,258,4096,lt)],exports.deflateInit=wt,exports.deflateInit2=mt,exports.deflateReset=ct,exports.deflateResetKeep=ft,exports.deflateSetHeader=pt,exports.deflate=vt,exports.deflateEnd=kt,exports.deflateSetDictionary=zt,exports.deflateInfo="pako deflate (from Nodeca project)";
},{"../utils/common":"JNpU","./trees":"ckcG","./adler32":"PDe7","./crc32":"Nls6","./messages":"NGcu"}],"JPkB":[function(require,module,exports) {
"use strict";var r=require("./common"),n=!0,t=!0;try{String.fromCharCode.apply(null,[0])}catch(u){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){t=!1}for(var e=new r.Buf8(256),o=0;o<256;o++)e[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function f(e,o){if(o<65534&&(e.subarray&&t||!e.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(e,o));for(var f="",u=0;u<o;u++)f+=String.fromCharCode(e[u]);return f}e[254]=e[254]=1,exports.string2buf=function(n){var t,e,o,f,u,a=n.length,i=0;for(f=0;f<a;f++)55296==(64512&(e=n.charCodeAt(f)))&&f+1<a&&56320==(64512&(o=n.charCodeAt(f+1)))&&(e=65536+(e-55296<<10)+(o-56320),f++),i+=e<128?1:e<2048?2:e<65536?3:4;for(t=new r.Buf8(i),u=0,f=0;u<i;f++)55296==(64512&(e=n.charCodeAt(f)))&&f+1<a&&56320==(64512&(o=n.charCodeAt(f+1)))&&(e=65536+(e-55296<<10)+(o-56320),f++),e<128?t[u++]=e:e<2048?(t[u++]=192|e>>>6,t[u++]=128|63&e):e<65536?(t[u++]=224|e>>>12,t[u++]=128|e>>>6&63,t[u++]=128|63&e):(t[u++]=240|e>>>18,t[u++]=128|e>>>12&63,t[u++]=128|e>>>6&63,t[u++]=128|63&e);return t},exports.buf2binstring=function(r){return f(r,r.length)},exports.binstring2buf=function(n){for(var t=new r.Buf8(n.length),e=0,o=t.length;e<o;e++)t[e]=n.charCodeAt(e);return t},exports.buf2string=function(r,n){var t,o,u,a,i=n||r.length,h=new Array(2*i);for(o=0,t=0;t<i;)if((u=r[t++])<128)h[o++]=u;else if((a=e[u])>4)h[o++]=65533,t+=a-1;else{for(u&=2===a?31:3===a?15:7;a>1&&t<i;)u=u<<6|63&r[t++],a--;a>1?h[o++]=65533:u<65536?h[o++]=u:(u-=65536,h[o++]=55296|u>>10&1023,h[o++]=56320|1023&u)}return f(h,o)},exports.utf8border=function(r,n){var t;for((n=n||r.length)>r.length&&(n=r.length),t=n-1;t>=0&&128==(192&r[t]);)t--;return t<0?n:0===t?n:t+e[r[t]]>n?t:n};
},{"./common":"JNpU"}],"w28B":[function(require,module,exports) {
"use strict";function t(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}module.exports=t;
},{}],"KDqm":[function(require,module,exports) {
"use strict";var t=require("./zlib/deflate"),i=require("./utils/common"),e=require("./utils/strings"),n=require("./zlib/messages"),r=require("./zlib/zstream"),s=Object.prototype.toString,o=0,a=4,u=0,h=1,d=2,l=-1,f=0,p=8;function w(o){if(!(this instanceof w))return new w(o);this.options=i.assign({level:l,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},o||{});var a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var h=t.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(h!==u)throw new Error(n[h]);if(a.header&&t.deflateSetHeader(this.strm,a.header),a.dictionary){var d;if(d="string"==typeof a.dictionary?e.string2buf(a.dictionary):"[object ArrayBuffer]"===s.call(a.dictionary)?new Uint8Array(a.dictionary):a.dictionary,(h=t.deflateSetDictionary(this.strm,d))!==u)throw new Error(n[h]);this._dict_set=!0}}function c(t,i){var e=new w(i);if(e.push(t,!0),e.err)throw e.msg||n[e.err];return e.result}function m(t,i){return(i=i||{}).raw=!0,c(t,i)}function g(t,i){return(i=i||{}).gzip=!0,c(t,i)}w.prototype.push=function(n,r){var l,f,p=this.strm,w=this.options.chunkSize;if(this.ended)return!1;f=r===~~r?r:!0===r?a:o,"string"==typeof n?p.input=e.string2buf(n):"[object ArrayBuffer]"===s.call(n)?p.input=new Uint8Array(n):p.input=n,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new i.Buf8(w),p.next_out=0,p.avail_out=w),(l=t.deflate(p,f))!==h&&l!==u)return this.onEnd(l),this.ended=!0,!1;0!==p.avail_out&&(0!==p.avail_in||f!==a&&f!==d)||("string"===this.options.to?this.onData(e.buf2binstring(i.shrinkBuf(p.output,p.next_out))):this.onData(i.shrinkBuf(p.output,p.next_out)))}while((p.avail_in>0||0===p.avail_out)&&l!==h);return f===a?(l=t.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===u):f!==d||(this.onEnd(u),p.avail_out=0,!0)},w.prototype.onData=function(t){this.chunks.push(t)},w.prototype.onEnd=function(t){t===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},exports.Deflate=w,exports.deflate=c,exports.deflateRaw=m,exports.gzip=g;
},{"./zlib/deflate":"X2fg","./utils/common":"JNpU","./utils/strings":"JPkB","./zlib/messages":"NGcu","./zlib/zstream":"w28B"}],"odtK":[function(require,module,exports) {
"use strict";var i=30,e=12;module.exports=function(o,a){var t,d,n,l,s,f,r,b,c,u,v,m,w,h,k,_,x,g,p,z,j,q,y,A,B;t=o.state,d=o.next_in,A=o.input,n=d+(o.avail_in-5),l=o.next_out,B=o.output,s=l-(a-o.avail_out),f=l+(o.avail_out-257),r=t.dmax,b=t.wsize,c=t.whave,u=t.wnext,v=t.window,m=t.hold,w=t.bits,h=t.lencode,k=t.distcode,_=(1<<t.lenbits)-1,x=(1<<t.distbits)-1;i:do{w<15&&(m+=A[d++]<<w,w+=8,m+=A[d++]<<w,w+=8),g=h[m&_];e:for(;;){if(m>>>=p=g>>>24,w-=p,0===(p=g>>>16&255))B[l++]=65535&g;else{if(!(16&p)){if(0==(64&p)){g=h[(65535&g)+(m&(1<<p)-1)];continue e}if(32&p){t.mode=e;break i}o.msg="invalid literal/length code",t.mode=i;break i}z=65535&g,(p&=15)&&(w<p&&(m+=A[d++]<<w,w+=8),z+=m&(1<<p)-1,m>>>=p,w-=p),w<15&&(m+=A[d++]<<w,w+=8,m+=A[d++]<<w,w+=8),g=k[m&x];o:for(;;){if(m>>>=p=g>>>24,w-=p,!(16&(p=g>>>16&255))){if(0==(64&p)){g=k[(65535&g)+(m&(1<<p)-1)];continue o}o.msg="invalid distance code",t.mode=i;break i}if(j=65535&g,w<(p&=15)&&(m+=A[d++]<<w,(w+=8)<p&&(m+=A[d++]<<w,w+=8)),(j+=m&(1<<p)-1)>r){o.msg="invalid distance too far back",t.mode=i;break i}if(m>>>=p,w-=p,j>(p=l-s)){if((p=j-p)>c&&t.sane){o.msg="invalid distance too far back",t.mode=i;break i}if(q=0,y=v,0===u){if(q+=b-p,p<z){z-=p;do{B[l++]=v[q++]}while(--p);q=l-j,y=B}}else if(u<p){if(q+=b+u-p,(p-=u)<z){z-=p;do{B[l++]=v[q++]}while(--p);if(q=0,u<z){z-=p=u;do{B[l++]=v[q++]}while(--p);q=l-j,y=B}}}else if(q+=u-p,p<z){z-=p;do{B[l++]=v[q++]}while(--p);q=l-j,y=B}for(;z>2;)B[l++]=y[q++],B[l++]=y[q++],B[l++]=y[q++],z-=3;z&&(B[l++]=y[q++],z>1&&(B[l++]=y[q++]))}else{q=l-j;do{B[l++]=B[q++],B[l++]=B[q++],B[l++]=B[q++],z-=3}while(z>2);z&&(B[l++]=B[q++],z>1&&(B[l++]=B[q++]))}break}}break}}while(d<n&&l<f);d-=z=w>>3,m&=(1<<(w-=z<<3))-1,o.next_in=d,o.next_out=l,o.avail_in=d<n?n-d+5:5-(d-n),o.avail_out=l<f?f-l+257:257-(l-f),t.hold=m,t.bits=w};
},{}],"Zotp":[function(require,module,exports) {
"use strict";var r=require("../utils/common"),f=15,i=852,o=592,e=0,u=1,t=2,n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function(a,c,m,w,d,v,B,h){var k,p,q,x,g,j,y,z,A,C=h.bits,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=null,O=0,P=new r.Buf16(f+1),Q=new r.Buf16(f+1),R=null,S=0;for(D=0;D<=f;D++)P[D]=0;for(E=0;E<w;E++)P[c[m+E]]++;for(H=C,G=f;G>=1&&0===P[G];G--);if(H>G&&(H=G),0===G)return d[v++]=20971520,d[v++]=20971520,h.bits=1,0;for(F=1;F<G&&0===P[F];F++);for(H<F&&(H=F),K=1,D=1;D<=f;D++)if(K<<=1,(K-=P[D])<0)return-1;if(K>0&&(a===e||1!==G))return-1;for(Q[1]=0,D=1;D<f;D++)Q[D+1]=Q[D]+P[D];for(E=0;E<w;E++)0!==c[m+E]&&(B[Q[c[m+E]]++]=E);if(a===e?(N=R=B,j=19):a===u?(N=n,O-=257,R=l,S-=257,j=256):(N=s,R=b,j=-1),M=0,E=0,D=F,g=v,I=H,J=0,q=-1,x=(L=1<<H)-1,a===u&&L>i||a===t&&L>o)return 1;for(;;){y=D-J,B[E]<j?(z=0,A=B[E]):B[E]>j?(z=R[S+B[E]],A=N[O+B[E]]):(z=96,A=0),k=1<<D-J,F=p=1<<I;do{d[g+(M>>J)+(p-=k)]=y<<24|z<<16|A|0}while(0!==p);for(k=1<<D-1;M&k;)k>>=1;if(0!==k?(M&=k-1,M+=k):M=0,E++,0==--P[D]){if(D===G)break;D=c[m+B[E]]}if(D>H&&(M&x)!==q){for(0===J&&(J=H),g+=F,K=1<<(I=D-J);I+J<G&&!((K-=P[I+J])<=0);)I++,K<<=1;if(L+=1<<I,a===u&&L>i||a===t&&L>o)return 1;d[q=M&x]=H<<24|I<<16|g-v|0}}return 0!==M&&(d[g+M]=D-J<<24|64<<16|0),h.bits=H,0};
},{"../utils/common":"JNpU"}],"PRZ0":[function(require,module,exports) {
"use strict";var e=require("../utils/common"),a=require("./adler32"),t=require("./crc32"),i=require("./inffast"),s=require("./inftrees"),n=0,r=1,o=2,d=4,l=5,f=6,c=0,h=1,k=2,b=-2,m=-3,w=-4,u=-5,g=8,v=1,x=2,p=3,_=4,y=5,z=6,B=7,S=8,q=9,C=10,I=11,R=12,j=13,A=14,D=15,E=16,G=17,H=18,K=19,N=20,F=21,J=22,L=23,M=24,O=25,P=26,Q=27,T=28,U=29,V=30,W=31,X=32,Y=852,Z=592,$=15,ee=$;function ae(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ie(a){var t;return a&&a.state?(t=a.state,a.total_in=a.total_out=t.total=0,a.msg="",t.wrap&&(a.adler=1&t.wrap),t.mode=v,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new e.Buf32(Y),t.distcode=t.distdyn=new e.Buf32(Z),t.sane=1,t.back=-1,c):b}function se(e){var a;return e&&e.state?((a=e.state).wsize=0,a.whave=0,a.wnext=0,ie(e)):b}function ne(e,a){var t,i;return e&&e.state?(i=e.state,a<0?(t=0,a=-a):(t=1+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?b:(null!==i.window&&i.wbits!==a&&(i.window=null),i.wrap=t,i.wbits=a,se(e))):b}function re(e,a){var t,i;return e?(i=new te,e.state=i,i.window=null,(t=ne(e,a))!==c&&(e.state=null),t):b}function oe(e){return re(e,ee)}var de,le,fe=!0;function ce(a){if(fe){var t;for(de=new e.Buf32(512),le=new e.Buf32(32),t=0;t<144;)a.lens[t++]=8;for(;t<256;)a.lens[t++]=9;for(;t<280;)a.lens[t++]=7;for(;t<288;)a.lens[t++]=8;for(s(r,a.lens,0,288,de,0,a.work,{bits:9}),t=0;t<32;)a.lens[t++]=5;s(o,a.lens,0,32,le,0,a.work,{bits:5}),fe=!1}a.lencode=de,a.lenbits=9,a.distcode=le,a.distbits=5}function he(a,t,i,s){var n,r=a.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new e.Buf8(r.wsize)),s>=r.wsize?(e.arraySet(r.window,t,i-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):((n=r.wsize-r.wnext)>s&&(n=s),e.arraySet(r.window,t,i-s,n,r.wnext),(s-=n)?(e.arraySet(r.window,t,i-s,s,0),r.wnext=s,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0}function ke(Y,Z){var $,ee,te,ie,se,ne,re,oe,de,le,fe,ke,be,me,we,ue,ge,ve,xe,pe,_e,ye,ze,Be,Se=0,qe=new e.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Y||!Y.state||!Y.output||!Y.input&&0!==Y.avail_in)return b;($=Y.state).mode===R&&($.mode=j),se=Y.next_out,te=Y.output,re=Y.avail_out,ie=Y.next_in,ee=Y.input,ne=Y.avail_in,oe=$.hold,de=$.bits,le=ne,fe=re,ye=c;e:for(;;)switch($.mode){case v:if(0===$.wrap){$.mode=j;break}for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(2&$.wrap&&35615===oe){$.check=0,qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0),oe=0,de=0,$.mode=x;break}if($.flags=0,$.head&&($.head.done=!1),!(1&$.wrap)||(((255&oe)<<8)+(oe>>8))%31){Y.msg="incorrect header check",$.mode=V;break}if((15&oe)!==g){Y.msg="unknown compression method",$.mode=V;break}if(de-=4,_e=8+(15&(oe>>>=4)),0===$.wbits)$.wbits=_e;else if(_e>$.wbits){Y.msg="invalid window size",$.mode=V;break}$.dmax=1<<_e,Y.adler=$.check=1,$.mode=512&oe?C:R,oe=0,de=0;break;case x:for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if($.flags=oe,(255&$.flags)!==g){Y.msg="unknown compression method",$.mode=V;break}if(57344&$.flags){Y.msg="unknown header flags set",$.mode=V;break}$.head&&($.head.text=oe>>8&1),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0)),oe=0,de=0,$.mode=p;case p:for(;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.head&&($.head.time=oe),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,qe[2]=oe>>>16&255,qe[3]=oe>>>24&255,$.check=t($.check,qe,4,0)),oe=0,de=0,$.mode=_;case _:for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.head&&($.head.xflags=255&oe,$.head.os=oe>>8),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0)),oe=0,de=0,$.mode=y;case y:if(1024&$.flags){for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.length=oe,$.head&&($.head.extra_len=oe),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0)),oe=0,de=0}else $.head&&($.head.extra=null);$.mode=z;case z:if(1024&$.flags&&((ke=$.length)>ne&&(ke=ne),ke&&($.head&&(_e=$.head.extra_len-$.length,$.head.extra||($.head.extra=new Array($.head.extra_len)),e.arraySet($.head.extra,ee,ie,ke,_e)),512&$.flags&&($.check=t($.check,ee,ke,ie)),ne-=ke,ie+=ke,$.length-=ke),$.length))break e;$.length=0,$.mode=B;case B:if(2048&$.flags){if(0===ne)break e;ke=0;do{_e=ee[ie+ke++],$.head&&_e&&$.length<65536&&($.head.name+=String.fromCharCode(_e))}while(_e&&ke<ne);if(512&$.flags&&($.check=t($.check,ee,ke,ie)),ne-=ke,ie+=ke,_e)break e}else $.head&&($.head.name=null);$.length=0,$.mode=S;case S:if(4096&$.flags){if(0===ne)break e;ke=0;do{_e=ee[ie+ke++],$.head&&_e&&$.length<65536&&($.head.comment+=String.fromCharCode(_e))}while(_e&&ke<ne);if(512&$.flags&&($.check=t($.check,ee,ke,ie)),ne-=ke,ie+=ke,_e)break e}else $.head&&($.head.comment=null);$.mode=q;case q:if(512&$.flags){for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(oe!==(65535&$.check)){Y.msg="header crc mismatch",$.mode=V;break}oe=0,de=0}$.head&&($.head.hcrc=$.flags>>9&1,$.head.done=!0),Y.adler=$.check=0,$.mode=R;break;case C:for(;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}Y.adler=$.check=ae(oe),oe=0,de=0,$.mode=I;case I:if(0===$.havedict)return Y.next_out=se,Y.avail_out=re,Y.next_in=ie,Y.avail_in=ne,$.hold=oe,$.bits=de,k;Y.adler=$.check=1,$.mode=R;case R:if(Z===l||Z===f)break e;case j:if($.last){oe>>>=7&de,de-=7&de,$.mode=Q;break}for(;de<3;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}switch($.last=1&oe,de-=1,3&(oe>>>=1)){case 0:$.mode=A;break;case 1:if(ce($),$.mode=N,Z===f){oe>>>=2,de-=2;break e}break;case 2:$.mode=G;break;case 3:Y.msg="invalid block type",$.mode=V}oe>>>=2,de-=2;break;case A:for(oe>>>=7&de,de-=7&de;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if((65535&oe)!=(oe>>>16^65535)){Y.msg="invalid stored block lengths",$.mode=V;break}if($.length=65535&oe,oe=0,de=0,$.mode=D,Z===f)break e;case D:$.mode=E;case E:if(ke=$.length){if(ke>ne&&(ke=ne),ke>re&&(ke=re),0===ke)break e;e.arraySet(te,ee,ie,ke,se),ne-=ke,ie+=ke,re-=ke,se+=ke,$.length-=ke;break}$.mode=R;break;case G:for(;de<14;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if($.nlen=257+(31&oe),oe>>>=5,de-=5,$.ndist=1+(31&oe),oe>>>=5,de-=5,$.ncode=4+(15&oe),oe>>>=4,de-=4,$.nlen>286||$.ndist>30){Y.msg="too many length or distance symbols",$.mode=V;break}$.have=0,$.mode=H;case H:for(;$.have<$.ncode;){for(;de<3;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.lens[Ce[$.have++]]=7&oe,oe>>>=3,de-=3}for(;$.have<19;)$.lens[Ce[$.have++]]=0;if($.lencode=$.lendyn,$.lenbits=7,ze={bits:$.lenbits},ye=s(n,$.lens,0,19,$.lencode,0,$.work,ze),$.lenbits=ze.bits,ye){Y.msg="invalid code lengths set",$.mode=V;break}$.have=0,$.mode=K;case K:for(;$.have<$.nlen+$.ndist;){for(;ue=(Se=$.lencode[oe&(1<<$.lenbits)-1])>>>16&255,ge=65535&Se,!((we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(ge<16)oe>>>=we,de-=we,$.lens[$.have++]=ge;else{if(16===ge){for(Be=we+2;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(oe>>>=we,de-=we,0===$.have){Y.msg="invalid bit length repeat",$.mode=V;break}_e=$.lens[$.have-1],ke=3+(3&oe),oe>>>=2,de-=2}else if(17===ge){for(Be=we+3;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}de-=we,_e=0,ke=3+(7&(oe>>>=we)),oe>>>=3,de-=3}else{for(Be=we+7;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}de-=we,_e=0,ke=11+(127&(oe>>>=we)),oe>>>=7,de-=7}if($.have+ke>$.nlen+$.ndist){Y.msg="invalid bit length repeat",$.mode=V;break}for(;ke--;)$.lens[$.have++]=_e}}if($.mode===V)break;if(0===$.lens[256]){Y.msg="invalid code -- missing end-of-block",$.mode=V;break}if($.lenbits=9,ze={bits:$.lenbits},ye=s(r,$.lens,0,$.nlen,$.lencode,0,$.work,ze),$.lenbits=ze.bits,ye){Y.msg="invalid literal/lengths set",$.mode=V;break}if($.distbits=6,$.distcode=$.distdyn,ze={bits:$.distbits},ye=s(o,$.lens,$.nlen,$.ndist,$.distcode,0,$.work,ze),$.distbits=ze.bits,ye){Y.msg="invalid distances set",$.mode=V;break}if($.mode=N,Z===f)break e;case N:$.mode=F;case F:if(ne>=6&&re>=258){Y.next_out=se,Y.avail_out=re,Y.next_in=ie,Y.avail_in=ne,$.hold=oe,$.bits=de,i(Y,fe),se=Y.next_out,te=Y.output,re=Y.avail_out,ie=Y.next_in,ee=Y.input,ne=Y.avail_in,oe=$.hold,de=$.bits,$.mode===R&&($.back=-1);break}for($.back=0;ue=(Se=$.lencode[oe&(1<<$.lenbits)-1])>>>16&255,ge=65535&Se,!((we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(ue&&0==(240&ue)){for(ve=we,xe=ue,pe=ge;ue=(Se=$.lencode[pe+((oe&(1<<ve+xe)-1)>>ve)])>>>16&255,ge=65535&Se,!(ve+(we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}oe>>>=ve,de-=ve,$.back+=ve}if(oe>>>=we,de-=we,$.back+=we,$.length=ge,0===ue){$.mode=P;break}if(32&ue){$.back=-1,$.mode=R;break}if(64&ue){Y.msg="invalid literal/length code",$.mode=V;break}$.extra=15&ue,$.mode=J;case J:if($.extra){for(Be=$.extra;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.length+=oe&(1<<$.extra)-1,oe>>>=$.extra,de-=$.extra,$.back+=$.extra}$.was=$.length,$.mode=L;case L:for(;ue=(Se=$.distcode[oe&(1<<$.distbits)-1])>>>16&255,ge=65535&Se,!((we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(0==(240&ue)){for(ve=we,xe=ue,pe=ge;ue=(Se=$.distcode[pe+((oe&(1<<ve+xe)-1)>>ve)])>>>16&255,ge=65535&Se,!(ve+(we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}oe>>>=ve,de-=ve,$.back+=ve}if(oe>>>=we,de-=we,$.back+=we,64&ue){Y.msg="invalid distance code",$.mode=V;break}$.offset=ge,$.extra=15&ue,$.mode=M;case M:if($.extra){for(Be=$.extra;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.offset+=oe&(1<<$.extra)-1,oe>>>=$.extra,de-=$.extra,$.back+=$.extra}if($.offset>$.dmax){Y.msg="invalid distance too far back",$.mode=V;break}$.mode=O;case O:if(0===re)break e;if(ke=fe-re,$.offset>ke){if((ke=$.offset-ke)>$.whave&&$.sane){Y.msg="invalid distance too far back",$.mode=V;break}ke>$.wnext?(ke-=$.wnext,be=$.wsize-ke):be=$.wnext-ke,ke>$.length&&(ke=$.length),me=$.window}else me=te,be=se-$.offset,ke=$.length;ke>re&&(ke=re),re-=ke,$.length-=ke;do{te[se++]=me[be++]}while(--ke);0===$.length&&($.mode=F);break;case P:if(0===re)break e;te[se++]=$.length,re--,$.mode=F;break;case Q:if($.wrap){for(;de<32;){if(0===ne)break e;ne--,oe|=ee[ie++]<<de,de+=8}if(fe-=re,Y.total_out+=fe,$.total+=fe,fe&&(Y.adler=$.check=$.flags?t($.check,te,fe,se-fe):a($.check,te,fe,se-fe)),fe=re,($.flags?oe:ae(oe))!==$.check){Y.msg="incorrect data check",$.mode=V;break}oe=0,de=0}$.mode=T;case T:if($.wrap&&$.flags){for(;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(oe!==(4294967295&$.total)){Y.msg="incorrect length check",$.mode=V;break}oe=0,de=0}$.mode=U;case U:ye=h;break e;case V:ye=m;break e;case W:return w;case X:default:return b}return Y.next_out=se,Y.avail_out=re,Y.next_in=ie,Y.avail_in=ne,$.hold=oe,$.bits=de,($.wsize||fe!==Y.avail_out&&$.mode<V&&($.mode<Q||Z!==d))&&he(Y,Y.output,Y.next_out,fe-Y.avail_out)?($.mode=W,w):(le-=Y.avail_in,fe-=Y.avail_out,Y.total_in+=le,Y.total_out+=fe,$.total+=fe,$.wrap&&fe&&(Y.adler=$.check=$.flags?t($.check,te,fe,Y.next_out-fe):a($.check,te,fe,Y.next_out-fe)),Y.data_type=$.bits+($.last?64:0)+($.mode===R?128:0)+($.mode===N||$.mode===D?256:0),(0===le&&0===fe||Z===d)&&ye===c&&(ye=u),ye)}function be(e){if(!e||!e.state)return b;var a=e.state;return a.window&&(a.window=null),e.state=null,c}function me(e,a){var t;return e&&e.state?0==(2&(t=e.state).wrap)?b:(t.head=a,a.done=!1,c):b}function we(e,t){var i,s=t.length;return e&&e.state?0!==(i=e.state).wrap&&i.mode!==I?b:i.mode===I&&a(1,t,s,0)!==i.check?m:he(e,t,s,s)?(i.mode=W,w):(i.havedict=1,c):b}exports.inflateReset=se,exports.inflateReset2=ne,exports.inflateResetKeep=ie,exports.inflateInit=oe,exports.inflateInit2=re,exports.inflate=ke,exports.inflateEnd=be,exports.inflateGetHeader=me,exports.inflateSetDictionary=we,exports.inflateInfo="pako inflate (from Nodeca project)";
},{"../utils/common":"JNpU","./adler32":"PDe7","./crc32":"Nls6","./inffast":"odtK","./inftrees":"Zotp"}],"NNt1":[function(require,module,exports) {
"use strict";module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};
},{}],"bEbX":[function(require,module,exports) {
"use strict";function t(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}module.exports=t;
},{}],"iCYE":[function(require,module,exports) {
"use strict";var t=require("./zlib/inflate"),i=require("./utils/common"),n=require("./utils/strings"),r=require("./zlib/constants"),s=require("./zlib/messages"),o=require("./zlib/zstream"),e=require("./zlib/gzheader"),a=Object.prototype.toString;function u(h){if(!(this instanceof u))return new u(h);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},h||{});var _=this.options;_.raw&&_.windowBits>=0&&_.windowBits<16&&(_.windowBits=-_.windowBits,0===_.windowBits&&(_.windowBits=-15)),!(_.windowBits>=0&&_.windowBits<16)||h&&h.windowBits||(_.windowBits+=32),_.windowBits>15&&_.windowBits<48&&0==(15&_.windowBits)&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var w=t.inflateInit2(this.strm,_.windowBits);if(w!==r.Z_OK)throw new Error(s[w]);if(this.header=new e,t.inflateGetHeader(this.strm,this.header),_.dictionary&&("string"==typeof _.dictionary?_.dictionary=n.string2buf(_.dictionary):"[object ArrayBuffer]"===a.call(_.dictionary)&&(_.dictionary=new Uint8Array(_.dictionary)),_.raw&&(w=t.inflateSetDictionary(this.strm,_.dictionary))!==r.Z_OK))throw new Error(s[w])}function h(t,i){var n=new u(i);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}function _(t,i){return(i=i||{}).raw=!0,h(t,i)}u.prototype.push=function(s,o){var e,u,h,_,w,d=this.strm,l=this.options.chunkSize,f=this.options.dictionary,p=!1;if(this.ended)return!1;u=o===~~o?o:!0===o?r.Z_FINISH:r.Z_NO_FLUSH,"string"==typeof s?d.input=n.binstring2buf(s):"[object ArrayBuffer]"===a.call(s)?d.input=new Uint8Array(s):d.input=s,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(l),d.next_out=0,d.avail_out=l),(e=t.inflate(d,r.Z_NO_FLUSH))===r.Z_NEED_DICT&&f&&(e=t.inflateSetDictionary(this.strm,f)),e===r.Z_BUF_ERROR&&!0===p&&(e=r.Z_OK,p=!1),e!==r.Z_STREAM_END&&e!==r.Z_OK)return this.onEnd(e),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&e!==r.Z_STREAM_END&&(0!==d.avail_in||u!==r.Z_FINISH&&u!==r.Z_SYNC_FLUSH)||("string"===this.options.to?(h=n.utf8border(d.output,d.next_out),_=d.next_out-h,w=n.buf2string(d.output,h),d.next_out=_,d.avail_out=l-_,_&&i.arraySet(d.output,d.output,h,_,0),this.onData(w)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(p=!0)}while((d.avail_in>0||0===d.avail_out)&&e!==r.Z_STREAM_END);return e===r.Z_STREAM_END&&(u=r.Z_FINISH),u===r.Z_FINISH?(e=t.inflateEnd(this.strm),this.onEnd(e),this.ended=!0,e===r.Z_OK):u!==r.Z_SYNC_FLUSH||(this.onEnd(r.Z_OK),d.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){t===r.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},exports.Inflate=u,exports.inflate=h,exports.inflateRaw=_,exports.ungzip=h;
},{"./zlib/inflate":"PRZ0","./utils/common":"JNpU","./utils/strings":"JPkB","./zlib/constants":"NNt1","./zlib/messages":"NGcu","./zlib/zstream":"w28B","./zlib/gzheader":"bEbX"}],"JWfd":[function(require,module,exports) {
"use strict";var e=require("./lib/utils/common").assign,i=require("./lib/deflate"),r=require("./lib/inflate"),l=require("./lib/zlib/constants"),s={};e(s,i,r,l),module.exports=s;
},{"./lib/utils/common":"JNpU","./lib/deflate":"KDqm","./lib/inflate":"iCYE","./lib/zlib/constants":"NNt1"}],"nlD3":[function(require,module,exports) {
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("@babel/runtime/helpers/slicedToArray")),n=e(require("@babel/runtime/helpers/classCallCheck")),r=e(require("@babel/runtime/helpers/createClass")),o=e(require("@babel/runtime/helpers/toConsumableArray")),i=e(require("@babel/runtime/helpers/typeof")),a=e(require("@babel/runtime/helpers/defineProperty")),s=e(require("@babel/runtime/regenerator")),c=e(require("@babel/runtime/helpers/asyncToGenerator")),u=e(require("fast-json-stable-stringify")),l=e(require("toastify-js")),h=e(require("seedrandom/seedrandom")),f=e(require("@babel/runtime/helpers/get")),d=e(require("@babel/runtime/helpers/inherits")),p=e(require("@babel/runtime/helpers/possibleConstructorReturn")),v=e(require("@babel/runtime/helpers/getPrototypeOf")),y=e(require("fastpriorityqueue")),m=e(require("@babel/runtime/helpers/toArray")),g=e(require("@babel/runtime/helpers/construct"));const w="production",b="0.3.0";if(void 0===window.TextEncoder){window.TextEncoder=function(){},TextEncoder.prototype.encode=function(e){for(var t=e.length,n=-1,r="undefined"==typeof Uint8Array?new Array(1.5*t):new Uint8Array(3*t),o=0,i=0,a=0;a!==t;){if(o=e.charCodeAt(a),a+=1,o>=55296&&o<=56319){if(a===t){r[n+=1]=239,r[n+=1]=191,r[n+=1]=189;break}if(!((i=e.charCodeAt(a))>=56320&&i<=57343)){r[n+=1]=239,r[n+=1]=191,r[n+=1]=189;continue}if(a+=1,(o=1024*(o-55296)+i-56320+65536)>65535){r[n+=1]=240|o>>>18,r[n+=1]=128|o>>>12&63,r[n+=1]=128|o>>>6&63,r[n+=1]=128|63&o;continue}}o<=127?r[n+=1]=0|o:o<=2047?(r[n+=1]=192|o>>>6,r[n+=1]=128|63&o):(r[n+=1]=224|o>>>12,r[n+=1]=128|o>>>6&63,r[n+=1]=128|63&o)}return"undefined"!=typeof Uint8Array?r.subarray(0,n+1):(r.length=n+1,r)},TextEncoder.prototype.toString=function(){return"[object TextEncoder]"};try{Object.defineProperty(TextEncoder.prototype,"encoding",{get:function(){if(TextEncoder.prototype.isPrototypeOf(this))return"utf-8";throw TypeError("Illegal invocation")}})}catch(e){TextEncoder.prototype.encoding="utf-8"}"undefined"!=typeof Symbol&&(TextEncoder.prototype[Symbol.toStringTag]="TextEncoder")}function k(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}"object"===("undefined"==typeof module?"undefined":i(module))&&module.bundle&&module.bundle.modules&&module.bundle.cache&&function(){for(var e=module.bundle,n={},r={},i={},a=0,s=Object.entries(e.modules);a<s.length;a++){var c=t(s[a],2),u=c[0],l=c[1],h=""+e.modules[u][0],f=r[h];f?i[u]=f:r[h]=u;for(var d=0,p=Object.entries(l[1]);d<p.length;d++){var v=t(p[d],2),y=v[0],m=v[1];(n[m]||(n[m]=new Set)).add(y)}}for(var g=function(e){return n[e]?"".concat(o(n[e]).sort().join('" and "')):"top-level"},w={},b=[],S=0,x=Object.entries(e.modules);S<x.length;S++)for(var C=t(x[S],2),E=C[0],O=C[1],_=0,A=Object.entries(O[1]);_<A.length;_++){var M=t(A[_],2),T=M[0],I=M[1],q=i[I];q&&(e.cache[I]?w[q]=I:(O[1][T]=q,delete e.modules[I],b.push('"'.concat(T,'" in "').concat(g(E),'" (').concat(E,")"))))}for(var j=0,P=Object.entries(e.modules);j<P.length;j++)for(var N=t(P[j],2),D=N[0],R=N[1],L=0,B=Object.entries(R[1]);L<B.length;L++){var U=t(B[L],2),F=U[0],H=U[1],$=w[H];$&&(e.cache[H]?console.warn('Could not deduplicate import "'.concat(F,'" in "').concat(g(D),'" (to fix, import "').concat(g(module.id),'" earlier)')):(R[1][F]=$,delete e.modules[H],b.push('"'.concat(F,'" in "').concat(g(D),'" (').concat(D,")"))))}var V,J=k(b.sort());try{for(J.s();!(V=J.n()).done;){var z=V.value;console.log("Deduplicated import",z)}}catch(e){J.e(e)}finally{J.f()}}();var E=window.location.hostname.endsWith("croquet.studio"),O="",_="";function A(e,t){if(t){var n,r=x(t.split("&"));try{for(r.s();!(n=r.n()).done;){var o=n.value.split("="),i=o[0],a=!0;if(o.length>1&&(a=decodeURIComponent(o.slice(1).join("="))).match(/^(true|false|null|[0-9.]*|["[{].*)$/))try{a=JSON.parse(a)}catch(e){"["===a[0]&&(a=a.slice(1,-1).split(","))}e[i]=a}}catch(e){r.e(e)}finally{r.f()}}}var M=new(function(){function e(){n(this,e),this.getSession(),A(this,window.location.search.slice(1)),A(this,E?window.location.hash.slice(1):_),window.location.pathname.indexOf("/ar.html")>=0&&(this.ar=!0)}return r(e,[{key:"has",value:function(e,t,n){"boolean"!=typeof n&&(n=this.isHost(n));var r=this[e];if("string"!=typeof r)return n;var o=r.split(",");return!0===n&&(t="no".concat(t)),t.endsWith("s")&&(t=t.slice(0,-1)),o.includes(t)||o.includes("".concat(t,"s"))?!n:n}},{key:"getSession",value:function(){if(E){var e=window.location.pathname.match(/^\/([^\/]+)\/(.*)$/);if(e)return O=e[1],e[2]}else{var t=window.location.hash.match(/^#([^&]+)&?(.*)$/);if(t)return t[1].includes("=")?(_="".concat(t[1],"&").concat(t[2]),""):(_=t[2],t[1])}return"string"==typeof this.session?(_=window.location.hash.slice(1),this.session):""}},{key:"setSession",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null==E&&this.getSession();var n=window.location,r=n.search,o=n.hash,i=E?"/".concat(O,"/").concat(e).concat(r).concat(o):"#".concat(e).concat(_?"&"+_:"");t?window.history.replaceState({},"",i):window.history.pushState({},"",i)}},{key:"isHost",value:function(e){var t=window.location.hostname;return t===e||"localhost"===e&&(!!t.endsWith(".ngrok.io")||["127.0.0.1","::1"].includes(t))}},{key:"isLocalhost",value:function(){return this.isHost("localhost")}}]),e}());function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={};try{r=JSON.parse(localStorage.croquetUser||"{}")}catch(e){}return e in r?r[e]:n?(r[e]=n(),r[e]!==t&&(localStorage.croquetUser=JSON.stringify(r)),r[e]):t}function I(){return q.apply(this,arguments)}function q(){return(q=c(s.mark(function e(){return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!M.nologin){e.next=2;break}return e.abrupt("return",!1);case 2:if(!T("name")||M.user){e.next=4;break}return e.abrupt("return",!0);case 4:return e.abrupt("return",new Promise(function(e){var n=document.createElement("style");n.innerHTML='\n            .overlay {\n                z-index: 1010;\n                position: fixed;\n                left: 0;\n                top: 0;\n                width: 100%;\n                height: 100%;\n                background-color:#333;\n                opacity:0.9;\n                display:flex;\n                align-items:center;\n                justify-content:center\n            }\n            form {\n                background-color: #fff;\n                color: #666;\n                border-radius: 10px;\n                padding: 16px;\n                font-size: 14px;\n            }\n            form dt { margin: 4px 0 }\n            form dd { margin-left: 0 }\n            form input {\n                border: 1px solid #ccc;\n                border-radius: 5px;\n                min-height: 46px;\n                padding: 10px;\n                font-size: 16px;\n                width: 100%;\n                box-shadow: inset 0 1px 2px #666;\n            }\n            form input:invalid { border: 1px solid red; }\n            form input:valid   { border: 1px solid #ccc; }\n            form button {\n                padding: 20px 32px;\n                background-color: #3b5;\n                color: #fff;\n                border-radius: 50px;\n                border-width:0;\n                font-size: 16px;\n                font-weight: 500;\n                width: 100%;\n            }\n            .error {\n                visibility: hidden;\n                width: 250px;\n                background-color: #fcc;\n                color: #900;\n                padding: 5px;\n                border-radius: 6px;\n                border: 1px solid #c99;\n                position: absolute;\n                margin-top: 5px;\n                font-size: 12px;\n            }\n            .error::after {\n                content: " ";\n                position: absolute;\n                bottom: 100%;  /* At the top of message */\n                left: 10px;\n                border-width: 5px;\n                border-style: solid;\n                border-color: transparent transparent #c99 transparent;\n            }\n            .notice {\n                visibility: hidden;\n                width: 270px;\n                height: 70px;\n                background-color: #fff;\n                padding: 5px;\n                position: absolute;\n                margin-top: 5px;\n                font-size: 12px;\n            }\n        ',document.head.appendChild(n);var r=document.createElement("form");r.innerHTML='\n            <dl>\n                <dt><label for="user[name]">Username</label></dt>\n                <dd>\n                    <input type="text" required pattern="^[a-zA-Z0-9_]*$" minlength="2" maxlength="15" name="user[name]" id="user[name]" placeholder="Enter a username" autocomplete="off" spellcheck="false"></input>\n                </dd>\n                <dd class="error"></dd>\n                <dd class="notice"></dd>\n            </dl>\n            <dl>\n                <dt><label for="user[email]">Email</label></dt>\n                <dd>\n                    <input type="email" required id="user[email]" placeholder="you@example.com" autocomplete="off" spellcheck="false"></input>\n                </dd>\n                <dd class="error"></dd>\n            </dl>\n            <dl>\n                <dt><label for="user[password]">Password</label></dt>\n                <dd>\n                    <input type="password" required minlength="8" id="user[password]" placeholder="Create a password" autocomplete="off" spellcheck="false"></input>\n                </dd>\n                <dd class="error"></dd>\n            </dl>\n            <button id="user[create]">Sign up / Log in</button>\n            <div style="margin:16px auto;text-align: center">â€” OR â€”</div>\n            <button id="user[guest]" style="background-color: #999">Continue as Croquet Guest</button>\n            <div style="max-width:280px;text-align: center;font-size:11px;margin:4px auto">\n                Continuing from this screen to our website indicates that you agree to our\n                <a href="/terms.html" target="_blank" style="color:#36c;text-decoration:none">terms of service</a>\n                and\n                <a href="/privacy.html" target="_blank" style="color:#36c;text-decoration:none">privacy statement</a>.\n            </div>\n        ';var o=document.createElement("div");o.classList.add("overlay"),o.appendChild(r),document.body.appendChild(o);var i=r.getElementsByTagName("input"),a=t(i,3),u=a[0],l=a[1],h=a[2],f=r.getElementsByClassName("error"),d=t(f,3),p=d[0],v=d[1],y=d[2],m=r.getElementsByClassName("notice"),g=t(m,1)[0],w=r.getElementsByTagName("button"),b=t(w,2),k=b[0],S=b[1];"string"==typeof M.user?u.value=M.user:T("name")&&(u.value=T("name"));var x=0;u.oninput=function(){clearTimeout(x),x=setTimeout(function(){return A()},300)},j(!0),u.oninput();var C=0;l.oninput=function(){clearTimeout(C),C=setTimeout(function(){return I()},300)};var E=0;function O(){r.reset(),document.head.removeChild(n),document.body.removeChild(o)}function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".json";return"".concat(L(),"/user/").concat(e.toLowerCase(),"/").concat(t).concat(n)}function A(){return function(){return c(s.mark(function e(){var t,n,r,o,i,a=arguments;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]&&a[0],p.style.visibility="hidden",t||j(!0),(n=u.value.trim())||t){e.next=6;break}return e.abrupt("return",!1);case 6:if(!u.validity.tooShort&&!u.validity.tooLong){e.next=10;break}return p.innerHTML="Your username must be between ".concat(u.minLength," and ").concat(u.maxLength," characters long."),p.style.visibility="visible",e.abrupt("return",!1);case 10:if(!u.validity.patternMismatch){e.next=14;break}return p.innerHTML="Your username can only contain alphanumeric characters (letters A-Z, numbers 0-9) and underscores.",p.style.visibility="visible",e.abrupt("return",!1);case 14:return e.prev=14,r=x,e.next=18,fetch(_(n,"salt"),{mode:"cors"});case 18:if(o=e.sent,r===x||t){e.next=21;break}return e.abrupt("return",!1);case 21:if(!o.ok){e.next=27;break}return t||j(!1),e.next=25,o.json();case 25:return i=e.sent,e.abrupt("return",{name:n,salt:$(i.salt)});case 27:e.next=31;break;case 29:e.prev=29,e.t0=e.catch(14);case 31:return e.abrupt("return",{name:n});case 32:case"end":return e.stop()}},e,null,[[14,29]])})).apply(this,arguments)}.apply(this,arguments)}function I(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v.style.visibility="hidden";var t=l.value.trim();return!(!t&&!e)&&(l.validity.valid?t:(v.innerHTML="Please enter a valid email address.",v.style.visibility="visible",!1))}function q(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y.style.visibility="hidden";var t=h.value;return!(!t&&!e)&&(h.validity.tooShort?(y.innerHTML="Your password must be at least ".concat(h.minLength," characters long."),y.style.visibility="visible",!1):t)}function j(e){var t=u.value.trim();g.innerHTML="â€œ".concat(t,"â€ is already registered as a user.<br><br>\n                If this is you, please enter your password below to continue.\n                Otherwise, please pick a different name."),g.style.visibility=e?"hidden":"visible",l.disabled=!e,h.placeholder=t?e?"Create a password for â€œ".concat(t,"â€"):"Enter password for â€œ".concat(t,"â€"):"Enter a password",k.innerHTML=t?e?"Sign up as â€œ".concat(t,"â€"):"Log in as â€œ".concat(t,"â€"):"Sign up / Log in"}h.oninput=function(){clearTimeout(E),E=setTimeout(function(){return q()},300)},k.onclick=function(){var t=c(s.mark(function t(n){var r,o,i,a,c,u,l,h,f,d,p,v,m;return s.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,A(!0);case 3:if(r=t.sent,o=r.name,i=r.salt,a=!!i||I(!0),c=q(!0),o&&a&&c){t.next=10;break}return t.abrupt("return");case 10:return(u=i)||(u=crypto.getRandomValues(new Uint8Array(8)),fetch(_(o,"salt"),{method:"PUT",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({salt:V(u)})})),t.next=14,window.crypto.subtle.importKey("raw",(new TextEncoder).encode(c),{name:"PBKDF2"},!1,["deriveBits"]);case 14:return l=t.sent,t.next=17,window.crypto.subtle.deriveBits({name:"PBKDF2",salt:u,iterations:5e5,hash:"SHA-256"},l,256);case 17:if(h=t.sent,f=V(h),!i){t.next=40;break}return t.prev=20,t.next=23,fetch(_(o,f),{mode:"cors"});case 23:if((d=t.sent).ok){t.next=26;break}throw Error("wrong password");case 26:return t.next=28,d.json();case 28:p=t.sent,console.log("Logged in as ".concat(p.name," <").concat(p.email,">")),localStorage.croquetUser=JSON.stringify(p),t.next=38;break;case 33:return t.prev=33,t.t0=t.catch(20),y.innerHTML="Wrong password for â€œ".concat(o,"â€œ"),y.style.visibility="visible",t.abrupt("return");case 38:t.next=45;break;case 40:v=crypto.getRandomValues(new Uint8Array(16)),m={name:o,email:a,salt:V(u),secret:V(v)},localStorage.croquetUser=JSON.stringify(m),fetch(_(o,f),{method:"PUT",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),console.log("Signed up as ".concat(m.name," <").concat(m.email,">"));case 45:O(),e(!0);case 47:case"end":return t.stop()}},t,null,[[20,33]])}));return function(e){return t.apply(this,arguments)}}(),S.onclick=function(t){t.preventDefault(),delete localStorage.croquetUser,O(),e(!1)}}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function N(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=window.location.hostname.endsWith("croquet.io")?window.location.host:"croquet.io";function L(){var e="string"==typeof M.files?M.files:"https://".concat(R,"/files/v1");return e.endsWith("/")?e.slice(0,-1):e}function B(){return module.bundle?module.bundle.modules:[]}function U(){return Object.keys(B()).filter(function(e){return!e.endsWith("hmr-runtime.js")})}function F(e){return B()[e]}function H(e){var t,n,r;return n=(t=""+F(e)[0]).indexOf("{"),r=t.lastIndexOf("}"),t.slice(n+1,r).trim()}function $(e){return new Uint8Array(atob(e.padEnd(e.length+3&-4,"=").replace(/-/g,"+").replace(/_/g,"/")).split("").map(function(e){return e.charCodeAt(0)}))}function V(e){return btoa(String.fromCharCode.apply(String,o(new Uint8Array(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function J(e){return z.apply(this,arguments)}function z(){return(z=c(s.mark(function e(t){var n;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return","47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU");case 2:return e.next=4,window.crypto.subtle.digest("SHA-256",t);case 4:return n=e.sent,e.abrupt("return",V(n));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(){return M.has("debug","hashing",!1)}window.crypto&&window.crypto.subtle&&"function"==typeof window.crypto.subtle.digest||console.error("ERROR: crypto.subtle.digest() browser API not available. Please access this page via https or localhost.");var G={},K={was_initialized:!1};function Q(e){return K.was_initialized||function(){var e,n=N(U());try{for(n.s();!(e=n.n()).done;)for(var r=e.value,o=0,i=Object.entries(F(r)[1]);o<i.length;o++){var a=t(i[o],2),s=a[0],c=a[1],u=K[c]||"",l=s.replace(/^[.\/]*/,"");l.length>u.length&&(K[c]=l)}}catch(e){n.e(e)}finally{n.f()}K.was_initialized=!0}(),K[e]||e}var Y=new TextEncoder;function X(e){return Z.apply(this,arguments)}function Z(){return(Z=c(s.mark(function e(t){var n,r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Y.encode(t),e.next=3,J(n);case 3:return r=e.sent,W()&&(G[r]={string:t,buffer:n}),e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ee={};function te(e){return ne.apply(this,arguments)}function ne(){return(ne=c(s.mark(function e(t){var n,r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!ee[t]){e.next=2;break}return e.abrupt("return",ee[t]);case 2:return n=H(t).replace(/\s+/g," "),e.next=5,X(n);case 5:return r=e.sent,W()&&(G[r].name="Module ".concat(Q(t))),e.abrupt("return",ee[t]=r);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var re=[];function oe(e){var t=X(function(e){var t=""+e,n=t.indexOf("{"),r=t.lastIndexOf("}"),o=t.slice(0,n).replace(/\s+/g," ").trim(),i=t.slice(n+1,r).trim();return"".concat(o," {\n").concat(i,"}")}(e));t.then(function(t){console.log("hashing class ".concat(e.name,": ").concat(t)),W()&&(G[t].name="Class ".concat(e.name))}),re.push(t)}function ie(e,t,n){return ae.apply(this,arguments)}function ae(){return(ae=c(s.mark(function e(t,n,r){var i,a,c,l,h,f;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="production"===w?[]:U().filter(function(e){var t=e.endsWith("/package.json")||e.endsWith("/ar.js");return t&&console.warn("excluding ".concat(e," from code hash")),!t}).sort(),e.next=4,Promise.all([].concat(o(i.map(te)),re));case 4:return a=e.sent,e.next=7,X([r].concat(o(a)).join("|"));case 7:return c=e.sent,e.next=10,X([t,u(n)].join("|"));case 10:return l=e.sent,e.next=13,X([l,c].join("|"));case 13:return h=e.sent,W()&&(G[c].name="All code hashes",G[l].name="Session name and options",G[h].name="Session ID",f=[].concat(o(a),[c,l,h]).map(function(e){return P({hash:e},G[e])}),console.log("Debug Hashing for session ".concat(h),f)),e.abrupt("return",{id:h,sessionHash:l,codeHash:c});case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function se(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ce(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ue,le=function(){function e(){n(this,e),this.values=[],this.resolves=[]}var t;return r(e,[{key:"next",value:(t=c(s.mark(function e(){var t=this;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.values.length>0)){e.next=2;break}return e.abrupt("return",this.values.shift());case 2:return e.abrupt("return",new Promise(function(e){return t.resolves.push(e)}));case 3:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"put",value:function(e){var t=this.resolves.shift();t?t(e):this.values.push(e)}},{key:"putAll",value:function(e){var t,n=se(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"peek",value:function(){return this.values[0]}},{key:"nextNonBlocking",value:function(){return this.values.shift()}},{key:"allNonBlocking",value:function(){if(0===this.values.length)return[];var e=this.values;return this.values=[],e}},{key:"size",get:function(){return this.values.length-this.resolves.length}}]),e}();!function(){function e(e){this.mode=n.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,r=this.data.length;t<r;t++){var o=[],i=this.data.charCodeAt(t);i>65536?(o[0]=240|(1835008&i)>>>18,o[1]=128|(258048&i)>>>12,o[2]=128|(4032&i)>>>6,o[3]=128|63&i):i>2048?(o[0]=224|(61440&i)>>>12,o[1]=128|(4032&i)>>>6,o[2]=128|63&i):i>128?(o[0]=192|(1984&i)>>>6,o[1]=128|63&i):o[0]=i,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;t<n;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[r][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var r=-1;r<=7;r++)t+r<=-1||this.moduleCount<=t+r||(this.modules[e+n][t+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;n<8;n++){this.makeImpl(!0,n);var r=o.getLostPoint(this);(0==n||e>r)&&(e=r,t=n)}return t},createMovieClip:function(e,t,n){var r=e.createEmptyMovieClip(t,n);this.make();for(var o=0;o<this.modules.length;o++)for(var i=1*o,a=0;a<this.modules[o].length;a++){var s=1*a;this.modules[o][a]&&(r.beginFill(0,100),r.moveTo(s,i),r.lineTo(s+1,i),r.lineTo(s+1,i+1),r.lineTo(s,i+1),r.endFill())}return r},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=o.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var r=e[t],i=e[n];if(null==this.modules[r][i])for(var a=-2;a<=2;a++)for(var s=-2;s<=2;s++)this.modules[r+a][i+s]=-2==a||2==a||-2==s||2==s||0==a&&0==s}},setupTypeNumber:function(e){for(var t=o.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var r=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(n=0;n<18;n++)r=!e&&1==(t>>n&1),this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=r},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,r=o.getBCHTypeInfo(n),i=0;i<15;i++){var a=!e&&1==(r>>i&1);i<6?this.modules[i][8]=a:i<8?this.modules[i+1][8]=a:this.modules[this.moduleCount-15+i][8]=a}for(i=0;i<15;i++)a=!e&&1==(r>>i&1),i<8?this.modules[8][this.moduleCount-i-1]=a:i<9?this.modules[8][15-i-1+1]=a:this.modules[8][15-i-1]=a;this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,r=this.moduleCount-1,i=7,a=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var c=0;c<2;c++)if(null==this.modules[r][s-c]){var u=!1;a<e.length&&(u=1==(e[a]>>>i&1)),o.getMask(t,r,s-c)&&(u=!u),this.modules[r][s-c]=u,-1==--i&&(a++,i=7)}if((r+=n)<0||this.moduleCount<=r){r-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,r){for(var i=c.getRSBlocks(e,n),a=new u,s=0;s<r.length;s++){var l=r[s];a.put(l.mode,4),a.put(l.getLength(),o.getLengthInBits(l.mode,e)),l.write(a)}var h=0;for(s=0;s<i.length;s++)h+=i[s].dataCount;if(a.getLengthInBits()>8*h)throw new Error("code length overflow. ("+a.getLengthInBits()+">"+8*h+")");for(a.getLengthInBits()+4<=8*h&&a.put(0,4);a.getLengthInBits()%8!=0;)a.putBit(!1);for(;!(a.getLengthInBits()>=8*h||(a.put(t.PAD0,8),a.getLengthInBits()>=8*h));)a.put(t.PAD1,8);return t.createBytes(a,i)},t.createBytes=function(e,t){for(var n=0,r=0,i=0,a=new Array(t.length),c=new Array(t.length),u=0;u<t.length;u++){var l=t[u].dataCount,h=t[u].totalCount-l;r=Math.max(r,l),i=Math.max(i,h),a[u]=new Array(l);for(var f=0;f<a[u].length;f++)a[u][f]=255&e.buffer[f+n];n+=l;var d=o.getErrorCorrectPolynomial(h),p=new s(a[u],d.getLength()-1).mod(d);for(c[u]=new Array(d.getLength()-1),f=0;f<c[u].length;f++){var v=f+p.getLength()-c[u].length;c[u][f]=v>=0?p.get(v):0}}var y=0;for(f=0;f<t.length;f++)y+=t[f].totalCount;var m=new Array(y),g=0;for(f=0;f<r;f++)for(u=0;u<t.length;u++)f<a[u].length&&(m[g++]=a[u][f]);for(f=0;f<i;f++)for(u=0;u<t.length;u++)f<c[u].length&&(m[g++]=c[u][f]);return m};for(var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},r={L:1,M:0,Q:3,H:2},o={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;o.getBCHDigit(t)-o.getBCHDigit(o.G15)>=0;)t^=o.G15<<o.getBCHDigit(t)-o.getBCHDigit(o.G15);return(e<<10|t)^o.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;o.getBCHDigit(t)-o.getBCHDigit(o.G18)>=0;)t^=o.G18<<o.getBCHDigit(t)-o.getBCHDigit(o.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return o.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case 0:return(t+n)%2==0;case 1:return t%2==0;case 2:return n%3==0;case 3:return(t+n)%3==0;case 4:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case 5:return t*n%2+t*n%3==0;case 6:return(t*n%2+t*n%3)%2==0;case 7:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new s([1],0),n=0;n<e;n++)t=t.multiply(new s([1,i.gexp(n)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:case n.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,r=0;r<t;r++)for(var o=0;o<t;o++){for(var i=0,a=e.isDark(r,o),s=-1;s<=1;s++)if(!(r+s<0||t<=r+s))for(var c=-1;c<=1;c++)o+c<0||t<=o+c||0==s&&0==c||a==e.isDark(r+s,o+c)&&i++;i>5&&(n+=3+i-5)}for(r=0;r<t-1;r++)for(o=0;o<t-1;o++){var u=0;e.isDark(r,o)&&u++,e.isDark(r+1,o)&&u++,e.isDark(r,o+1)&&u++,e.isDark(r+1,o+1)&&u++,0!=u&&4!=u||(n+=3)}for(r=0;r<t;r++)for(o=0;o<t-6;o++)e.isDark(r,o)&&!e.isDark(r,o+1)&&e.isDark(r,o+2)&&e.isDark(r,o+3)&&e.isDark(r,o+4)&&!e.isDark(r,o+5)&&e.isDark(r,o+6)&&(n+=40);for(o=0;o<t;o++)for(r=0;r<t-6;r++)e.isDark(r,o)&&!e.isDark(r+1,o)&&e.isDark(r+2,o)&&e.isDark(r+3,o)&&e.isDark(r+4,o)&&!e.isDark(r+5,o)&&e.isDark(r+6,o)&&(n+=40);var l=0;for(o=0;o<t;o++)for(r=0;r<t;r++)e.isDark(r,o)&&l++;return n+Math.abs(100*l/t/t-50)/5*10}},i={glog:function(e){if(e<1)throw new Error("glog("+e+")");return i.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return i.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},a=0;a<8;a++)i.EXP_TABLE[a]=1<<a;for(a=8;a<256;a++)i.EXP_TABLE[a]=i.EXP_TABLE[a-4]^i.EXP_TABLE[a-5]^i.EXP_TABLE[a-6]^i.EXP_TABLE[a-8];for(a=0;a<255;a++)i.LOG_TABLE[i.EXP_TABLE[a]]=a;function s(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var r=0;r<e.length-n;r++)this.num[r]=e[r+n]}function c(e,t){this.totalCount=e,this.dataCount=t}function u(){this.buffer=[],this.length=0}s.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),n=0;n<this.getLength();n++)for(var r=0;r<e.getLength();r++)t[n+r]^=i.gexp(i.glog(this.get(n))+i.glog(e.get(r)));return new s(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=i.glog(this.get(0))-i.glog(e.get(0)),n=new Array(this.getLength()),r=0;r<this.getLength();r++)n[r]=this.get(r);for(r=0;r<e.getLength();r++)n[r]^=i.gexp(i.glog(e.get(r))+t);return new s(n,0).mod(e)}},c.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],c.getRSBlocks=function(e,t){var n=c.getRsBlockTable(e,t);if(null==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var r=n.length/3,o=[],i=0;i<r;i++)for(var a=n[3*i+0],s=n[3*i+1],u=n[3*i+2],l=0;l<a;l++)o.push(new c(s,u));return o},c.getRsBlockTable=function(e,t){switch(t){case r.L:return c.RS_BLOCK_TABLE[4*(e-1)+0];case r.M:return c.RS_BLOCK_TABLE[4*(e-1)+1];case r.Q:return c.RS_BLOCK_TABLE[4*(e-1)+2];case r.H:return c.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},u.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var l=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],h=function(){var e=function(e,t){this._bIsPainted=!1,this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._bSupportDataURI=null};return e.prototype.draw=function(e){var t=this._oContext,n=this._htOption,r=e.getModuleCount(),o=n.width/r,i=n.height/r,a=Math.round(o),s=Math.round(i);this.clear();for(var c=0;c<r;c++)for(var u=0;u<r;u++){var l=e.isDark(c,u),h=u*o,f=c*i;t.strokeStyle=l?n.colorDark:n.colorLight,t.lineWidth=1,t.fillStyle=l?n.colorDark:n.colorLight,t.fillRect(h,f,o,i),t.strokeRect(Math.floor(h)+.5,Math.floor(f)+.5,a,s),t.strokeRect(Math.ceil(h)-.5,Math.ceil(f)-.5,a,s)}this._bIsPainted=!0},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},e}();(ue=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:r.H},"string"==typeof t&&(t={text:t}),t)for(var n in t)this._htOption[n]=t[n];"string"==typeof e&&(e=document.getElementById(e)),this._htOption.useSVG&&(h=svgDrawer),this._el=e,this._oQRCode=null,this._oDrawing=new h(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(e){this._oQRCode=new t(function(e,t){for(var n=1,o=function(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}(e),i=0,a=l.length;i<=a;i++){var s=0;switch(t){case r.L:s=l[i][0];break;case r.M:s=l[i][1];break;case r.Q:s=l[i][2];break;case r.H:s=l[i][3]}if(o<=s)break;n++}if(n>l.length)throw new Error("Too long data");return n}(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._oDrawing.draw(this._oQRCode)},ue.prototype.clear=function(){this._oDrawing.clear()},ue.prototype.getCanvas=function(){for(var e=0;e<this._el.children.length;e++){var t=this._el.children[e];if("CANVAS"===t.tagName)return t}return null},ue.CorrectLevel=r}();var he=ue;function fe(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var pe=Date.now();"undefined"==typeof performance&&(window.performance={now:function(){return Date.now()-pe}});var ve=["simulate","update","render","snapshot"],ye={total:"black",update:"blue",render:"magenta",simulate:"yellow",snapshot:"green",backlog:"red",network:"lightgray"},me=null,ge=null,we=null,be=null;function ke(e){for(me=e;e.firstChild;)e.removeChild(e.firstChild);e.style.background="#faf0dc",(ge=document.createElement("div")).id="text_stats",ge.style.padding=5,ge.style.background="rgba(255,255,255,0.2)",ge.style.fontFamily="sans-serif",e.appendChild(ge),e.title=Object.entries(ye).map(function(e){var n=t(e,2),r=n[0],o=n[1];return"".concat(o,": ").concat(r)}).join("\n"),(we=document.createElement("canvas")).width=Math.min(125,window.innerWidth)*window.devicePixelRatio,we.height=125*window.devicePixelRatio,we.style.width="100%",e.appendChild(we),(be=we.getContext("2d")).scale(window.devicePixelRatio,window.devicePixelRatio)}var Se=[],xe=0,Ce=!1,Ee=Oe(0);function Oe(e){return{start:e,total:0,items:{},users:0,backlog:0,network:0,latency:0,activity:1e3,connected:Ce}}function _e(e){for(Ee.total=e-Ee.start,Se.push(Ee);Se.length>Math.min(120,window.innerWidth);)Se.shift();if(me&&"none"!==window.getComputedStyle(me).display){var t=Se.slice(1).filter(function(e){return e.total}),n=t.map(function(e){return e.total}).reduce(function(e,t){return e+t},0)/t.length;Math.max.apply(Math,o(t.map(function(e){return Math.max(e.backlog,e.network)}))),xe=1e3,ge.parentElement||(console.warn("who broke the stats div and canvas?"),me.appendChild(ge),me.appendChild(we)),ge.innerText="".concat(Ee.users," users, ").concat(Math.round(1e3/n)," fps, ")+(Ee.backlog<100&&Ee.activity<1e3?"latency: ".concat(Ee.latency," ms"):"backlog: ".concat(Ee.backlog<100?"0.0":(Ee.backlog/1e3).toFixed(1)," s")),be.clearRect(0,0,we.width,we.height);for(var r=function(e){return 20*(1-e/(1e3/60))+60},i=function(e){return r(e/xe*-2*(1e3/60))+5},a=0;a<Se.length;a++){var s=Se[a],c=a+.5,u=r(0);be.beginPath(),be.moveTo(c,u),be.lineTo(c,r(s.total)),be.strokeStyle=ye[s.connected?"total":"network"],be.stroke(),be.beginPath(),be.moveTo(c,u),u=r(s.total);var l,h=0,f=fe(ve);try{for(f.s();!(l=f.n()).done;){var d=l.value;s.items[d]&&(h+=s.items[d],u=r(h),be.lineTo(c,u),be.strokeStyle=ye[d],be.stroke(),be.beginPath(),be.moveTo(c,u))}}catch(e){f.e(e)}finally{f.f()}s.network&&(be.beginPath(),be.moveTo(c,i(0)),be.lineTo(c,i(s.network)),be.strokeStyle=ye.network,be.stroke())}be.strokeStyle="rgba(255, 255, 255, 0.2)";for(var p=0;p<60;p+=1e3/60)be.moveTo(0,r(p)),be.lineTo(120,r(p)),be.stroke()}}var Ae=[],Me={animationFrame:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_e(e),Ee=Oe(e);for(var r=0,o=Object.entries(n);r<o.length;r++){var i=t(o[r],2),a=i[0],s=i[1];this[a](s)}},begin:function(e){var t=performance.now();Ee.items[e]=(Ee.items[e]||0)-t;var n=Ae[Ae.length-1];return n&&(Ee.items[n]+=t),Ae.push(e),t},end:function(e){var t=performance.now();if(Ee.items[e]+=t,Ae.pop()!==e)throw Error("Unmatched stats calls for "+e);var n=Ae[Ae.length-1];return n&&(Ee.items[n]-=t),t},backlog:function(e){Ee.backlog=Math.max(e,Ee.backlog)},network:function(e){Ee.network=e},starvation:function(e){Ee.network=e},latency:function(e){Ee.latency=e},activity:function(e){Ee.activity=e},users:function(e){Ee.users=e},connected:function(e){Ee.connected=Ce=e}};function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var qe,je,Pe,Ne="ontouchstart"in document.documentElement,De=Ne?20:12,Re=Ne?0:15;qe="\n        #croquet_dock { position: absolute; z-index: 2; border: 3px solid white; bottom: 6px; left: 6px; width: 84px; height: 36px; box-sizing: border-box; background: white; opacity: 0.4; transition: all ".concat(.3,"s ease; }\n        #croquet_dock.active { opacity: 0.95; border-radius: 12px; }\n        #croquet_dock_bar { position: absolute; border: 3px solid white; width: 100%; height: 30px; box-sizing: border-box; background: white; }\n\n        #croquet_badge { position: absolute; width: 72px; height: 24px; top: 50%; transform: translate(0px, -50%); cursor: none; }\n        #croquet_dock.active #croquet_badge { left: 2%; }\n\n        .croquet_dock_button { position: absolute; width: ").concat(De,"%; height: 90%; top: 50%; transform: translate(0px, -50%); border-radius: 20%; }\n        .croquet_dock_button:focus { outline: 0; }\n        .croquet_dock_button canvas { position: absolute; width: 100%; height: 100%; top: 0px; left: 0px; }\n        #croquet_dock:not(.active) .croquet_dock_button { display: none; }\n        #croquet_dock_left { right: ").concat(2+Re+De+2,"% }\n        #croquet_dock_right { right: ").concat(2+Re,"%; }\n        #croquet_dock_pin { right: ").concat(2,"%; }\n        #croquet_dock_pin.pinned { background: #cce6ff; }\n\n        #croquet_dock_content { position: absolute; left: ").concat(2,"px; top: ").concat(2,"px; right: ").concat(2,"px; bottom: ").concat(2,"px; background: white; overflow: hidden; }\n        #croquet_dock:not(.active) #croquet_dock_content { display: none; }\n        #croquet_dock:not(.active) #croquet_dock_content div { display: none; }\n\n        #croquet_qrcode { position: absolute; border: 6px solid white; width: 100%; height: 100%;box-sizing: border-box; cursor: crosshair; }\n        #croquet_qrcode:not(.active) { display: none; }\n        #croquet_qrcode canvas { image-rendering: pixelated; }\n\n        #croquet_stats { position: absolute; width: 70%; height: 90%; left: 15%; top: 5%; opacity: 0.8; font-family: sans-serif; }\n        #croquet_stats:not(.active) { display: none; }\n\n        #croquet_spinnerOverlay {\n            z-index: 1000;\n            position: fixed;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color:#333;\n            opacity:0.9;\n            display:flex;\n            align-items:center;\n            justify-content:center;\n            transition: opacity 1.0s ease-out;\n        }\n        /* https://github.com/lukehaas/css-loaders */\n        @keyframes dots {\n            0%, 80%, 100% { box-shadow: 0 2.5em 0 -1.3em; }\n            40% { box-shadow: 0 2.5em 0 0; }\n        }\n        #croquet_loader,\n        #croquet_loader:before,\n        #croquet_loader:after {\n          border-radius: 50%;\n          width: 2.5em;\n          height: 2.5em;\n          animation: dots 1.8s infinite ease-in-out;\n        }\n        #croquet_loader {\n          color: #fff;\n          font-size: 10px;\n          margin: 80px auto;\n          position: relative;\n          text-indent: -9999em;\n          animation-delay: -0.16s;\n        }\n        #croquet_loader:before,\n        #croquet_loader:after {\n          content: '';\n          position: absolute;\n          top: 0;\n        }\n        #croquet_loader:before { left: -3.5em; animation-delay: -0.32s; }\n        #croquet_loader:after { left: 3.5em; }\n"),(je=document.createElement("style")).innerHTML=qe,document.head.insertBefore(je,document.head.getElementsByTagName("style")[0]),(Pe=document.createElement("style")).innerHTML="/*!\n        * Toastify js 1.5.0\n        * https://github.com/apvarun/toastify-js\n        * @license MIT licensed\n        *\n        * Copyright (C) 2018 Varun A P\n        */\n        .toastify {\n            padding: 12px 20px;\n            color: #ffffff;\n            display: inline-block;\n            box-shadow: 0 3px 6px -1px rgba(0, 0, 0, 0.12), 0 10px 36px -4px rgba(77, 96, 232, 0.3);\n            background: -webkit-linear-gradient(315deg, #73a5ff, #5477f5);\n            background: linear-gradient(135deg, #73a5ff, #5477f5);\n            position: fixed;\n            opacity: 0;\n            transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);\n            border-radius: 2px;\n            cursor: pointer;\n            text-decoration: none;\n            max-width: calc(50% - 20px);\n            z-index: 2147483647;\n        }\n        .toastify.on {\n            opacity: 1;\n        }\n        .toast-close {\n            opacity: 0.4;\n            padding: 0 5px;\n        }\n        .toastify-right {\n            right: 15px;\n        }\n        .toastify-left {\n            left: 15px;\n        }\n        .toastify-top {\n            top: -150px;\n        }\n        .toastify-bottom {\n            bottom: -150px;\n        }\n        .toastify-rounded {\n            border-radius: 25px;\n        }\n        .toastify-avatar {\n            width: 1.5em;\n            height: 1.5em;\n            margin: 0 5px;\n            border-radius: 2px;\n        }\n        @media only screen and (max-width: 360px) {\n            .toastify-right, .toastify-left {\n                margin-left: auto;\n                margin-right: auto;\n                left: 0;\n                right: 0;\n                max-width: fit-content;\n            }\n        }\n\n        .toastify { font-family: sans-serif; border-radius: 8px; }\n",document.head.insertBefore(Pe,document.head.getElementsByTagName("style")[0]);var Le=new Set;function Be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&et.showMessage(e,Ie(Ie({},t),{},{level:"error"}))}function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&et.showMessage(e,Ie(Ie({},t),{},{level:"warning"}))}function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&et.showMessage(e,Ie(Ie({},t),{},{level:"status"}))}function He(e,t){console.error("Error during ".concat(e),t);var n=(t.stack||"").split("\n").filter(function(e){return!e.match(/croquet-.*\.min.js/)}).join("\n");et.showMessage("<b>Error during ".concat(e,": ").concat(t.message,"</b>\n\n").concat(n).replace(/\n/g,"<br>"),{level:"error",duration:1e4,stopOnFocus:!0})}function $e(e,t){var n=et.root;if(!1===n)return null;var r,o=Ie({text:e,duration:3e3,gravity:"bottom",position:"left",backgroundColor:"linear-gradient(to right, #00b09b, #96c93d)",stopOnFocus:!0},t);return n instanceof Element&&n!==document.body?(r=n.id)||(n.id=r="_croquetToastParent"):"string"==typeof n&&(r=n),r&&(o.selector=r),l(o).showToast()}var Ve,Je,ze={get pinned(){return"true"===localStorage["croquet-debug-ui-pinned"]},set pinned(e){localStorage["croquet-debug-ui-pinned"]=!!e},get activePage(){return localStorage["croquet-debug-ui-activePage"]},set activePage(e){localStorage["croquet-debug-ui-activePage"]=e}},We=function(e){e.preventDefault(),e.stopPropagation()};function Ge(e,t,n){var r=document.createElement("canvas"),o=r.width=40*De/12,i=r.height=60,a=r.getContext("2d");a.font="36px Arial",a.textAlign="center",a.textBaseline="middle",a.fillStyle="black",a.fillText(e,o/2,.55*i);var s=document.createElement("button");s.id=t,s.className="croquet_dock_button";var c=function(e){e.preventDefault(),e.stopPropagation(),n()};return Ne?(s.ontouchstart=c,s.ontouchend=We,s.onpointerdown=We,s.onpointerup=We):(s.onclick=c,s.onpointerdown=We,s.onpointerup=We),s.appendChild(r),s}function Ke(e,t){if(!1!==et.badge){var n=function(e){for(var t=new h(e),n=["bcdfghjklmnpqrstvwxyz","aeiou"],r="",o=0;o<5;o++)r+=n[o%2][t.quick()*n[o%2].length|0];return r}(t);for(document.title=document.title.replace(/:.*/,""),document.title+=":"+n;e.firstChild;)e.removeChild(e.firstChild);var r=document.createElement("canvas"),o=r.width=120,i=r.height=40;r.style.width="100%",e.appendChild(r);var a=r.getContext("2d"),s=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new h(e),r=[],o=0;o<t;o++)r.push("hsl(".concat(360*n.quick(),", 50%, 70%)"));return r}(t,2);a.fillStyle=s[0],a.beginPath(),a.moveTo(0,0),a.lineTo(0,i),a.lineTo(o,0),a.closePath(),a.fill(),a.fillStyle=s[1],a.beginPath(),a.moveTo(o,i),a.lineTo(o,0),a.lineTo(0,i),a.closePath(),a.fill(),a.font="30px Arial",a.textAlign="center",a.textBaseline="middle",a.fillStyle="black",a.fillText(n,o/2,i/2)}}function Qe(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.firstChild;)e.removeChild(e.firstChild);return new he(e,Ie({text:t,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:he.CorrectLevel.L},n))}var Ye=0;function Xe(e){if(Je!==e)if(!1===et.sync&&(e=!1),e&&!Ve&&(Ve=function(){var e=document.createElement("div");e.id="croquet_spinnerOverlay";var t=document.createElement("div");return t.id="croquet_loader",t.innerText="Catching up...",e.appendChild(t),e}()),Je=e,e)clearTimeout(Ye),Ye=setTimeout(function(){Je&&(Ze(et.root,function(){return document.body}).appendChild(Ve),Ve.style.opacity=.9)},500);else{if(!Ve)return;clearTimeout(Ye),Ve.style.opacity=0,Ye=setTimeout(function(){Je||Ve.parentElement&&Ve.parentElement.removeChild(Ve)},500)}}function Ze(e,t){if(!1===e)return!1;if(e instanceof Element)return e;if("string"==typeof e){var n=document.getElementById(e);if(n)return n}return t?t():null}var et={sessionURL:window.location.href,root:document.body,sync:!0,messages:!1,badge:!1,stats:!1,qrcode:!1,makeWidgetDock:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!M.nodock){var t=document.getElementById("croquet_dock");t&&t.parentElement.removeChild(t);var n=Ze(et.root);if(n){var r=document.createElement("div");r.id="croquet_dock",n.appendChild(r);var o,i=document.createElement("div");i.id="croquet_dock_bar",r.appendChild(i),!1!==e.badge&&((o=document.createElement("div")).id="croquet_badge",i.appendChild(o),et.badge=o);var a=document.createElement("div");a.id="croquet_dock_content",r.appendChild(a);var s,c,u=[];if(!1!==e.qrcode)et.sessionURL&&((s=document.createElement("div")).id="croquet_qrcode",a.appendChild(s),u.push(s.id),et.qrcode=s);if(!1!==e.stats&&((c=document.createElement("div")).id="croquet_stats",a.appendChild(c),u.push(c.id),et.stats=c),u.length){function l(e){var t,n=u.length,r=0;if(ze.activePage){var o=u.indexOf(ze.activePage);o>=0?(r=o,t=document.getElementById(ze.activePage)):ze.activePage=null}var i,a=u[(r+n+e)%n];a===ze.activePage?i=t:(t&&t.classList.remove("active"),i=document.getElementById(a)),i&&i.classList.add("active"),ze.activePage=a}u.length>1&&(i.appendChild(Ge("<","croquet_dock_left",function(){return l(-1)})),i.appendChild(Ge(">","croquet_dock_right",function(){return l(1)}))),l(0)}if(!Ne){var h=Ge("ðŸ“Œ","croquet_dock_pin",function(){ze.pinned=!ze.pinned,f()}),f=function(){ze.pinned?h.classList.add("pinned"):h.classList.remove("pinned")};f(),i.appendChild(h)}var d=function(e){r.style.width="".concat(e,"px"),r.style.height="".concat(1.18*e,"px");var t=18*e/100;i.style.height="".concat(t,"px"),a.style.top="".concat(t+2,"px"),o&&(o.style.height="".concat(.9*t,"px"),o.style.width="".concat(.9*t*3,"px")),s&&(s.style.border="".concat(8*e/200,"px solid white"))},p=200,v=function(){r.classList.add("active"),d(p),setTimeout(function(){return r.style.transition="none"},300)},y=function(){r.style.transition="",r.classList.remove("active"),r.style.width=r.style.height="",i.style.height="",a.style.top="",o&&(o.style.height=o.style.width=""),s&&(s.style.border="")};if(Ne)y(),r.ontouchstart=function(e){e.preventDefault(),e.stopPropagation(),r.classList.contains("active")?y():v()},r.ontouchend=We,r.onpointerdown=We,r.onpointerup=We;else{ze.pinned?v():y();var m=0;r.onwheel=function(e){e.preventDefault(),e.stopPropagation();var t=Date.now();if(!(t-m<100)){m=t;var n=e.deltaY;n=Math.sign(n)*Math.min(5,Math.abs(n));var o=.8*Math.min(window.innerWidth,window.innerHeight);p=Math.max(166,Math.min(o,r.offsetWidth*Math.pow(1.05,n))),d(p)}},r.onmouseenter=v,r.onmouseleave=function(){ze.pinned||y()}}}}},makeSessionWidgets:function(e){!function(e){if(e&&!1!==et.root){var t=Ze(et.badge);t&&Ke(t,e)}}(e),function(){if(!1!==et.root&&!1!==et.qrcode&&!M.noqr){var e=et.sessionURL;if(e){var t=Ze(et.qrcode);t&&(Ne||(t.onclick=function(t){t.preventDefault(),t.stopPropagation(),window.open(e)}),Qe(t,e).getCanvas().style.width="100%")}else console.warn("App.sessionURL is not set")}}(),function(){if(!1!==et.root&&!M.nostats){var e=Ze(et.stats);e&&ke(e)}}()},makeQRCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!et.sessionURL)return null;var t=Qe(document.createElement("div"),et.sessionURL,e);return t&&t.getCanvas()},clearSessionMoniker:function(){!1!==et.badge&&(document.title=document.title.replace(/:.*/,""))},showSyncWait:function(e){!1===et.root&&(e=!1),Xe(e)},messageFunction:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("once"===t.only){if(Le.has(e))return null;Le.add(e)}var n,r=t.level;return"error"===r?(n="red",console.error(e)):"warning"===r?(n="gold",console.warn(e)):n="#aaa",$e(e,Ie({backgroundColor:n},t))},showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M.nomessages||!1===et.root||!1===et.messages||!et.messageFunction?null:et.messageFunction(e,t)},autoSession:function(){var e=window.location.hash.slice(1);return e||(e=Math.floor(Math.random()*Math.pow(2,53)).toString(36),window.location.hash=e,et.sessionURL=window.location.href),window.onhashchange=function(){return window.location.reload()},e}};function tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}var nt=function(e){d(o,y);var t=tt(o);function o(){return n(this,o),t.apply(this,arguments)}return r(o,[{key:"poll",value:function(){var e=f(v(o.prototype),"poll",this).call(this);return this.array[this.size]=null,e}},{key:"asArray",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"asUnsortedArray",value:function(){return this.array.slice(0,this.size)}}]),o}();function rt(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ot(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function it(e,t){function n(e){var n,r=rt(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.for===t&&e.delete(o)}}catch(e){r.e(e)}finally{r.f()}}return n(e.immediate),n(e.oncePerFrame),n(e.oncePerFrameWhileSynced),n(e.queued),e.immediate.size+e.queued.size+e.oncePerFrame.size+e.oncePerFrameWhileSynced.size}var at=new(function(){function e(){n(this,e),this.subscriptions={},this.queuedEvents=[],this.perFrameEvents=new Map,this.perSyncedFrameEvents=new Map,this.id=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}),this.lastId=0}return r(e,[{key:"register",value:function(e){return this.id+"/V"+ ++this.lastId}},{key:"deregister",value:function(e){}},{key:"addSubscription",value:function(e,t,n,r,o){if("vote"!==o){var i=e+":"+t,a=r;a.for=n;var s=this.subscriptions[i];if(s||(s=this.subscriptions[i]={immediate:new Set,queued:new Set,oncePerFrame:new Set,oncePerFrameWhileSynced:new Set}),!s[o])throw Error('Unknown subscribe() option: handling="'.concat(o,'"'));s[o].add(a)}else this.addSubscription(e,t+"#__vote",n,r,"immediate")}},{key:"removeSubscription",value:function(e,t,n){var r=e+":"+t,o=this.subscriptions[r];o&&0===it(o,n)&&delete this.subscriptions[r],t.endsWith("#__vote")||this.removeSubscription(e,t+"#__vote",n)}},{key:"removeAllSubscriptionsFor",value:function(e){for(var n="".concat(e,":"),r=0,o=Object.entries(this.subscriptions);r<o.length;r++){var i=t(o[r],2),a=i[0],s=i[1];a.startsWith(n)?delete this.subscriptions[a]:0===it(s,e)&&delete this.subscriptions[a]}}},{key:"handleEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e()},r=this.subscriptions[e];r&&(r.queued.size>0&&this.queuedEvents.push({topic:e,data:t}),r.oncePerFrame.size>0&&this.perFrameEvents.set(e,t),r.oncePerFrameWhileSynced.size>0&&this.perSyncedFrameEvents.set(e,t),r.immediate.size>0&&n(function(){var e,n=rt(r.immediate);try{for(n.s();!(e=n.n()).done;)(0,e.value)(t)}catch(e){n.e(e)}finally{n.f()}}))}},{key:"processFrameEvents",value:function(e){var n,r=this,o=0,i=function(e,t,n){var i=r.subscriptions[e];if(i){var a,s=rt(i[n]);try{for(s.s();!(a=s.n()).done;)(0,a.value)(t),o++}catch(e){s.e(e)}finally{s.f()}}},a=rt(this.queuedEvents);try{for(a.s();!(n=a.n()).done;){var s=n.value;i(s.topic,s.data,"queued")}}catch(e){a.e(e)}finally{a.f()}this.queuedEvents.length=0;var c,u=rt(this.perFrameEvents);try{for(u.s();!(c=u.n()).done;){var l=t(c.value,2);i(l[0],l[1],"oncePerFrame")}}catch(e){u.e(e)}finally{u.f()}if(this.perFrameEvents.clear(),e){var h,f=rt(this.perSyncedFrameEvents);try{for(f.s();!(h=f.n()).done;){var d=t(h.value,2);i(d[0],d[1],"oncePerFrameWhileSynced")}}catch(e){f.e(e)}finally{f.f()}this.perSyncedFrameEvents.clear()}var p,v=rt(this.queuedEvents);try{for(v.s();!(p=v.n()).done;){var y=p.value;i(y.topic,y.data,"queued")}}catch(e){v.e(e)}finally{v.f()}return this.queuedEvents.length=0,o}}]),e}()),st={get subscribe(){return(st={subscribe:M.has("debug","subscribe",!1)}).subscribe}},ct=function(){function e(t){n(this,e),this.island=t}return r(e,[{key:"register",value:function(e){return this.island.registerModel(e)}},{key:"deregister",value:function(e){this.island.deregisterModel(e.id)}},{key:"publish",value:function(e,t,n){this.island.publishFromModel(n,e,t)}},{key:"subscribe",value:function(e,t,n,r){return st.subscribe&&console.log('Model.subscribe("'.concat(t,":").concat(n,'", ').concat(e," ").concat((""+r).replace(/\([\s\S]*/,""),")")),this.island.addSubscription(e,t,n,r)}},{key:"unsubscribe",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*";st.subscribe&&console.log("Model.unsubscribe(".concat(t,":").concat(n,'", ').concat(e," ").concat((""+r).replace(/\([\s\S]*/,""),")")),this.island.removeSubscription(e,t,n,r)}},{key:"unsubscribeAll",value:function(e){st.subscribe&&console.log("Model.unsubscribeAll(".concat(e," ").concat(e.id,")")),this.island.removeAllSubscriptionsFor(e)}},{key:"future",value:function(e,t,n,r){if(lt&&lt.equal(this))return this.island.future(e,t,n,r);if(t)throw Error("tOffset not supported from cross-realm future send yet.");var o=this.island;return new Proxy(e,{get:function(t,n){if("function"==typeof e[n])return new Proxy(e[n],{apply:function(t,r,i){o.callModelMethod(e.id,n,i)}});throw Error("Tried to call "+n+"() on future of "+Object.getPrototypeOf(e).constructor.name+" which is not a function")}})}},{key:"random",value:function(){return this.island.random()}},{key:"now",value:function(){return this.island.time}},{key:"equal",value:function(t){return t instanceof e&&t.island===this.island}}]),e}(),ut=function(){function e(t){n(this,e),this.island=t}return r(e,[{key:"register",value:function(e){return at.register(e)}},{key:"deregister",value:function(e){at.deregister(e)}},{key:"publish",value:function(e,t,n){this.island.publishFromView(n,e,t)}},{key:"subscribe",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"queued";st.subscribe&&console.log('View.subscribe("'.concat(r,":").concat(e,'", ').concat(t," ").concat(n.name||(""+n).replace(/\([\s\S]*/,"")," [").concat(o,"])")),at.addSubscription(r,e,t,n,o)}},{key:"unsubscribe",value:function(e,t,n,r){st.subscribe&&console.log('View.unsubscribe("'.concat(r,":").concat(e,'", ').concat(t," ").concat(n.name||(""+n).replace(/\([\s\S]*/,""),")")),at.removeSubscription(r,e,t,n)}},{key:"unsubscribeAll",value:function(e){st.subscribe&&console.log("View.unsubscribeAll(".concat(e,")")),at.removeAllSubscriptionsFor(e)}},{key:"future",value:function(e,t){return t?new Proxy(e,{get:function(n,r){if("function"==typeof e[r])return new Proxy(e[r],{apply:function(n,i,a){setTimeout(function(){e.id&&e[r].apply(e,o(a))},t)}});throw Error("Tried to call "+r+"() on future of "+Object.getPrototypeOf(e).constructor.name+" which is not a function")}}):e}},{key:"random",value:function(){return Math.random()}},{key:"now",value:function(){return this.island.time}},{key:"externalNow",value:function(){return this.island.controller.time}},{key:"isSynced",value:function(){return!!this.island.controller.synced}},{key:"equal",value:function(t){return t instanceof e&&t.island===this.island}}]),e}(),lt=null;function ht(){if(!lt)throw Error("Tried to execute code that requires realm outside of realm.");return lt}function ft(e,t){if(null!==lt)throw Error("Can't switch realms from inside realm");try{return lt=new ct(e),t()}finally{lt=null}}function dt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!==lt&&!n)throw Error("Can't switch realms from inside realm");var r=lt;try{return lt=new ut(e),t()}finally{lt=r}}function pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}function vt(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yt(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(){var e,t=function(e){return e!=e},n=Math.sqrt,r=.7853981633974483,o=function(e){var o,i,a,s,c;if(t(e))return NaN;if(e>0?a=e:(o=!0,a=-e),a>1)return NaN;if(a>.625)s=(i=1-a)*function(e){var t,n;return 0===e?.08333333333333809:((e<0?-e:e)<=1?(t=28.536655482610616+e*(e*(6.968710824104713+e*(.002967721961301243*e-.5634242780008963))-25.56901049652825),n=342.43986579130785+e*(e*(147.0656354026815+e*(1*e-21.947795316429207))-383.8770957603691)):(t=.002967721961301243+(e=1/e)*(e*(6.968710824104713+e*(28.536655482610616*e-25.56901049652825))-.5634242780008963),n=1+e*(e*(147.0656354026815+e*(342.43986579130785*e-383.8770957603691))-21.947795316429207)),t/n)}(i),i=n(i+i),c=r-i,c-=i=i*s-6.123233995736766e-17,c+=r;else{if(a<1e-8)return e;c=a*(c=(i=a*a)*function(e){var t,n;return 0===e?.16666666666666713:((e<0?-e:e)<=1?(t=e*(19.562619833175948+e*(e*(5.444622390564711+e*(.004253011369004428*e-.6019598008014124))-16.262479672107002))-8.198089802484825,n=e*(139.51056146574857+e*(e*(70.49610280856842+e*(1*e-14.740913729888538))-147.1791292232726))-49.18853881490881):(t=.004253011369004428+(e=1/e)*(e*(5.444622390564711+e*(e*(19.562619833175948+-8.198089802484825*e)-16.262479672107002))-.6019598008014124),n=1+e*(e*(70.49610280856842+e*(e*(139.51056146574857+-49.18853881490881*e)-147.1791292232726))-14.740913729888538)),t/n)}(i))+a}return o?-c:c},a="function"==typeof Symbol&&"symbol"==i(Symbol("foo")),s=Object.prototype.toString,c=Object.prototype.hasOwnProperty,u="function"==typeof Symbol?Symbol.toStringTag:"",l={};e=a&&"symbol"==i(Symbol.toStringTag)?function(e){var t,n,r;if(null==e)return s.call(e);n=e[u],t=function(e,t){return null!=e&&c.call(e,t)}(e,u);try{e[u]=void 0}catch(t){return s.call(e)}return r=s.call(e),t?e[u]=n:delete e[u],r}:function(e){return s.call(e)},l=e;var h="function"==typeof Uint32Array,f="function"==typeof Uint32Array?Uint32Array:null,d="function"==typeof Uint32Array?Uint32Array:null,p={};p=function(){var e,t;if("function"!=typeof f)return!1;try{e=function(e){return h&&e instanceof Uint32Array||"[object Uint32Array]"===l(e)}(t=new f(t=[1,3.14,-3.14,4294967296,4294967297]))&&1===t[0]&&3===t[1]&&4294967293===t[2]&&0===t[3]&&1===t[4]}catch(t){e=!1}return e}()?d:function(){throw new Error("not implemented")};var v="function"==typeof Float64Array,y="function"==typeof Float64Array?Float64Array:null,m="function"==typeof Float64Array?Float64Array:null,g={};g=function(){var e,t;if("function"!=typeof y)return!1;try{e=function(e){return v&&e instanceof Float64Array||"[object Float64Array]"===l(e)}(t=new y([1,3.14,-3.14,NaN]))&&1===t[0]&&3.14===t[1]&&-3.14===t[2]&&t[3]!=t[3]}catch(t){e=!1}return e}()?m:function(){throw new Error("not implemented")};var w,b="function"==typeof Uint8Array,k="function"==typeof Uint8Array?Uint8Array:null,S="function"==typeof Uint8Array?Uint8Array:null;w=function(){var e,t;if("function"!=typeof k)return!1;try{e=function(e){return b&&e instanceof Uint8Array||"[object Uint8Array]"===l(e)}(t=new k(t=[1,3.14,-3.14,256,257]))&&1===t[0]&&3===t[1]&&253===t[2]&&0===t[3]&&1===t[4]}catch(t){e=!1}return e}()?S:function(){throw new Error("not implemented")};var x,C="function"==typeof Uint16Array,E="function"==typeof Uint16Array?Uint16Array:null,O="function"==typeof Uint16Array?Uint16Array:null,_={uint16:function(){var e,t;if("function"!=typeof E)return!1;try{e=function(e){return C&&e instanceof Uint16Array||"[object Uint16Array]"===l(e)}(t=new E(t=[1,3.14,-3.14,65536,65537]))&&1===t[0]&&3===t[1]&&65533===t[2]&&0===t[3]&&1===t[4]}catch(t){e=!1}return e}()?O:function(){throw new Error("not implemented")},uint8:w};(x=new _.uint16(1))[0]=4660;var A,M=52===new _.uint8(x.buffer)[0];A=!0===M?1:0;var T,I=new g(1),q=new p(I.buffer),j=function(e){return I[0]=e,q[A]};T=!0===M?1:0;var P,N,D,R=new g(1),L=new p(R.buffer),B=function(e,t){return R[0]=e,L[T]=t>>>0,R[0]},U=Number.POSITIVE_INFINITY,F=Number.NEGATIVE_INFINITY,H=.6931471803691238,$=1.9082149292705877e-10,V=function(e){var n,r,o,i,a,s,c,u,l,h;if(e<-1||t(e))return NaN;if(-1===e)return F;if(e===U)return e;if(0===e)return e;if(h=1,(o=e<0?-e:e)<.41421356237309503){if(o<1.862645149230957e-9)return o<5.551115123125783e-17?e:e-e*e*.5;e>-.2928932188134525&&(h=0,i=e,r=1)}return 0!==h&&(o<9007199254740992?(a=(h=((r=j(l=1+e))>>20)-1023)>0?1-(l-e):e-(l-1),a/=l):(h=((r=j(l=e))>>20)-1023,a=0),(r&=1048575)<434334?l=B(l,1072693248|r):(h+=1,l=B(l,1071644672|r),r=1048576-r>>2),i=l-1),n=.5*i*i,0===r?0===i?h*H+(a+=h*$):h*H-((u=n*(1-.6666666666666666*i))-(h*$+a)-i):(u=(c=(s=i/(2+i))*s)*(0===c?.6666666666666735:.6666666666666735+c*(.3999999999940942+c*(.2857142874366239+c*(.22222198432149784+c*(.1818357216161805+c*(.15313837699209373+.14798198605116586*c)))))),0===h?i-(n-s*(n+u)):h*H-(n-(s*(n+u)+(h*$+a))-i))},J=.6931471805599453,z=1.9082149292705877e-10,W=function(e){var n,r,o,i,a,s,c,u,l,h;return 0===e?F:t(e)||e<0?NaN:(i=0,(r=j(e))<1048576&&(i-=54,r=j(e*=0x40000000000000)),r>=2146435072?e+e:(i+=(r>>20)-1023|0,i+=(c=614244+(r&=1048575)&1048576|0)>>20|0,s=(e=B(e,r|1072693248^c))-1,(1048575&2+r)<3?0===s?0===i?0:.6931471803691238*i+i*z:(a=s*s*(.5-.3333333333333333*s),0===i?s-a:.6931471803691238*i-(a-i*z-s)):(c=r-398458|0,o=(l=(h=(u=s/(2+s))*u)*h)*(0===l?.3999999999940942:.3999999999940942+l*(.22222198432149784+.15313837699209373*l)),a=h*(0===l?.6666666666666735:.6666666666666735+l*(.2857142874366239+l*(.1818357216161805+.14798198605116586*l)))+o,(c|=440401-r|0)>0?(n=.5*s*s,0===i?s-(n-u*(n+a)):.6931471803691238*i-(n-(u*(n+a)+i*z)-s)):0===i?s-u*(s-a):.6931471803691238*i-(u*(s-a)-i*z-s))))},G=function(e){return e===U||e===F},K=1.5707963267948966,Q=function(e){var n,o,i,a;return t(e)||0===e?e:e===U?K:e===F?-K:(e<0&&(o=!0,e=-e),n=0,e>2.414213562373095?(i=K,n=1,e=-1/e):e<=.66?i=0:(i=r,n=2,e=(e-1)/(e+1)),a=e*(a=(a=e*e)*(0===a?-64.85021904942025:a*(a*(a*(-.8750608600031904*a-16.157537187333652)-75.00855792314705)-122.88666844901361)-64.85021904942025)/(0===a?194.5506571482614:194.5506571482614+a*(485.3903996359137+a*(432.88106049129027+a*(165.02700983169885+a*(24.858464901423062+1*a))))))+e,2===n?a+=3.061616997868383e-17:1===n&&(a+=6.123233995736766e-17),i+=a,o?-i:i)};!0===M?(N=1,D=0):(N=0,D=1),P={HIGH:N,LOW:D};var Y,X,Z,ee=new g(1),te=new p(ee.buffer),ne=P.HIGH,re=P.LOW,oe=function(e,t){return ee[0]=t,e[0]=te[ne],e[1]=te[re],e},ie=function(e,t){return 1===arguments.length?oe([0,0],e):oe(e,t)};!0===M?(X=1,Z=0):(X=0,Z=1),Y={HIGH:X,LOW:Z};var ae,se=new g(1),ce=new p(se.buffer),ue=Y.HIGH,le=Y.LOW,he=function(e,t){return ce[ue]=e,ce[le]=t,se[0]},fe=[0,0],de=function(e,t){var n,r;return ie(fe,e),n=fe[0],n&=2147483647,r=j(t),he(n|=r&=2147483648,fe[1])},pe=3.141592653589793,ve=function(e,t){var n,r,o,i;return o=(i=e*e)*i,r=i*(0===i?.0416666666666666:.0416666666666666+i*(2480158728947673e-20*i-.001388888888887411)),r+=o*o*(0===i?-2.7557314351390663e-7:i*(2.087572321298175e-9+-1.1359647557788195e-11*i)-2.7557314351390663e-7),(o=1-(n=.5*i))+(1-o-n+(i*r-e*t))},ye=-.16666666666666632,me=function(e,t){var n,r,o;return n=.00833333333332249+(o=e*e)*(27557313707070068e-22*o-.0001984126982985795)+o*(o*o)*(1.58969099521155e-10*o-2.5050760253406863e-8),r=o*e,0===t?e+r*(ye+o*n):e-(o*(.5*t-r*n)-t-r*ye)};ae=!0===M?0:1;var ge=new g(1),we=new p(ge.buffer),be=Math.floor,ke=function(e){return e<0?-e:0===e?0:e},Se=function(e,n){return t(n)||G(n)?(e[0]=n,e[1]=0,e):0!==n&&ke(n)<2.2250738585072014e-308?(e[0]=4503599627370496*n,e[1]=-52,e):(e[0]=n,e[1]=0,e)},xe=[0,0],Ce=[0,0],Ee=function(e,n){var r,o;return 0===e||t(e)||G(e)?e:(function(e,t){1===arguments.length?Se([0,0],e):Se(e,t)}(xe,e),n+=xe[1],(n+=function(e){var t=j(e);return(t=(2146435072&t)>>>20)-1023|0}(e=xe[0]))<-1074?de(0,e):n>1023?e<0?F:U:(n<=-1023?(n+=52,o=2.220446049250313e-16):o=1,ie(Ce,e),r=Ce[0],r&=2148532223,o*he(r|=n+1023<<20,Ce[1])))},Oe=[10680707,7228996,1387004,2578385,16069853,12639074,9804092,4427841,16666979,11263675,12935607,2387514,4345298,14681673,3074569,13734428,16653803,1880361,10960616,8533493,3062596,8710556,7349940,6258241,3772886,3769171,3798172,8675211,12450088,3874808,9961438,366607,15675153,9132554,7151469,3571407,2607881,12013382,4155038,6285869,7677882,13102053,15825725,473591,9065106,15363067,6271263,9264392,5636912,4652155,7056368,13614112,10155062,1944035,9527646,15080200,6658437,6231200,6832269,16767104,5075751,3212806,1398474,7579849,6349435,12618859],_e=[1.570796251296997,7.549789415861596e-8,5.390302529957765e-15,3.282003415807913e-22,1.270655753080676e-29,1.2293330898111133e-36,2.7337005381646456e-44,2.1674168387780482e-51],Ae=5.960464477539063e-8,Me=je(new Array(20)),Te=je(new Array(20)),Ie=je(new Array(20)),qe=je(new Array(20));function je(e){var t,n=e.length;for(t=0;t<n;t++)e[t]=0;return e}var Pe,Ne=Math.round,De=function(e,t,n){var r,o,i,a,s;return i=e-1.5707963267341256*(r=Ne(.6366197723675814*e)),a=6.077100506506192e-11*r,s=t>>20|0,n[0]=i-a,s-(j(n[0])>>20&2047)>16&&(a=2.0222662487959506e-21*r-((o=i)-(i=o-(a=6.077100506303966e-11*r))-a),n[0]=i-a,s-(j(n[0])>>20&2047)>49&&(a=8.4784276603689e-32*r-((o=i)-(i=o-(a=2.0222662487111665e-21*r))-a),n[0]=i-a)),n[1]=i-n[0]-a,r},Re=1.5707963267341256,Le=6.077100506506192e-11,Be=2*Le,Ue=4*Le,Fe=new Array(3),He=new Array(2),$e=function(e,t){var n,r,o,i,a,s,c;if((o=2147483647&j(e)|0)<=1072243195)return t[0]=e,t[1]=0,0;if(o<=1074752122)return 598523==(1048575&o)?De(e,o,t):o<=1073928572?e>0?(c=e-Re,t[0]=c-Le,t[1]=c-t[0]-Le,1):(c=e+Re,t[0]=c+Le,t[1]=c-t[0]+Le,-1):e>0?(c=e-2*Re,t[0]=c-Be,t[1]=c-t[0]-Be,2):(c=e+2*Re,t[0]=c+Be,t[1]=c-t[0]+Be,-2);if(o<=1075594811)return o<=1075183036?1074977148===o?De(e,o,t):e>0?(c=e-3*Re,t[0]=c-1.8231301519518578e-10,t[1]=c-t[0]-1.8231301519518578e-10,3):(c=e+3*Re,t[0]=c+1.8231301519518578e-10,t[1]=c-t[0]+1.8231301519518578e-10,-3):1075388923===o?De(e,o,t):e>0?(c=e-4*Re,t[0]=c-Ue,t[1]=c-t[0]-Ue,4):(c=e+4*Re,t[0]=c+Ue,t[1]=c-t[0]+Ue,-4);if(o<1094263291)return De(e,o,t);if(o>=2146435072)return t[0]=NaN,t[1]=NaN,0;for(n=function(e){return ge[0]=e,we[ae]}(e),c=he(o-((r=(o>>20)-1046)<<20|0),n),a=0;a<2;a++)Fe[a]=0|c,c=16777216*(c-Fe[a]);for(Fe[2]=c,i=3;0===Fe[i-1];)i-=1;return s=function(e,t,n,r){var o,i,a,s,c,u,l;for((i=(n-3)/24|0)<0&&(i=0),s=n-24*(i+1),u=i-(a=r-1),l=a+4,c=0;c<=l;c++)Me[c]=u<0?0:Oe[u],u+=1;for(c=0;c<=4;c++){for(o=0,u=0;u<=a;u++)o+=e[u]*Me[a+(c-u)];Te[c]=o}return function e(t,n,r,o,i,a,s,c,u){var l,h,f,d,p,v,y,m,g;for(d=a,g=o[r],m=r,p=0;m>0;p++)h=Ae*g|0,qe[p]=g-16777216*h|0,g=o[m-1]+h,m-=1;if(g=Ee(g,i),g-=8*be(.125*g),g-=y=0|g,f=0,i>0?(y+=p=qe[r-1]>>24-i,qe[r-1]-=p<<24-i,f=qe[r-1]>>23-i):0===i?f=qe[r-1]>>23:g>=.5&&(f=2),f>0){for(y+=1,l=0,p=0;p<r;p++)m=qe[p],0===l?0!==m&&(l=1,qe[p]=16777216-m):qe[p]=16777215-m;if(i>0)switch(i){case 1:qe[r-1]&=8388607;break;case 2:qe[r-1]&=4194303}2===f&&(g=1-g,0!==l&&(g-=Ee(1,i)))}if(0===g){for(m=0,p=r-1;p>=a;p--)m|=qe[p];if(0===m){for(v=1;0===qe[a-v];v++);for(p=r+1;p<=r+v;p++){for(u[c+p]=Oe[s+p],h=0,m=0;m<=c;m++)h+=t[m]*u[c+(p-m)];o[p]=h}return e(t,n,r+=v,o,i,a,s,c,u)}}if(0===g)for(r-=1,i-=24;0===qe[r];)r-=1,i-=24;else(g=Ee(g,-i))>=16777216?(h=Ae*g|0,qe[r]=g-16777216*h|0,i+=24,qe[r+=1]=h):qe[r]=0|g;for(h=Ee(1,i),p=r;p>=0;p--)o[p]=h*qe[p],h*=Ae;for(p=r;p>=0;p--){for(h=0,v=0;v<=d&&v<=r-p;v++)h+=_e[v]*o[p+v];Ie[r-p]=h}for(h=0,p=r;p>=0;p--)h+=Ie[p];for(n[0]=0===f?h:-h,h=Ie[0]-h,p=1;p<=r;p++)h+=Ie[p];return n[1]=0===f?h:-h,7&y}(e,t,4,Te,s,4,i,a,Me)}(Fe,He,r,i),e<0?(t[0]=-He[0],t[1]=-He[1],-s):(t[0]=He[0],t[1]=He[1],s)},Ve=[0,0],Je=Math.ceil,ze=function(e){var n;return t(e)||e===U?e:e===F?0:e>709.782712893384?U:e<-745.1332191019411?0:e>-1/(1<<28)&&e<1/(1<<28)?1+e:function(e,t,n){var r,o,i,a;return i=(r=e-t)-(o=r*r)*(0===(a=o)?.16666666666666602:.16666666666666602+a*(a*(6613756321437934e-20+a*(4.1381367970572385e-8*a-16533902205465252e-22))-.0027777777777015593)),Ee(1-(t-r*i/(2-i)-e),n)}(e-.6931471803691238*(n=function(e){return e<0?Je(e):be(e)}(e<0?1.4426950408889634*e-.5:1.4426950408889634*e+.5)),1.9082149292705877e-10*n,n)};Pe=!0===M?0:1;var We=new g(1),Ge=new p(We.buffer),Ke=function(e,t){return We[0]=e,Ge[Pe]=t>>>0,We[0]},Qe=[0,0],Ye=[0,0],Xe=function(e,t,n){var r,o,i,a,s,c,u,l,h;return(o=2147483647&(r=j(e))|0)>=1072010280&&(e<0&&(e=-e,t=-t),e=(h=.7853981633974483-e)+(l=3.061616997868383e-17-t),t=0),a=t+(h=e*e)*((s=h*e)*((a=function(e){return 0===e?.13333333333320124:.13333333333320124+e*(.021869488294859542+e*(.0035920791075913124+e*(.0005880412408202641+e*(7817944429395571e-20+-18558637485527546e-21*e))))}(l=h*h))+(u=h*(0===l?.05396825397622605:.05396825397622605+l*(.0088632398235993+l*(.0014562094543252903+l*(.0002464631348184699+l*(7140724913826082e-20+2590730518636337e-20*l)))))))+t),l=e+(a+=.3333333333333341*s),o>=1072010280?(1-(r>>30&2))*((u=n)-2*(e-(l*l/(l+u)-a))):1===n?l:(Ke(h=l,0),u=a-(h-e),Ke(c=i=-1/l,0),c+i*((s=1+c*h)+c*u))},Ze=[0,0];void 0===window.CroquetMath&&(window.CroquetMath={}),window.CroquetMath.acos=function(e){var i;return t(e)||e<-1||e>1?NaN:e>.5?2*o(n(.5-.5*e)):(i=r-o(e),i+=6.123233995736766e-17,i+=r)},window.CroquetMath.acosh=function(e){var r;return t(e)||e<1?NaN:1===e?0:e>=1<<28?W(e)+J:e>2?W(2*e-1/(e+n(e*e-1))):V((r=e-1)+n(2*r+r*r))},window.CroquetMath.asin=o,window.CroquetMath.asinh=function(e){var r,o,i;return t(e)||G(e)?e:(e<0&&(e=-e,r=!0),i=e<1/(1<<28)?e:e>1<<28?W(e)+J:e>2?W(2*e+1/(n(e*e+1)+e)):V(e+(o=e*e)/(1+n(1+o))),r?-i:i)},window.CroquetMath.atan=Q,window.CroquetMath.atanh=function(e){var n,r;return t(e)||e<-1||e>1?NaN:1===e?U:-1===e?F:(e<0&&(n=!0,e=-e),e<1/(1<<28)?n?-e:e:(r=e<.5?.5*V((r=e+e)+r*e/(1-e)):.5*V((e+e)/(1-e)),n?-r:r))},window.CroquetMath.atan2=function(e,n){var r;return t(n)||t(e)?NaN:G(n)?n===U?G(e)?de(pe/4,e):de(0,e):G(e)?de(3*pe/4,e):de(pe,e):G(e)?de(pe/2,e):0===e?n>=0&&!(j(n)>>>31)?de(0,e):de(pe,e):0===n?de(pe/2,e):(r=Q(e/n),n<0?r<=0?r+pe:r-pe:r)},window.CroquetMath.cbrt=function(e){var n,r,o,i,a;return t(e)||G(e)||0===e?e:(r=-2147483648&(o=j(e)),o&=2147483647,a=0,e<2.2250738585072014e-308?(a=0x40000000000000,n=j(a*=e),a=he(r|(n=(2147483647&n)/3+696219795),0)):a=B(a,r|(n=o/3+715094163)),a*=function(e){return 0===e?1.87595182427177:1.87595182427177+e*(e*(1.6214297201053545+e*(.14599619288661245*e-.758397934778766))-1.8849797954337717)}(i=a*a*(a/e)),n=j(a),a=he(n+1,0),a+=a*(i=((i=e/(a*a))-a)/(a+a+i)))},window.CroquetMath.cos=function(e){var t;if(t=j(e),(t&=2147483647)<=1072243195)return t<1044381696?1:ve(e,0);if(t>=2146435072)return NaN;switch(3&$e(e,Ve)){case 0:return ve(Ve[0],Ve[1]);case 1:return-me(Ve[0],Ve[1]);case 2:return-ve(Ve[0],Ve[1]);default:return me(Ve[0],Ve[1])}},window.CroquetMath.cosh=function(e){return t(e)?e:(e<0&&(e=-e),e>21?ze(e)/2:(ze(e)+ze(-e))/2)},window.CroquetMath.exp=ze,window.CroquetMath.expm1=function(e){var n,r,o,i,a,s,c,u,l,h,f,d;if(e===U||t(e))return e;if(e===F)return-1;if(0===e)return e;if(e<0?(r=!0,c=-e):(r=!1,c=e),c>=38.816242111356935){if(r)return-1;if(c>=709.782712893384)return U}if(a=0|j(c),c>.34657359027997264)c<1.0397207708399179?r?(o=e+.6931471803691238,i=-1.9082149292705877e-10,d=-1):(o=e-.6931471803691238,i=1.9082149292705877e-10,d=1):(d=r?1.4426950408889634*e-.5:1.4426950408889634*e+.5,o=e-.6931471803691238*(h=d|=0),i=1.9082149292705877e-10*h),l=o-(e=o-i)-i;else{if(a<1016070144)return e;d=0}return f=(u=e*(n=.5*e))*(((s=1+u*(0===u?-.03333333333333313:u*(.0015873015872548146+u*(u*(4008217827329362e-21+-2.0109921818362437e-7*u)-793650757867488e-19))-.03333333333333313))-(h=3-s*n))/(6-e*h)),0===d?e-(e*f-u):(f=e*(f-l)-l,f-=u,-1===d?.5*(e-f)-.5:1===d?e<-.25?-2*(f-(e+.5)):1+2*(e-f):d<=-2||d>56?(o=j(c=1-(f-e))+(d<<20)|0,(c=B(c,o))-1):(h=1,d<20?c=(h=B(h,o=1072693248-(2097152>>d)|0))-(f-e):(c=e-(f+(h=B(h,o=1023-d<<20|0))),c+=1),o=j(c)+(d<<20)|0,B(c,o)))},window.CroquetMath.log=W,window.CroquetMath.log1p=V,window.CroquetMath.log10=function(e){var n,r,o,i,a,s,c;return t(e)||e<0?NaN:0===e?F:(a=0,(r=j(e))<1048576&&(a-=54,r=j(e*=0x40000000000000)),r>=2146435072?e+e:(a+=(r>>20)-1023|0,e=B(e,(r&=1048575)|1072693248^(i=r+614244&1048576|0)),s=a+=i>>20|0,o=function(e){var t,n,r,o,i,a,s,c,u;return o=e-1,(1048575&2+(r=j(e)))<3?0===o?0:o*o*(.3333333333333333*o-.5):(u=(r&=1048575)-398458|0,n=(c=(a=(i=o/(2+o))*i)*a)*(0===c?.3999999999940942:.3999999999940942+c*(.22222198432149784+.15313837699209373*c)),s=a*(0===c?.6666666666666735:.6666666666666735+c*(.2857142874366239+c*(.1818357216161805+.14798198605116586*c)))+n,(u|=440401-r|0)>0?i*((t=.5*o*o)+s)-t:i*(s-o))}(e),n=Ke(e-=1,0),c=3.694239077158931e-13*s+2.5082946711645275e-11*(e+o),(c+=.4342944818781689*(e-n+o)+.4342944818781689*n)+.30102999566361177*s))},window.CroquetMath.log2=function(e){var n,r,o,i,a;if(t(e)||e<0)return NaN;if(ie(Qe,e),a=0,(r=Qe[0])<1048576){if(0==(2147483647&r|Qe[1]))return F;a-=54,r=j(e*=0x40000000000000)}return r>=2146435072?e+e:(a+=(r>>20)-1023|0,e=B(e,(r&=1048575)|1072693248^(i=r+614244&1048576|0)),a+=i>>20|0,o=function(e){var t,n,r,o,i,a,s,c,u;return o=e-1,(1048575&2+(r=j(e)))<3?0===o?0:o*o*(.3333333333333333*o-.5):(u=(r&=1048575)-398458|0,n=(c=(a=(i=o/(2+o))*i)*a)*(0===c?.3999999999940942:.3999999999940942+c*(.22222198432149784+.15313837699209373*c)),s=a*(0===c?.6666666666666735:.6666666666666735+c*(.2857142874366239+c*(.1818357216161805+.14798198605116586*c)))+n,(u|=440401-r|0)>0?i*((t=.5*o*o)+s)-t:i*(s-o))}(e),n=Ke(e-=1,0),1.6751713164886512e-10*(e+o)+1.4426950407214463*(e-n+o)+1.4426950407214463*n+a)},window.CroquetMath.sin=function(e){var t;if(t=j(e),(t&=2147483647)<=1072243195)return t<1045430272?e:me(e,0);if(t>=2146435072)return NaN;switch(3&$e(e,Ye)){case 0:return me(Ye[0],Ye[1]);case 1:return ve(Ye[0],Ye[1]);case 2:return-me(Ye[0],Ye[1]);default:return-ve(Ye[0],Ye[1])}},window.CroquetMath.sinh=function(e){var t;return 0===e?e:(t=ke(e),e>710.4758600739439||e<-709.089565712824?e>0?U:F:t>1?t>=709.0895657128241?(t=ze(.5*t),t*=.5*t,e<0&&(t=-t),t):(t=.5*(t=ze(t))-.5/t,e<0&&(t=-t),t):e+e*(t*=t)*function(e){var t,n;return 0===e?.16666666666666666:((e<0?-e:e)<=1?(t=e*(e*(-.789474443963537*e-163.72585752598383)-11561.443576500522)-351754.9648081514,n=e*(36157.827983443196+e*(1*e-277.7110814206028))-2110529.7888489086):(t=(e=1/e)*(e*(-351754.9648081514*e-11561.443576500522)-163.72585752598383)-.789474443963537,n=1+e*(e*(36157.827983443196+-2110529.7888489086*e)-277.7110814206028)),t/n)}(t))},window.CroquetMath.tan=function(e){var t,n;return t=j(e),(t&=2147483647)<=1072243195?t<1044381696?e:Xe(e,0,1):t>=2146435072?NaN:(n=$e(e,Ze),Xe(Ze[0],Ze[1],1-((1&n)<<1)))},window.CroquetMath.tanh=function(e){var t,n;if((n=ke(e))>44.014845965556525)return e<0?-1:1;if(n>=.625)n=1-2/((t=ze(2*n))+1),e<0&&(n=-n);else{if(0===e)return e;n=e+e*(t=e*e)*function(e){var t,n;return 0===e?-.3333333333333332:((e<0?-e:e)<=1?(t=e*(e*(0*e-.9643991794250523)-99.28772310019185)-1614.6876844170845,n=4844.063053251255+e*(2235.4883906010045+e*(112.81167849163293+1*e))):(t=0+(e=1/e)*(e*(-1614.6876844170845*e-99.28772310019185)-.9643991794250523),n=1+e*(112.81167849163293+e*(2235.4883906010045+4844.063053251255*e))),t/n)}(t)}return n};var et=Math.pow;function tt(e){return e===1/0||e===-1/0}window.CroquetMath.pow=function(e,t){if(isNaN(e)||isNaN(t))return NaN;if(tt(e)||tt(t))return et(e,t);if(0===e||0===t)return et(e,t);if(e<0&&!function(e){return Number.isInteger(e)}(t))return NaN;if(1===t)return e;if(2===t)return e*e;if(3===t)return e*e*e;if(4===t)return e*e*e*e;var n=1;return e<0&&(e*=-1,n=et(-1,t)),window.CroquetMath.exp(window.CroquetMath.log(e)*t)*n}}();var mt=null,gt={};function wt(e,t){var n=JSON.parse(atob(e.slice(1,-1))),r=n.qPara,i=n.qArgs,a=n.qFn,s=JSON.stringify(r),c=gt[s]||(gt[s]=g(Function,o(r)));return"number"==typeof a&&(i[a]=c),c.call.apply(c,[t].concat(o(i))).bind(t)}function bt(e,t){if(mt)throw Error("Island confusion");if(!(e instanceof kt))throw Error("not an island: "+e);var n=mt;try{mt=e,window.ISLAND=e,t()}finally{mt=n}}var kt=function(){function e(t,r){var o=this;n(this,e),e.installCustomMath(),bt(this,function(){ft(o,function(){if(o.modelsById={},o.modelsByName={},o.messages=new nt(function(e,t){return e.before(t)}),o.subscriptions={},o.users={},o._random=function(){throw Error("You must not use random when applying state!")},o.id=t.id,o.time=0,o.seq=4294967280,o.externalTime=0,o.externalSeq=o.seq,o.futureSeq=0,o.tuttiSeq=0,o.lastSnapshotPoll=0,o.modelsId=0,t.modelsById){for(var e=It.newOrRecycled(o).readIsland(t,"$"),n=[],i=0,a=Object.keys(e);i<a.length;i++){var s=a[i];s in o||"meta"===s?"messages"===s?n=e.messages:o[s]=e[s]:console.warn("Ignoring property snapshot.".concat(s))}var c,u=vt(n);try{for(u.s();!(c=u.n()).done;){var l=c.value;o.messages.add(l.convertIfNeeded(o))}}catch(e){u.e(e)}finally{u.f()}}else{o._random=new h(null,{state:!0});var f=r(o)||{};Object.assign(o.modelsByName,f),o.addSubscription(o,o.id,"__users__",o.generateJoinExit)}})})}return r(e,null,[{key:"current",value:function(){return mt||console.warn("No CurrentIsland!"),mt}},{key:"hasCurrent",value:function(){return!!mt}},{key:"installCustomMath",value:function(){if(!window.BrowserMath){window.CroquetMath.random=function(){return mt.random()},window.BrowserMath={};for(var e=function(){var e=t(r[n],2),o=e[0],i=e[1],a=window.Math[o];window.BrowserMath[o]=a,window.Math[o]=["pow","atan2"].includes(o)?function(e,t){return mt?i(e,t):a(e,t)}:function(e){return mt?i(e):a(e)}},n=0,r=Object.entries(window.CroquetMath);n<r.length;n++)e()}}}]),r(e,[{key:"registerModel",value:function(e,t){if(mt!==this)throw Error("Island Error");return t||(t=this.id+"/M"+ ++this.modelsId),this.modelsById[t]=e,t}},{key:"deregisterModel",value:function(e){if(mt!==this)throw Error("Island Error");var n=this.modelsById;delete this.modelsById[e];for(var r=0,o=Object.entries(this.modelsByName);r<o.length;r++){var i=t(o[r],2),a=i[0];n===i[1]&&delete this.modelsByName[a]}this.messages.removeMany(function(t){return t.hasReceiver(e)})}},{key:"lookUpModel",value:function(e){if(e===this.id)return this;var n=this.modelsById[e];if(n)return n;var r=e.match(/^([^#]+)#(.*)$/),o=t(r,3),i=(o[0],o[1]),a=o[2];return this.modelsById[i].lookUp(a)}},{key:"get",value:function(e){return this.modelsByName[e]}},{key:"set",value:function(e,t){if(mt!==this)throw Error("Island Error");this.modelsByName[e]=t}},{key:"getNextTuttiSeq",value:function(){return this.tuttiSeq=this.tuttiSeq+1>>>0,this.tuttiSeq}},{key:"callModelMethod",value:function(e,t,n){if(mt)throw Error("Island Error");var r=this.lookUpModel(e);if(r){var o=new _t(this.time,0,r.id,t,n);this.controller.sendMessage(o)}else console.error(Error("Model not found: ".concat(e)))}},{key:"noop",value:function(){}},{key:"generateJoinExit",value:function(e){var n,r=e.entered,o=e.exited,i=e.count,a=vt(o=r.length===i?Object.keys(this.users):o.map(function(e){return e[0]}));try{for(a.s();!(n=a.n()).done;){var s=n.value;this.users[s]&&(delete this.users[s],this.publishFromModel(this.id,"view-exit",s))}}catch(e){a.e(e)}finally{a.f()}var c,u=vt(r);try{for(u.s();!(c=u.n()).done;){var l=t(c.value,3),h=l[0],f=l[1],d=l[2];this.users[h]||(this.users[h]={name:f},d&&(this.users[h].location=d),this.publishFromModel(this.id,"view-join",h))}}catch(e){u.e(e)}finally{u.f()}}},{key:"scheduleExternalMessage",value:function(e){var t=_t.fromState(e,this);if(t.time<this.time)throw Error("past message from reflector "+e);var n=this.externalSeq+1>>>0;if(t.seq!==n)throw Error("External message error. Expected message #".concat(n," got #").concat(t.seq));return this.externalTime=t.time,this.externalSeq=t.seq,t.seq=2*t.seq+1,this.messages.add(t),t}},{key:"futureSend",value:function(e,t,n,r){if(e.every)return this.futureRepeat(e.every,t,n,r);if(e<0)throw Error("attempt to send future message into the past");this.futureSeq=this.futureSeq+1>>>0;var o=new _t(this.time+e,2*this.futureSeq,t,n,r);return this.messages.add(o),o}},{key:"futureRepeat",value:function(e,t,n,r){this.futureSend(e,this.id,"futureExecAndRepeat",[e,t,n,r])}},{key:"futureExecAndRepeat",value:function(e,t,n,r){var i=this.lookUpModel(t);if("function"==typeof i[n])try{i[n].apply(i,o(r))}catch(e){He("future message ".concat(i,".").concat(n),e)}else{var a=wt(n,i);try{a.apply(void 0,o(r))}catch(e){He("future message ".concat(i," ").concat(a),e)}}this.futureRepeat(e,t,n,r)}},{key:"future",value:function(e,t,n,r){var o=this.asQFunc(e,n);if("string"==typeof o)return this.futureSend(t,e.id,o,r);var i=this;return new Proxy(e,{get:function(n,r){if("function"==typeof e[r])return function(){if(i.lookUpModel(e.id)!==e)throw Error("future send to unregistered model");for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return i.futureSend(t,e.id,r,o)};throw Error("Tried to call "+r+"() on future of "+Object.getPrototypeOf(e).constructor.name+" which is not a function")}})}},{key:"advanceTo",value:function(e,t){if(mt)throw Error("Island Error");for(var n,r=0;(n=this.messages.peek())&&n.time<=e;){var o=n,i=o.time,a=o.seq;if(i<this.time)throw Error("past message encountered: "+n);if(1&a&&(this.seq=this.seq+1>>>0,a/2>>>0!==this.seq))throw Error("Sequence error: expected ".concat(this.seq," got ").concat(a/2>>>0," in ").concat(n));if(this.messages.poll(),this.time=n.time,n.executeOn(this),++r>100&&(r=0,Date.now()>t))return!1}return this.time=e,!0}},{key:"asQFunc",value:function(e,n){if("string"==typeof n)return n;if("function"==typeof n){if(e[n.name]===n)return n.name;for(var r=e;null!==r;){for(var o=0,i=Object.entries(Object.getOwnPropertyDescriptors(r));o<i.length;o++){var a=t(i[o],2),s=a[0];if(a[1].value===n)return s}r=Object.getPrototypeOf(r)}var c=n.toString().match(/^\(?([a-z][a-z0-9]*)?\)? *=> *this\.([a-z][a-z0-9]*) *\( *([a-z][a-z0-9]*)? *\) *$/i);return!c||c[3]&&c[3]!==c[1]?function(e,t){"function"==typeof e&&(t=e,e={});var n=Object.keys(e).concat(["return "+t]),r=Object.values(e),o={qPara:n,qArgs:r},i=r.indexOf(t);return i>=0&&(r[i]=n[i],o.qFn=i),"{".concat(btoa(JSON.stringify(o)),"}")}(n):c[2]}return null}},{key:"addSubscription",value:function(e,t,n,r){if(mt!==this)throw Error("Island Error");var o=this.asQFunc(e,r);if("string"!=typeof o)throw Error('Subscription handler for "'.concat(n,'" must be a method name'));if("function"!=typeof e[o]&&"{"!==o[0])throw Error('Subscriber method for "'.concat(n,'" not found: ').concat(e,".").concat(o,"()"));var i=t+":"+n,a=e.id+"."+o;if(this.subscriptions[i]){if(-1!==this.subscriptions[i].indexOf(a))throw Error("".concat(e,".").concat(o," already subscribed to ").concat(n))}else this.subscriptions[i]=[];this.subscriptions[i].push(a)}},{key:"removeSubscription",value:function(e,t,n,r){if(mt!==this)throw Error("Island Error");var o=t+":"+n,i=e.id+"."+r,a=this.subscriptions[o];if(a){var s=a.indexOf(i);a.splice(s,1),0===a.length&&delete this.subscriptions[o]}}},{key:"removeAllSubscriptionsFor",value:function(e){for(var n="".concat(e.id,":"),r="".concat(e.id,"."),o=0,i=Object.entries(this.subscriptions);o<i.length;o++){var a=t(i[o],2),s=a[0],c=a[1];if(s.startsWith(n))delete this.subscriptions[s];else{for(var u=c.length-1;u>=0;u--)c[u].startsWith(r)&&c.splice(u,1);0===c.size&&delete this.subscriptions[s]}}}},{key:"publishFromModel",value:function(e,t,n){if(mt!==this)throw Error("Island Error");var r=t.endsWith("#reflected");r&&(t=t.slice(0,t.length-"#reflected".length));var o=e+":"+t;this.handleModelEventInModel(o,n,r),this.handleModelEventInView(o,n)}},{key:"publishFromView",value:function(e,t,n){if(mt)throw Error("Island Error");var r=e+":"+t;this.handleViewEventInModel(r,n),this.handleViewEventInView(r,n)}},{key:"handleModelEventInModel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(mt!==this)throw Error("Island Error");if(n){var r=this.getNextTuttiSeq();if(!0!==this.controller.synced)return;var o=e+"#__vote",i=e+"#divergence",a=!!at.subscriptions[o],s=!!this.subscriptions[e],c=!!this.subscriptions[i];a&&c&&console.log("divergence subscription for ".concat(e," overridden by vote subscription"));var u,l=s?new _t(this.time,0,this.id,"handleModelEventInModel",[e,t]):null;u=a?[this.id,"handleModelEventInView",o]:[this.id,"handleTuttiDivergence",i],this.controller.sendTutti(this.time,r,t,l,a,u)}else if(this.subscriptions[e]){var h,f=vt(this.subscriptions[e]);try{for(f.s();!(h=f.n()).done;){var d=h.value.split("."),p=m(d),v=p[0],y=p.slice(1).join("."),g=this.lookUpModel(v);if(g){if("{"===y[0]){var w=wt(y,g);try{w(t)}catch(t){He("event ".concat(e," ").concat(g," ").concat(w),t)}continue}"function"!=typeof g[y]&&Ue("event ".concat(e," ").concat(g,".").concat(y,"(): method not found"))}else Ue("event ".concat(e," .").concat(y,"(): subscriber not found"));try{g[y](t)}catch(t){He("event ".concat(e," ").concat(g,".").concat(y,"()"),t)}}}catch(e){f.e(e)}finally{f.f()}}}},{key:"handleViewEventInModel",value:function(e,t){if(this.subscriptions[e]){var n=new _t(this.time,0,this.id,"handleModelEventInModel",[e,t]);this.controller.sendMessage(n)}}},{key:"handleModelEventInView",value:function(e,t){var n=this;at.handleEvent(e,t,function(e){return function(e){if(!mt)throw Error("Island confusion");var t=mt;try{mt=null,e()}finally{mt=t}}(function(){return dt(n,e,!0)})})}},{key:"handleViewEventInView",value:function(e,t){at.handleEvent(e,t)}},{key:"handleTuttiDivergence",value:function(e,t){if(this.subscriptions[e])this.handleModelEventInModel(e,t);else{var n=e.split(":").slice(-1)[0];console.warn("uncaptured divergence in ".concat(n,":"),t)}}},{key:"processModelViewEvents",value:function(){var e=this;if(mt)throw Error("Island Error");return dt(this,function(){return at.processFrameEvents(!!e.controller.synced)})}},{key:"pollToCheckSync",value:function(){var e=this.getNextTuttiSeq();if(!0===this.controller.synced){var t=Date.now(),n={date_island:this.time,hash:this.getSummaryHash()},r=Date.now()-t;this.controller.cpuTime-=r;var o=[this.id,"handleSyncCheckVote","syncCheckVote"];this.controller.sendTutti(this.time,e,n,null,!0,o)}}},{key:"handleSyncCheckVote",value:function(e,t){this.controller.handleSyncCheckVote(t)}},{key:"pollForSnapshot",value:function(){var e=this,t=this.getNextTuttiSeq(),n=this.time,r=n-this.lastSnapshotPoll;if(r<5e3)console.log("rejecting snapshot poll ".concat(r,"ms after previous"));else{this.lastSnapshotPoll=n;var o=this.controller.preparePollForSnapshot();if(o){var i=Date.now();o.hash=this.getSummaryHash();var a=Date.now()-i;this.controller.cpuTime-=a,Promise.resolve().then(function(){return e.controller.pollForSnapshot(n,t,o)})}}}},{key:"handleSnapshotVote",value:function(e,t){this.controller.handleSnapshotVote(t)}},{key:"snapshot",value:function(){return Tt.newOrRecycled(this).snapshot(this,"$")}},{key:"getSummaryHash",value:function(){return(new Mt).getHash(this)}},{key:"random",value:function(){if(mt!==this)throw Error("Island Error");return this._random()}},{key:"randomID",value:function(){if(mt!==this)throw Error("Island Error");for(var e="",t=0;t<4;t++)e+=(this._random.int32()>>>0).toString(16).padStart(8,"0");return e}}]),e}();function St(e,t,n){return n.length>0&&(n=qt.newOrRecycled().encode(n)),"".concat(e,">").concat(t).concat(n.length>0?JSON.stringify(n):"")}function xt(e,n){var r=e.match(/^([^[]+)(\[.*)?$/i),o=t(r,3),i=(o[0],o[1]),a=o[2],s=i.split(">"),c=t(s,2),u=c[0],l=c[1],h=[];return a&&(h=jt.newOrRecycled(n).decode(JSON.parse(a))),{receiver:u,selector:l,args:h}}function Ct(e,t){return(t-e|0)>=0}var Et,Ot,_t=function(){function e(t,r,o,i,a){n(this,e),this.time=t,this.seq=r,this.receiver=o,this.selector=i,this.args=a}return r(e,[{key:"convertIfNeeded",value:function(e){if(this.payload){var t=xt(this.payload,e),n=t.receiver,r=t.selector,o=t.args;delete this.payload,this.receiver=n,this.selector=r,this.args=o}return this}},{key:"before",value:function(e){return this.time!==e.time?this.time<e.time:this.isExternal()!==e.isExternal()?e.isExternal():this.isExternal()?Ct(this.externalSeq,e.externalSeq):Ct(this.internalSeq,e.internalSeq)}},{key:"hasReceiver",value:function(e){return this.receiver===e}},{key:"isExternal",value:function(){return 1&this.seq}},{key:"asState",value:function(){return[this.time,this.seq,St(this.receiver,this.selector,this.args)]}},{key:"executeOn",value:function(e){var t=this,n=this.receiver,r=this.selector,i=this.args,a=e.lookUpModel(n);if(a)if("{"===r[0]){var s=wt(r,a);bt(e,function(){ft(e,function(){try{s.apply(void 0,o(i))}catch(e){He("".concat(t.shortString()," ").concat(s),e)}})})}else"function"!=typeof a[r]?Ue("".concat(this.shortString()," ").concat(a,".").concat(r,"(): method not found")):bt(e,function(){ft(e,function(){try{a[r].apply(a,o(i))}catch(e){He("".concat(t.shortString()," ").concat(a,".").concat(r,"()"),e)}})});else Ue("".concat(this.shortString()," ").concat(r,"(): receiver not found"))}},{key:"shortString",value:function(){return"".concat(this.isExternal()?"External":"Future","Message")}},{key:"toString",value:function(){var e=this.receiver,t=this.selector,n=this.args,r=this.isExternal(),o=r?this.externalSeq:this.internalSeq;return"".concat(r?"External":"Future","Message[").concat(this.time).concat(":#"[+r]).concat(o," ").concat(e,".").concat(t,"(").concat(n.map(JSON.stringify).join(", "),")]")}},{key:Symbol.toPrimitive,value:function(){return this.toString()}},{key:"externalSeq",get:function(){return this.seq/2>>>0},set:function(e){this.seq=2*e+1}},{key:"internalSeq",get:function(){return this.seq/2>>>0},set:function(e){this.seq=2*e}}],[{key:"fromState",value:function(n,r){var o=t(n,3),i=o[0],a=o[1],s=xt(o[2],r);return new e(i,a,s.receiver,s.selector,s.args)}}]),e}(),At=(Et=new ArrayBuffer(8),Ot=new DataView(Et),function(e){return Ot.setFloat64(0,e,!0),Ot.getInt32(0,!0)+Ot.getInt32(4,!0)}),Mt=function(){function e(){n(this,e),this.refs=new Map,this.todo=[],this.hashers=new Map,this.addHasher("Teatime:Message",_t);var r,o=vt(Ut.allClassTypes());try{for(o.s();!(r=o.n()).done;){var i=t(r.value,2),a=i[0],s=i[1];this.addHasher(a,s)}}catch(e){o.e(e)}finally{o.f()}}return r(e,[{key:"addHasher",value:function(e,t){var n=this,r=Object.getPrototypeOf(t)===Object.prototype?t:{cls:t,write:function(e){return Object.assign({},e)}},o=r.cls,i=r.write;this.hashers.set(o,function(e){return n.hashStructure(e,i(e))})}},{key:"getHash",value:function(e){this.hashState={oC:0,mC:0,nanC:0,infC:0,zC:0,nC:0,nH:0,sC:0,sL:0,fC:0};for(var n=0,r=Object.entries(e);n<r.length;n++){var o=t(r[n],2),i=o[0],a=o[1];if("controller"!==i&&"meta"!==i)if("_random"===i)this.hash(a.state(),!1);else if("messages"===i){var s=a.asArray();(this.hashState.fC=s.length)&&this.hash(s,!1)}else this.hashEntry(i,a)}return this.hashDeferred(),this.hashState}},{key:"hashDeferred",value:function(){for(;this.todo.length>0;){var e=this.todo.shift(),t=e.key,n=e.value;this.hashEntry(t,n,!1)}}},{key:"hash",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];switch(i(e)){case"number":return void(Number.isNaN(e)?this.hashState.nanC++:Number.isFinite(e)?0===e?this.hashState.zC++:(this.hashState.nC++,this.hashState.nH+=At(e)):this.hashState.infC++);case"string":return this.hashState.sC++,void(this.hashState.sL+=e.length);case"boolean":case"undefined":return;default:var n=Object.prototype.toString.call(e).slice(8,-1);switch(n){case"Array":return void this.hashArray(e,t);case"Set":case"Map":case"Uint8Array":case"Uint16Array":case"Float32Array":return void this.hashStructure(e,o(e));case"Object":if(e instanceof Ut)this.hashModel(e);else if(e.constructor===Object)this.hashObject(e,t);else{var r=this.hashers.get(e.constructor);if(!r)throw Error("Don't know how to hash ".concat(e.constructor.name));r(e)}return;case"Null":return;default:throw Error("Don't know how to hash ".concat(n))}}}},{key:"hashModel",value:function(e){if(!this.refs.has(e)){this.hashState.mC++,this.refs.set(e,!0);for(var n=0,r=Object.entries(e);n<r.length;n++){var o=t(r[n],2),i=o[0],a=o[1];"__realm"!==i&&void 0!==a&&this.hashEntry(i,a)}}}},{key:"hashObject",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.refs.has(e)){this.hashState.oC++,this.refs.set(e,!0);for(var r=0,o=Object.entries(e);r<o.length;r++){var i=t(o[r],2),a=i[0],s=i[1];void 0!==s&&this.hashEntry(a,s,n)}}}},{key:"hashArray",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.refs.has(e)){this.refs.set(e,!0);for(var n=0;n<e.length;n++)this.hashEntry(n,e[n],t)}}},{key:"hashStructure",value:function(e,t){void 0!==t&&(this.refs.has(e)||(this.refs.set(e,!0),this.hash(t,!1)))}},{key:"hashEntry",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];"$"!==e[0]?n&&"object"===i(t)?this.todo.push({key:e,value:t}):this.hash(t):Ue("snapshot: ignoring property ".concat(e),{only:"once"})}}]),e}(),Tt=function(){function e(r){n(this,e),this.island=r,this.nextRef=1,this.refs=new Map,this.todo=[],this.writers=new Map,this.addWriter("Teatime:Message",_t);var o,i=vt(Ut.allClassTypes());try{for(i.s();!(o=i.n()).done;){var a=t(o.value,2),s=a[0],c=a[1];this.addWriter(s,c)}}catch(e){i.e(e)}finally{i.f()}}return r(e,null,[{key:"newOrRecycled",value:function(e){var t=this.reusableInstance;return t?(t.island=e,t.nextRef=1,t.refs=new Map,t.todo=[]):t=this.reusableInstance=new this(e),t}},{key:"resetInstance",value:function(){this.reusableInstance=null}},{key:"reusableInstance",get:function(){return this[this.name+"-instance"]},set:function(e){this[this.name+"-instance"]=e}}]),r(e,[{key:"addWriter",value:function(e,t){var n=this,r=Object.getPrototypeOf(t)===Object.prototype?t:{cls:t,write:function(e){return Object.assign({},e)}},o=r.cls,i=r.write;this.writers.set(o,function(t,r){return n.writeAs(e,t,i(t),r)})}},{key:"snapshot",value:function(e){for(var n={_random:e._random.state(),messages:this.write(e.messages.asArray())},r=0,o=Object.entries(e);r<o.length;r++){var i=t(o[r],2),a=i[0],s=i[1];"controller"!==a&&(n[a]||this.writeInto(n,a,s,"$"))}return this.writeDeferred(),n}},{key:"writeDeferred",value:function(){for(;this.todo.length>0;){var e=this.todo.shift(),t=e.state,n=e.key,r=e.value,o=e.path;this.writeInto(t,n,r,o,!1)}}},{key:"write",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];switch(i(e)){case"number":return Number.isSafeInteger(e)?e:Number.isNaN(e)?{$class:"NaN"}:Number.isFinite(e)?this.writeFloat(e):{$class:"Infinity",$value:Math.sign(e)};case"string":case"boolean":case"undefined":return e;default:var r=Object.prototype.toString.call(e).slice(8,-1);switch(r){case"Array":return this.writeArray(e,t,n);case"Set":case"Map":case"Uint8Array":case"Uint16Array":case"Float32Array":return this.writeAs(r,e,o(e),t);case"Object":if(e instanceof Ut)return this.writeModel(e,t);if(e.constructor===Object)return this.writeObject(e,t,n);var a=this.writers.get(e.constructor);if(a)return a(e,t);throw Error("Don't know how to write ".concat(e.constructor.name," at ").concat(t));case"Null":return e;default:throw Error("Don't know how to write ".concat(r," at ").concat(t))}}}},{key:"writeModel",value:function(e,t){if(this.refs.has(e))return this.writeRef(e);var n={$model:Ut.classToID(e.constructor)};this.refs.set(e,n);var r,o=vt(Object.keys(e).sort());try{for(o.s();!(r=o.n()).done;){var i=r.value;if("__realm"!==i){var a=e[i];void 0!==a&&this.writeInto(n,i,a,t)}}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"writeObject",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.refs.has(e))return this.writeRef(e);var r={};this.refs.set(e,r);var o,i=vt(Object.keys(e).sort());try{for(i.s();!(o=i.n()).done;){var a=o.value,s=e[a];void 0!==s&&this.writeInto(r,a,s,t,n)}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"writeArray",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.refs.has(e))return this.writeRef(e);var r=[];this.refs.set(e,r);for(var o=0;o<e.length;o++)this.writeInto(r,o,e[o],t,n);return r}},{key:"writeFloat",value:function(e){return e}},{key:"writeAs",value:function(e,t,n,r){if(void 0===n)return n;if(this.refs.has(t))return this.writeRef(t);var o={$class:e};this.refs.set(t,o);var a=this.write(n,r,!1);return"object"!==i(a)||Array.isArray(a)?o.$value=a:Object.assign(o,a),o}},{key:"writeRef",value:function(e){var t=this.refs.get(e);if("object"!==i(t))throw Error("Non-object in refs: "+e);return Array.isArray(t)&&(t.toJSON=function(){return{$id:this.$id,$class:"Array",$value:o(this)}}),{$ref:t.$id||(t.$id=this.nextRef++)}}},{key:"writeInto",value:function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if("$"!==t[0])if(o&&"object"===i(n))this.todo.push({state:e,key:t,value:n,path:r});else{var a=r+("string"==typeof t&&t.match(/^[_a-z][_a-z0-9]*$/i)?".".concat(t):"[".concat(JSON.stringify(t),"]")),s=this.write(n,a);void 0!==s&&(e[t]=s)}else Ue("snapshot: ignoring property ".concat(t),{only:"once"})}}]),e}(),It=function(){function e(r){n(this,e),this.island=r,this.refs=new Map,this.todo=[],this.unresolved=[],this.readers=new Map,this.addReader("Teatime:Message",_t);var o,i=vt(Ut.allClassTypes());try{for(i.s();!(o=i.n()).done;){var a=t(o.value,2),s=a[0],c=a[1];this.addReader(s,c)}}catch(e){i.e(e)}finally{i.f()}this.readers.set("NaN",function(){return NaN}),this.readers.set("Infinity",function(e){return e*(1/0)}),this.readers.set("Set",function(e){return new Set(e)}),this.readers.set("Map",function(e){return new Map(e)}),this.readers.set("Array",function(e){return e.slice(0)}),this.readers.set("Uint8Array",function(e){return new Uint8Array(e)}),this.readers.set("Uint16Array",function(e){return new Uint16Array(e)}),this.readers.set("Float32Array",function(e){return new Float32Array(e)})}return r(e,null,[{key:"newOrRecycled",value:function(e){var t=this.reusableInstance;return t?(t.island=e,t.refs=new Map,t.todo=[],t.unresolved=[]):t=this.reusableInstance=new this(e),t}},{key:"resetInstance",value:function(){this.reusableInstance=null}},{key:"reusableInstance",get:function(){return this[this.name+"-instance"]},set:function(e){this[this.name+"-instance"]=e}}]),r(e,[{key:"addReader",value:function(e,t){var n="object"===i(t)?t.read:function(e){return Object.assign(Object.create(t.prototype),e)};this.readers.set(e,n)}},{key:"readIsland",value:function(e,n){if("$"!==n)throw Error("Island must be root object");for(var r={_random:new h(null,{state:e._random})},o=0,i=Object.entries(e);o<i.length;o++){var a=t(i[o],2),s=a[0],c=a[1];r[s]||this.readInto(r,s,c,n)}return this.readDeferred(),this.resolveRefs(),r}},{key:"readDeferred",value:function(){for(;this.todo.length>0;){var e=this.todo.shift(),t=e.object,n=e.key,r=e.value,o=e.path;this.readInto(t,n,r,o,1)}}},{key:"resolveRefs",value:function(){var e,t=vt(this.unresolved);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=n.object,o=n.key,i=n.ref,a=n.path;if(!this.refs.has(i))throw Error("Unresolved ref: ".concat(i," at ").concat(a,"[").concat(JSON.stringify(o),"]"));r[o]=this.refs.get(i)}}catch(e){t.e(e)}finally{t.f()}}},{key:"read",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(i(e)){case"number":case"string":case"boolean":return e;default:var r=Object.prototype.toString.call(e).slice(8,-1);switch(r){case"Array":return this.readArray(e,t,n);case"Null":return null;case"Object":var o=e.$class,a=e.$model;if(e.$ref)throw Error("refs should have been handled in readInto()");return a?this.readModel(e,t):o?this.readAs(o,e,t):this.readObject(Object,e,t,n);default:throw Error("Don't know how to read ".concat(r," at ").concat(t))}}}},{key:"readModel",value:function(e,n){var r=Ut.instantiateClassID(e.$model,e.id);e.$id&&this.refs.set(e.$id,r);for(var o=0,i=Object.entries(e);o<i.length;o++){var a=t(i[o],2),s=a[0],c=a[1];"id"!==s&&"$"!==s[0]&&this.readInto(r,s,c,n)}return r}},{key:"readObject",value:function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=new e;n.$id&&this.refs.set(n.$id,i);for(var a=0,s=Object.entries(n);a<s.length;a++){var c=t(s[a],2),u=c[0],l=c[1];"$"!==u[0]&&this.readInto(i,u,l,r,o)}return i}},{key:"readArray",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];e.$id&&this.refs.set(e.$id,r);for(var o=0;o<e.length;o++)void 0!==e[o]&&this.readInto(r,o,e[o],t,n);return r}},{key:"readAs",value:function(e,n,r){var o={},i=new Map;if("$value"in n)o=this.read(n.$value,r,2);else for(var a=0,s=Object.entries(n);a<s.length;a++){var c=t(s[a],2),u=c[0],l=c[1];if("$"!==u[0]){var h=l&&l.$ref;h?this.refs.has(h)?o[u]=this.refs.get(h):(o[u]="<unresolved>",i.set(h,u)):this.readInto(o,u,l,r,1)}}var f=this.readers.get(e)(o,r);f||"NaN"===e||console.warn('Reading "'.concat(e,'" returned ').concat(f," at ").concat(r)),n.$id&&this.refs.set(n.$id,f);var d,p=vt(i.entries());try{for(p.s();!(d=p.n()).done;){var v=t(d.value,2),y=v[0],m=v[1];this.unresolved.push({object:f,key:m,ref:y,path:r})}}catch(e){p.e(e)}finally{p.f()}return f}},{key:"readRef",value:function(e,t,n,r){if(!n||!n.$ref)return!1;var o=n.$ref;return this.refs.has(o)?e[t]=this.refs.get(o):(e[t]="<unresolved>",this.unresolved.push({object:e,key:t,ref:o,path:r})),!0}},{key:"readInto",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!this.readRef(e,t,n,r))if(0!==o||"object"!==i(n)){var a=r+("string"==typeof t&&t.match(/^[_a-z][_a-z0-9]*$/i)?".".concat(t):"[".concat(JSON.stringify(t),"]"));e[t]=this.read(n,a,o>0?o-1:0)}else this.todo.push({object:e,key:t,value:n,path:r})}}]),e}(),qt=function(e){d(o,Tt);var t=pt(o);function o(){return n(this,o),t.apply(this,arguments)}return r(o,[{key:"encode",value:function(e){var t=this.writeArray(e,"$");return this.writeDeferred(),t}},{key:"writeModel",value:function(e){return{$ref:e.id}}}]),o}(),jt=function(e){d(o,It);var t=pt(o);function o(){return n(this,o),t.apply(this,arguments)}return r(o,[{key:"decode",value:function(e){var t=this.readArray(e,"$");return this.readDeferred(),this.resolveRefs(),t}},{key:"resolveRefs",value:function(){var e,t=vt(this.unresolved);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=n.object,o=n.key,i=n.ref,a=n.path;if(this.refs.has(i))r[o]=this.refs.get(i);else{var s=this.island.lookUpModel(i);if(!s)throw Error("Unresolved ref: ".concat(i," at ").concat(a,"[").concat(JSON.stringify(o),"]"));r[o]=s}}}catch(e){t.e(e)}finally{t.f()}}}]),o}();function Pt(){It.resetInstance(),Tt.resetInstance(),qt.resetInstance(),jt.resetInstance()}function Nt(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return Dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dt(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Rt=M.has("debug","classes",!1),Lt=Symbol("SECRET"),Bt=new WeakSet,Ut=function(){function e(t){if(n(this,e),t!==Lt)throw Error("You must create ".concat(this,' using create() not "new"!'))}return r(e,null,[{key:"__isTeatimeModelClass__",value:function(){return!0}},{key:"create",value:function(t,n){var r=ht(),o=new this(Lt);return Object.defineProperty(o,"__realm",{value:r}),Object.defineProperty(o,"id",{value:r.register(o),enumerable:!0}),Bt.add(o),n&&o.beWellKnownAs(n),o.init(t),Bt.has(o)&&(Bt.delete(o),Object.getPrototypeOf(this)!==e&&console.warn("".concat(o," did not call super.init(options)"))),o}},{key:"createNoInit",value:function(e){var t=ht(),n=new this(Lt);return Object.defineProperty(n,"__realm",{value:t}),Object.defineProperty(n,"id",{value:e,enumerable:!0}),n}},{key:"allowConstructors",value:function(){Lt=void 0,console.warn("disabling error reporting for Model constructors")}},{key:"register",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown-file";return Pt(),oe(this),Wt(e,this.name,this),this}},{key:"registerIfNeeded",value:function(){Jt(this)||this.register()}},{key:"types",value:function(){return{}}},{key:"classToID",value:function(e){return function(e){if(Jt(e))return e[Ht];if($t(),Jt(e))return e[Ht];throw Error('Class "'.concat(e.name,'" not found, did you call ').concat(e.name,".register()?"))}(e)}},{key:"classFromID",value:function(e){return zt(e)}},{key:"allClasses",value:function(){return Vt()}},{key:"allClassTypes",value:function(){return function(){var e,t={},n=Nt(Vt());try{for(n.s();!(e=n.n()).done;){var r=e.value;Object.prototype.hasOwnProperty.call(r,"types")&&Object.assign(t,r.types())}}catch(e){n.e(e)}finally{n.f()}return Object.entries(t)}()}},{key:"instantiateClassID",value:function(e,t){return zt(e).createNoInit(t)}}]),r(e,[{key:"init",value:function(e){Bt.delete(this)}},{key:"destroy",value:function(){ht().unsubscribeAll(this),ht().deregister(this)}},{key:"publish",value:function(e,t,n){this.__realm||this.__realmError(),this.__realm.publish(t,n,e)}},{key:"subscribe",value:function(e,t,n){return this.__realm||this.__realmError(),this.__realm.subscribe(this,e,t,n)}},{key:"unsubscribe",value:function(e,t){this.__realm||this.__realmError(),this.__realm.unsubscribe(this,e,t)}},{key:"unsubscribeAll",value:function(){this.__realm||this.__realmError(),this.__realm.unsubscribeAll(this)}},{key:"__realmError",value:function(){if(!this.id)throw Error("".concat(this," has no ID, did you call super.init(options)?"))}},{key:"future",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.__realm||this.__realmError();for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return this.__realm.future(this,e,t,r)}},{key:"random",value:function(){return ht().random()}},{key:"now",value:function(){return ht().now()}},{key:"beWellKnownAs",value:function(e){ht().island.set(e,this)}},{key:"wellKnownModel",value:function(e){return this.__realm.island.get(e)}},{key:"modelOnly",value:function(e){var t="none";try{t=ht()}catch(e){}if(t===this.__realm)return!0;var n=Error(e||"".concat(this,".modelOnly() called from outside a model!"));throw He("view code",n),n}},{key:Symbol.toPrimitive,value:function(){var e=this.constructor.name;return e.includes("Model")?e:"".concat(e,"[Model]")}},{key:"sessionId",get:function(){return this.__realm.island.id}}]),e}(),Ft={},Ht=Symbol("CLASS_ID");function $t(){if(module.bundle)for(var e=0,n=Object.entries(module.bundle.cache);e<n.length;e++)for(var r=t(n[e],2),o=r[0],i=r[1],a=0,s=Object.entries(i.exports);a<s.length;a++){var c=t(s[a],2),u=c[0],l=c[1];l&&l.__isTeatimeModelClass__&&Wt(o,"default"===u?l.name:u,l)}}function Vt(){return 0===Object.keys(Ft).length&&$t(),Object.values(Ft).map(function(e){return e.cls})}function Jt(e){return Object.prototype.hasOwnProperty.call(e,Ht)}function zt(e){if(Ft[e])return Ft[e].cls;if($t(),Ft[e])return Ft[e].cls;throw Error('Class "'.concat(e,'" in snapshot, but not found in current source?'))}function Wt(e,t,n){var r="".concat(e,":").concat(t),o=Ft[r];if(o&&o.cls!==n)throw Error("Duplicate class ".concat(t," in ").concat(e));return Jt(n)?Rt&&!o&&console.warn("ignoring re-exported class ".concat(t," from ").concat(e)):(Rt&&console.log("registering class ".concat(t," from ").concat(e)),n[Ht]=r),Ft[r]={cls:n,file:e},n}var Gt=function(){function e(t){n(this,e),Object.defineProperty(this,"realm",{value:ht()}),Object.defineProperty(this,"id",{value:this.realm.register(this),configurable:!0})}return r(e,null,[{key:"displayStatus",value:function(e,t){return Fe(e,t)}},{key:"displayWarning",value:function(e,t){return Ue(e,t)}},{key:"displayError",value:function(e,t){return Be(e,t)}}]),r(e,[{key:"detach",value:function(){this.unsubscribeAll(),this.realm.deregister(this),Object.defineProperty(this,"id",{value:""})}},{key:"reattach",value:function(){Object.defineProperty(this,"id",{value:this.realm.register(this)})}},{key:"publish",value:function(e,t,n){this.realm.publish(t,n,e)}},{key:"subscribe",value:function(e,t,n){n=n.bind(this);var r=t.event?t:{event:t},o=r.event,i=r.handling;this.realm.subscribe(o,this.id,n,e,i)}},{key:"unsubscribe",value:function(e,t){this.realm.unsubscribe(t,this.id,null,e)}},{key:"unsubscribeAll",value:function(){this.realm.unsubscribeAll(this.id)}},{key:"future",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.realm.future(this,e)}},{key:"random",value:function(){return ht().random()}},{key:"now",value:function(){return this.realm.now()}},{key:"externalNow",value:function(){return this.realm.externalNow()}},{key:"update",value:function(e){}},{key:"wellKnownModel",value:function(e){return this.realm.island.get(e)}},{key:"inSameViewRealm",value:function(e){return dt(this.realm.island,e,!0)}},{key:Symbol.toPrimitive,value:function(){var e=this.constructor.name;return e.includes("View")?e:"".concat(e,"[View]")}},{key:"sessionId",get:function(){return this.realm.island.id}},{key:"viewId",get:function(){return this.realm.island.controller.viewId}}]),e}();function Kt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}var Qt=Symbol("hash"),Yt=new Map;function Xt(e,t){return Zt.apply(this,arguments)}function Zt(){return(Zt=c(s.mark(function e(t,n){return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function en(e,t){return tn.apply(this,arguments)}function tn(){return(tn=c(s.mark(function e(t,n){return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function nn(e){return M.has("debug",e,!1)}function rn(e,t){return"https://croquet.io/files/v1/sessiondata/".concat(t)}function on(e){return an.apply(this,arguments)}function an(){return(an=c(s.mark(function e(t){return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J(t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sn(e,t){return cn.apply(this,arguments)}function cn(){return(cn=c(s.mark(function e(t,n){var r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return nn("data")&&console.log("Uploading ".concat(n.byteLength," bytes to ").concat(t)),e.next=3,fetch(t,{method:"PUT",body:n});case 3:if((r=e.sent).ok){e.next=6;break}throw Error("Croquet.Data: failed to upload ".concat(t," (").concat(r.status," ").concat(r.statusText,")"));case 6:nn("data")&&console.log("Croquet.Data: uploaded (".concat(r.status," ").concat(r.statusText,") ").concat(n.byteLength," bytes to ").concat(t));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function un(e){return ln.apply(this,arguments)}function ln(){return(ln=c(s.mark(function e(t){var n;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return nn("data")&&console.log("Croquet.Data: Downloading from ".concat(t)),e.next=3,fetch(t);case 3:if(!(n=e.sent).ok){e.next=6;break}return e.abrupt("return",n.arrayBuffer());case 6:throw Error("Croquet.Data: failed to download ".concat(t," (").concat(n.status," ").concat(n.statusText,")"));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var hn=function(){var e,t;function o(e){n(this,o);var t=Yt.get(e);if(t)return nn("data")&&console.log("Croquet.Data: using cached handle for ".concat(e)),t;Object.defineProperty(this,Qt,{value:e}),Yt.set(e,this),nn("data")&&console.log("Croquet.Data: created new handle for ".concat(e))}return r(o,null,[{key:"store",value:(t=c(s.mark(function e(t,n){var r,i,a,c,u,l,h=arguments;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>2&&void 0!==h[2]&&h[2],!kt.hasCurrent()){e.next=3;break}throw Error("Croquet.Data.store() called from Model code");case 3:return null,e.next=6,Xt(null,n);case 6:return i=e.sent,e.next=9,on(i);case 9:if(a=e.sent,c=new o(a),u=rn(0,a),l=sn(u,i),c.stored||Object.defineProperty(c,"stored",{value:function(){return kt.hasCurrent()?void 0:l}}),r){e.next=17;break}return e.next=17,l;case 17:return e.abrupt("return",c);case 18:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)})},{key:"fetch",value:(e=c(s.mark(function e(t,n){var r,o,i;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!kt.hasCurrent()){e.next=2;break}throw Error("Croquet.Data.fetch() called from Model code");case 2:if("string"==typeof(r=n&&n[Qt])){e.next=5;break}throw Error("Croquet.Data.fetch() called with invalid handle");case 5:return o=rn(0,r),e.next=8,un(o);case 8:return i=e.sent,e.abrupt("return",en(null,i));case 11:case"end":return e.stop()}},e)})),function(t,n){return e.apply(this,arguments)})}]),o}();function fn(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dn(e,t):void 0}}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}(function(e){d(o,Ut);var t=Kt(o);function o(){return n(this,o),t.apply(this,arguments)}return r(o,null,[{key:"types",value:function(){return{"@croquet.data":{cls:hn,write:function(e){return e[Qt]},read:function(e){return new hn(e)}}}}}]),o})().register();var yn=require("pako"),mn=b;console.log("Croquet SDK "+mn);var gn=window.location.hostname.endsWith("croquet.io")?"".concat(window.location.host,"/reflector"):"croquet.io/reflector",wn="wss://".concat(gn,"/v").concat(1),bn=null,kn=M.nocheat,Sn=["tps"];function xn(){return Math.floor(Math.random()*Math.pow(2,53)).toString(36)}var Cn=new Set,En=function(){function e(){n(this,e),this.reset()}var i,a,l,h,f,d,p,v;return r(e,[{key:"reset",value:function(){window.ISLAND===this.island&&delete window.ISLAND,this.island=null,this.connection=this.connection||new On(this),this.networkQueue=new le,this.time=0,this.session="",this.viewId=this.viewId||xn(),this.users=0,this.usersTotal=0,this.cpuTime=0,this.triggeringCpuTime=null,this.synced=null,this.latency=0,this.latencyHistory&&(this.latencyHistory=[]),this.localTicker&&(window.clearInterval(this.localTicker),delete this.localTicker),this.syncTimer&&(window.clearTimeout(this.syncTimer),delete this.syncTimer),this.tuttiHistory=[],at.removeAllSubscriptionsFor(this.viewId),at.addSubscription(this.viewId,"__users__",this.viewId,function(e){return Fe("users now ".concat(e.count))},"oncePerFrameWhileSynced"),this.leaving||et.showSyncWait(!0)}},{key:"checkForConnection",value:function(e){this.connection.checkForConnection(e)}},{key:"dormantDisconnect",value:function(){this.connected&&this.connection.dormantDisconnect()}},{key:"establishSession",value:(v=c(s.mark(function e(t,n){var r,i,a,c,u,l,h,f,d,p,v,y,m,g,w,b,k,S,x;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(bn={messages:M.has("debug","messages",!1),sends:M.has("debug","sends",!1),ticks:M.has("debug","ticks",!1),pong:M.has("debug","pong",!1),snapshot:M.has("debug","snapshot",!1),session:M.has("debug","session",!1),initsnapshot:M.has("debug","initsnapshot","localhost"),reflector:M.has("debug","reflector",M.dev||"localhost")},r=n.optionsFromUrl,i=n.multiRoom,a=n.autoSession,c=n.login,u=vn({},n.options),l=0,h=[].concat(Sn,o(r||[]));l<h.length;l++)(f=h[l])in M&&(u[f]=M[f]);if(!c){e.next=7;break}return e.next=7,I();case 7:return a&&(d=t,p=M.getSession().split("/"),v=i?p[1]:p[0],y=i?p[2]:p[1],(m=!v||!y)&&(a.user&&(v=a.user),a.random&&(y=a.random),v||(v=T("name","").toLowerCase()||"GUEST"),y||(y=xn())),this.session=i?"".concat(d,"/").concat(v,"/").concat(y):"".concat(v,"/").concat(y),i||(M.setSession(this.session,m),et.sessionURL=window.location.href),t="".concat(d,"/").concat(v,"/").concat(y)),e.next=10,ie(t,u,mn);case 10:return g=e.sent,w=g.id,b=g.sessionHash,k=g.codeHash,console.log('Session ID for "'.concat(t,'": ').concat(w)),this.islandCreator=vn(vn({},n),{},{options:u,name:t,sessionHash:b,codeHash:k}),S=!1,this.islandCreator.snapshot?this.islandCreator.snapshot.id!==w&&(x=this.islandCreator.snapshot.sessionHash===b,console.warn("Existing snapshot was for different ".concat(x?"code base":"session","!")),S=!0):S=!0,S&&(this.islandCreator.snapshot={id:w,time:0,meta:{id:w,sessionHash:b,codeHash:k,created:(new Date).toISOString()}}),e.next=21,this.join();case 21:return e.next=23,this.startedOrSynced();case 23:return e.abrupt("return",this.island.modelsByName);case 24:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"lastKnownTime",value:function(e){return Math.max(e.time,e.externalTime)}},{key:"handleSyncCheckVote",value:function(e){if(!0===this.synced){var t=e._local,n=e.tally,r=Object.keys(n);t&&r.includes(t)?r.length>1?console.log(r):console.log("ok"):console.log(this.id,"Sync: local vote not found",t,n)}}},{key:"takeSnapshot",value:function(){var e=this.island.snapshot(),t=this.lastKnownTime(e),n=e.externalSeq;return e.meta=vn(vn({},this.islandCreator.snapshot.meta),{},{options:this.islandCreator.options,time:t,seq:n,date:(new Date).toISOString(),host:window.location.hostname,sdk:mn}),delete e.meta.hash,e}},{key:"scheduleSnapshot",value:function(){if(this.island){var e=this.island.time,t=e-this.island.lastSnapshotPoll;if(t<5e3)bn.snapshot&&console.log("not requesting snapshot poll (".concat(t,"ms since poll scheduled)"));else{var n=new _t(e,0,this.island.id,"pollForSnapshot",[]);this.sendTagged(n,{debounce:5e3,msgID:"pollForSnapshot"}),bn.snapshot&&console.log(this.id,"Controller scheduling snapshot via reflector")}}}},{key:"preparePollForSnapshot",value:function(){var e=this.triggeringCpuTime||this.cpuTime;return this.triggeringCpuTime=null,this.cpuTime=0,!0===this.synced?{cpuTime:e}:null}},{key:"pollForSnapshot",value:function(e,t,n){n.cpuTime+=Math.random();var r=[this.id,"handleSnapshotVote","snapshotVote"];this.sendTutti(e,t,n,null,!0,r)}},{key:"handleSnapshotVote",value:function(e){var t=this;if(!0===this.synced){var n=e._local,r=e.tally,o=Object.keys(r);if(!n||!o.includes(n))return bn.snapshot&&console.log(this.id,"Snapshot: local vote not found"),void(this.cpuTime=0);var i=o.map(function(e){return JSON.parse(e)}),a={};i.forEach(function(e,t){var n=e.hash;a[n]||(a[n]=[]),a[n].push(t)});var s=Object.keys(a),c=s[0];s.length>1&&(bn.snapshot&&console.log(this.id,"Snapshots fall into ".concat(s.length," groups")),s.sort(function(e,t){return a[t].length-a[e].length}),a[s[0]].length===a[s[1]].length&&(bn.snapshot&&console.log(this.id,"Deciding consensus by tie-break"),c=s[0]<s[1]?s[0]:s[1])),s.forEach(function(e){return function(e,r){var s=a[e];s.length>1&&s.sort(function(e,t){return i[e].cpuTime-i[t].cpuTime});var c=s[0];o[c]===n&&t.serveSnapshot(r)}(e,e===c)})}else bn.snapshot&&console.log("Ignoring snapshot vote during sync")}},{key:"serveSnapshot",value:function(e){var t=Me.begin("snapshot"),n=this.takeSnapshot(),r=Me.end("snapshot")-t;this.cpuTime-=r,bn.snapshot&&console.log(this.id,"Snapshotting took ".concat(Math.ceil(r)," ms")),this.uploadSnapshot(n,e)}},{key:"snapshotUrl",value:function(e,t,n,r,o){var i,a="".concat(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"code",t=M.has("dev","host","localhost")?"dev/".concat(T("name","GUEST"),"/"):"";return"".concat(L(),"/").concat(t).concat(e,"/")}("snapshots")).concat(this.id),s=".json".concat(o?"."+o:""),c="".concat((i=Math.round(t),(""+i).padStart(10,"0")),"_").concat(n,"-").concat(e,"-").concat(r).concat(s);return"".concat(a,"/").concat(c)}},{key:"hashSnapshot",value:function(e){return e.meta.hash?e.meta.hash:(e.meta.hashPromise||(e.meta.hashPromise=new Promise(function(t){var n=vn({},e);delete n.meta,X(JSON.stringify(n)).then(function(n){e.meta.hash=n,delete e.meta.hashPromise,t(n)})})),e.meta.hashPromise)}},{key:"uploadSnapshot",value:(p=c(s.mark(function e(t){var n,r,o,i,a,c,u,l,h,f,d,p=arguments;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(p.length>1&&void 0!==p[1])||p[1],e.next=3,this.hashSnapshot(t);case 3:return r=Date.now(),o=JSON.stringify(t),i=Date.now()-r,a=t.meta,c=a.time,u=a.seq,l=a.hash,h=this.snapshotUrl("snap",c,u,l,"gz"),bn.snapshot&&console.log(this.id,"Controller uploading snapshot (".concat(o.length," bytes, ").concat(i,"ms) to ").concat(h)),f=this.connection.socket,e.next=12,this.uploadGzipped(h,o);case 12:if(d=e.sent,this.connection.socket===f){e.next=16;break}return console.error("Controller was reset while trying to upload snapshot"),e.abrupt("return",!1);case 16:if(d){e.next=19;break}return console.error("Failed to upload snapshot"),e.abrupt("return",!1);case 19:return n&&this.announceSnapshotUrl(c,u,l,h),e.abrupt("return",!0);case 21:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"announceSnapshotUrl",value:function(e,t,n,r){bn.snapshot&&console.log(this.id,"Controller sending snapshot url to reflector (time: ".concat(e,", seq: ").concat(t,", hash: ").concat(n,"): ").concat(r));try{this.connection.send(JSON.stringify({id:this.id,action:"SNAP",args:{time:e,seq:t,hash:n,url:r}}))}catch(e){console.error("ERROR while sending",e)}}},{key:"fetchJSON",value:(d=c(s.mark(function e(t,n){var r,o,i;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{mode:"cors"});case 3:if(r=e.sent,!t.endsWith(".gz")){e.next=10;break}return e.next=7,r.arrayBuffer();case 7:return o=e.sent,i=yn.inflate(new Uint8Array(o),{to:"string"}),e.abrupt("return",JSON.parse(i));case 10:return e.next=12,r.json();case 12:return e.abrupt("return",e.sent);case 15:e.prev=15,e.t0=e.catch(0);case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,null,[[0,15]])})),function(e,t){return d.apply(this,arguments)})},{key:"uploadJSON",value:(f=c(s.mark(function e(t,n){var r,o;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,{method:"PUT",mode:"cors",headers:{"Content-Type":"application/json"},body:n});case 3:return r=e.sent,o=r.ok,e.abrupt("return",o);case 8:e.prev=8,e.t0=e.catch(0);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e,t){return f.apply(this,arguments)})},{key:"uploadGzipped",value:(h=c(s.mark(function e(t,n){var r,o,i,a,c;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Date.now(),o=(new TextEncoder).encode(n),i=yn.gzip(o,{level:1}),bn.snapshot&&console.log("Snapshot gzipping took ".concat(Date.now()-r,"ms")),e.prev=4,e.next=7,fetch(t,{method:"PUT",mode:"cors",headers:{"Content-Type":"application/octet-stream"},body:i});case 7:return a=e.sent,c=a.ok,e.abrupt("return",c);case 12:e.prev=12,e.t0=e.catch(4);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}},e,null,[[4,12]])})),function(e,t){return h.apply(this,arguments)})},{key:"convertReflectorMessage",value:function(e){var n=this.id,r="noop",o=[];switch(e[2].what){case"users":var i=e[2],a=i.joined,s=i.left,c=i.active,u=i.total;this.users=c,this.usersTotal=u;var l,h=this.id,f={entered:a||[],exited:s||[],count:c},d=fn(f.entered);try{for(d.s();!(l=d.n()).done;){var p=l.value;p.length>2&&(p.length=2)}}catch(e){d.e(e)}finally{d.f()}n=this.id,r="publishFromModel",o=[h,"__users__",f],at.handleEvent(this.viewId+":__users__",f);break;case"tally":var v=e[2],y=v.tuttiSeq,m=v.tally,g=v.tallyTarget,w={tuttiSeq:y,tally:m},b=this.tuttiHistory.find(function(e){return e.tuttiSeq===y});b&&(w._local=b.payload);var k=t(g,3);n=k[0],r=k[1],o=[k[2],w]}var S=new _t(0,0,n,r,o);e[2]=S.asState()[2]}},{key:"receive",value:(l=c(s.mark(function e(t,n){var r,o,i,a,c,u,l,h,f,d,p,v,y=this;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.lastReceived=this.connection.lastReceived,e.t0=t,e.next="START"===e.t0?4:"SYNC"===e.t0?13:"RECV"===e.t0?32:"TICK"===e.t0?40:"LEAVE"===e.t0?47:50;break;case 4:return bn.session&&console.log(this.id,"Controller received START"),this.install(),r=this.takeSnapshot(),e.next=9,this.uploadSnapshot(r,!0);case 9:return o=e.sent,this.islandCreator.startedOrSynced.resolve(this.island),o?this.requestTicks():this.connection.closeConnectionWithError("start","failed to establish session"),e.abrupt("return");case 13:i=n.messages,a=n.url,c=n.time,bn.session&&console.log(this.id,"Controller received SYNC: time ".concat(c,", ").concat(i.length," messages, ").concat(a)),u=fn(i);try{for(u.s();!(l=u.n()).done;)h=l.value,bn.messages&&console.log(this.id,"Controller received message in SYNC "+JSON.stringify(h)),h[1]>>>=0,"string"!=typeof h[2]&&this.convertReflectorMessage(h),this.networkQueue.put(h),this.timeFromReflector(h[0])}catch(e){u.e(e)}finally{u.f()}return this.timeFromReflector(c),bn.session&&console.log("".concat(this.id," fetching snapshot ").concat(a)),e.next=21,this.fetchJSON(a);case 21:if(f=e.sent,this.islandCreator.snapshot=f,this.connected){e.next=26;break}return console.log(this.id,"socket went away during SYNC"),e.abrupt("return");case 26:return this.install(),bn.session&&console.log("".concat(this.id," fast forwarding from ").concat(Math.round(this.island.time)," to ").concat(c)),this.getTickAndMultiplier(),d=function e(){y.simulate(Date.now()+200)?(bn.session&&console.log("".concat(y.id," fast forwarded to ").concat(Math.round(y.island.time))),y.islandCreator.startedOrSynced.resolve(y.island)):setTimeout(e,0)},setTimeout(d,0),e.abrupt("return");case 32:return bn.messages&&console.log(this.id,"Controller received RECV "+JSON.stringify(n)),"string"!=typeof(p=n)[2]&&this.convertReflectorMessage(p),p[1]>>>=0,p[3]===this.viewId&&this.addToStatistics(p[4],this.lastReceived),this.networkQueue.put(p),this.timeFromReflector(p[0]),e.abrupt("return");case 40:if(this.island){e.next=42;break}return e.abrupt("return");case 42:return v="number"==typeof n?n:n.time,bn.ticks&&console.log(this.id,"Controller received TICK "+v),this.timeFromReflector(v),this.tickMultiplier&&this.multiplyTick(v),e.abrupt("return");case 47:return console.log(this.id,"Controller received LEAVE"),this.leave(),e.abrupt("return");case 50:console.warn("Unknown action:",t,n);case 51:case"end":return e.stop()}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"install",value:function(){bn.session&&console.log("".concat(this.id," installing island"));var e=this.islandCreator,t=e.snapshot,n=e.init,r=e.options,o=new kt(t,function(){try{return n(r)}catch(e){throw He("init",e),e}});if(bn.initsnapshot&&!t.modelsById){var i=JSON.stringify(o.snapshot());o=new kt(JSON.parse(i),function(){return n(r)})}var a=this.lastKnownTime(o);this.time=Math.max(this.time,a),this.setIsland(o)}},{key:"setIsland",value:function(e){this.island=e,this.island.controller=this}},{key:"createCleanIsland",value:function(){var e=this.islandCreator,t=e.options,n=e.init,r={id:this.id};return new kt(r,function(){return n(t)})}},{key:"join",value:(a=c(s.mark(function e(){var t,n,r,o;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkForConnection(!1),e.next=3,this.connection.connectionPromise;case 3:Cn.add(this),bn.session&&console.log(this.id,"Controller sending JOIN"),t=this.user,n=t.name,r=t.id,o={name:this.islandCreator.name,version:1,user:[r,n],url:et.sessionURL,codeHash:this.islandCreator.codeHash,sdk:mn},this.connection.send(JSON.stringify({id:this.id,action:"JOIN",args:o}));case 8:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"startedOrSynced",value:(i=c(s.mark(function e(){var t=this;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){return t.islandCreator.startedOrSynced={resolve:e,reject:n}}));case 1:case"end":return e.stop()}},e)})),function(){return i.apply(this,arguments)})},{key:"leave",value:function(){this.connected&&(console.log(this.id,"Controller LEAVING session for ".concat(this.islandCreator.name)),this.connection.send(JSON.stringify({id:this.id,action:"LEAVING"})));var e=this.islandCreator.destroyerFn;if(this.reset(),Cn.delete(this),!this.islandCreator)throw Error("do not discard islandCreator!");e&&e()}},{key:"sendMessage",value:function(e){this.connected&&(this.viewOnly||(bn.sends&&console.log(this.id,"Controller sending SEND ".concat(e.asState())),this.lastSent=Date.now(),this.connection.send(JSON.stringify({id:this.id,action:"SEND",args:[].concat(o(e.asState()),[this.viewId,this.lastSent,this.latency])}))))}},{key:"sendTagged",value:function(e,t){this.connected&&(this.viewOnly||(bn.sends&&console.log(this.id,"Controller sending tagged SEND ".concat(e.asState()," with tags ").concat(JSON.stringify(t))),this.lastSent=Date.now(),this.connection.send(JSON.stringify({id:this.id,action:"SEND",args:[].concat(o(e.asState()),[this.viewId,this.lastSent]),tags:t}))))}},{key:"sendTutti",value:function(e,t,n,r,o,i){if(this.connected&&!this.viewOnly){var a=u(n);bn.sends&&console.log(this.id,"Controller sending TUTTI ".concat(a," ").concat(r&&r.asState()," ").concat(i)),this.tuttiHistory.push({tuttiSeq:t,payload:a}),this.tuttiHistory.length>100&&this.tuttiHistory.shift(),this.lastSent=Date.now(),this.connection.send(JSON.stringify({id:this.id,action:"TUTTI",args:[e,t,a,r&&r.asState(),o,i]}))}}},{key:"sendVote",value:function(e,t,n){var r=[this.island.id,"handleModelEventInView",this.island.id+":"+t];this.sendTutti(this.island.time,e,n,null,!0,r)}},{key:"addToStatistics",value:function(e,t){this.latency=t-e,this.latencyHistory&&(this.latencyHistory.length>=100&&this.latencyHistory.shift(),this.latencyHistory.push({time:t,ms:this.latency}))}},{key:"getTickAndMultiplier",value:function(){var e=this.islandCreator.options,n=(("tps"in e?e.tps:"tps"in this.islandCreator?this.islandCreator.tps:20)+"x").split("x").map(function(e){return Number.parseInt("0"+e,10)}),r=t(n,2),o=r[0],i=r[1],a=1e3/Math.max(1,Math.min(60,o)),s=Math.max(1,i);return s>1&&!kn&&(this.tickMultiplier={tick:a,multiplier:s}),{tick:a,multiplier:s}}},{key:"requestTicks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.connected&&this.island){var t=this.getTickAndMultiplier(),n=t.tick,r=t.multiplier;e.tick=n,e.delay=n*(r-1)/r,bn.session&&console.log(this.id,"Controller requesting TICKS",e);try{this.connection.send(JSON.stringify({id:this.id,action:"TICKS",args:e}))}catch(e){console.error("ERROR while sending",e)}}}},{key:"simulate",value:function(e){var t=this;if(!this.island)return!0;try{for(var n=Me.begin("simulate"),r=!0;r;){var o=this.networkQueue.peek();if(!o)break;if(!(r=this.island.advanceTo(o[0],e)))break;this.networkQueue.nextNonBlocking();var i=this.island.scheduleExternalMessage(o);r=this.island.advanceTo(i.time,e),this.cpuTime+=5}r&&(r=this.island.advanceTo(this.time,e)),this.cpuTime+=Math.max(.01,Me.end("simulate")-n);var a=this.backlog;return Me.backlog(a),"boolean"==typeof this.synced&&(this.synced&&a>1e3||!this.synced&&a<100)&&(this.synced?this.applySyncChange(!1):this.syncTimer||(this.syncTimer=setTimeout(function(){delete t.syncTimer,t.backlog<100&&t.applySyncChange(!0)},200))),r&&this.cpuTime>5e3&&(this.triggeringCpuTime=this.cpuTime,this.cpuTime=0,setTimeout(function(){return t.scheduleSnapshot()},Math.floor(2e3*Math.random()))),r}catch(e){return He("simulate",e),this.connection.closeConnectionWithError("simulate",e),"error"}}},{key:"applySyncChange",value:function(e){this.synced=e,et.showSyncWait(!e),this.island.publishFromView(this.viewId,"synced",e)}},{key:"inViewRealm",value:function(e){var t=this;return dt(this.island,function(){return e(t.island)})}},{key:"processModelViewEvents",value:function(){return this.island?this.island.processModelViewEvents():0}},{key:"timeFromReflector",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"reflector";e<this.time?("controller"!==t||bn.ticks)&&console.warn("time is ".concat(this.time,", ignoring time ").concat(e," from ").concat(t)):("boolean"!=typeof this.synced&&(this.synced=!1),this.time=e,this.island&&Me.backlog(this.backlog),this.tickHook&&this.tickHook())}},{key:"multiplyTick",value:function(e){var t=this;this.localTicker&&window.clearInterval(this.localTicker);var n=this.tickMultiplier,r=n.tick,o=n.multiplier,i=r/o,a=1;this.localTicker=window.setInterval(function(){t.timeFromReflector(e+a*i,"controller"),bn.ticks&&console.log(t.id,"Controller generate TICK "+t.time,a),++a>=o&&(window.clearInterval(t.localTicker),t.localTicker=0)},i)}},{key:"id",get:function(){return this.island?this.island.id:this.islandCreator.snapshot.id}},{key:"user",get:function(){return{id:this.viewId,name:T("name","GUEST")}}},{key:"viewOnly",get:function(){return this.islandCreator.viewOnly}},{key:"backlog",get:function(){return this.island?this.time-this.island.time:0}},{key:"starvation",get:function(){return Date.now()-this.lastReceived}},{key:"activity",get:function(){return Date.now()-this.lastSent}},{key:"connected",get:function(){return this.connection.connected}},{key:"latencies",get:function(){return this.latencyHistory||(this.latencyHistory=[]),this.latencyHistory}}]),e}(),On=function(){function e(t){n(this,e),this.controller=t,this.connectBlocked=!1,this.connectRestricted=!1,this.connectHasBeenCalled=!1,this.setUpConnectionPromise()}var t;return r(e,[{key:"setUpConnectionPromise",value:function(){var e=this;this.connectionPromise=new Promise(function(t){return e.resolveConnection=t})}},{key:"checkForConnection",value:function(e){this.socket||this.connectHasBeenCalled||this.connectBlocked||this.connectRestricted&&!e||this.connectToReflector()}},{key:"connectToReflector",value:(t=c(s.mark(function e(){var t,n=this;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectHasBeenCalled=!0,this.connectBlocked=!1,this.connectRestricted=!1,(t=M.reflector||(bn.reflector?"wss://croquet.io/reflector-dev/dev":wn)).match(/^wss?:/)){e.next=6;break}throw Error("Cannot interpret reflector address "+t);case 6:return t.endsWith("/")||(t+="/"),e.abrupt("return",new Promise(function(e){var r=Object.assign(new WebSocket("".concat(t).concat(n.controller.id)),{onopen:function(t){n.socket=r,(bn.session||bn.reflector)&&console.log(n.socket.constructor.name,"connected to",n.socket.url),Me.connected(!0),n.resolveConnection(null),e()},onmessage:function(e){n.receive(e.data)},onerror:function(e){Be("Connection error"),console.log(r.constructor.name,"error")},onclose:function(e){var t=1e3!==e.code&&e.code<4100,o=4110===e.code;o||1e3===e.code||Be("Connection closed: ".concat(e.code," ").concat(e.reason),{duration:t?void 0:36e5}),bn.session&&console.log(r.constructor.name,"closed:",e.code,e.reason),Me.connected(!1),o?n.connectRestricted=!0:n.connectBlocked=!0,n.disconnected(),t&&(Ue("Reconnecting ..."),window.setTimeout(function(){return n.connectToReflector()},2e3))}})}));case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"disconnected",value:function(){this.socket&&(this.socket=null,this.lastReceived=0,this.lastSent=0,this.connectHasBeenCalled=!1,this.setUpConnectionPromise(),this.controller.leave())}},{key:"send",value:function(e){this.lastSent=Date.now(),this.socket.send(e)}},{key:"receive",value:function(e){this.lastReceived=Date.now();var t=JSON.parse(e),n=t.id,r=t.action,o=t.args;if(n)try{this.controller.receive(r,o)}catch(e){this.closeConnectionWithError("receive",e)}else switch(r){case"PONG":bn.pong&&console.log("PONG after",Date.now()-o,"ms");break;default:console.warn("Unknown action",r)}}},{key:"dormantDisconnect",value:function(){this.connected&&(console.log("dormant; disconnecting from reflector"),this.socket.close(4110,"Going dormant"))}},{key:"closeConnectionWithError",value:function(e,t){console.error(t),console.warn("closing socket"),this.socket.close(4e3,"Error in "+e)}},{key:"PING",value:function(){this.connected&&(this.socket.bufferedAmount?console.log("Reflector connection stalled: ".concat(this.socket.bufferedAmount," bytes unsent")):this.send(JSON.stringify({action:"PING",args:Date.now()})))}},{key:"PULSE",value:function(){this.connected&&(this.socket.bufferedAmount&&console.log("Reflector connection stalled: ".concat(this.socket.bufferedAmount," bytes unsent")),this.send(JSON.stringify({action:"PULSE"})))}},{key:"keepAlive",value:function(){0!==this.lastReceived&&(Date.now()-this.lastReceived>100?this.PING():Date.now()-this.lastSent>2e4&&this.PULSE())}},{key:"connected",get:function(){return this.socket&&this.socket.readyState===WebSocket.OPEN}}]),e}();window.setInterval(function(){var e,t=fn(Cn);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.connected&&n.connection.keepAlive()}}catch(e){t.e(e)}finally{t.f()}},100);var _n={},An=function(){function e(){n(this,e)}var i,a;return r(e,null,[{key:"join",value:(a=c(s.mark(function n(r){var i,a,u,l,h,f,d,p,v,y,m,g,w,b,k,S,x,C,E,O,_,A,T,I=arguments;return s.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(T=function(){setInterval(function(){if("hidden"===document.visibilityState)if(!1===M.autoSleep)qn(performance.now(),y,x.view);else{var e=Date.now();d?e-d>1e4&&y.dormantDisconnect():d=e}else d=null},1e3)},A=function(e){return{modelRoot:i.create(e,"modelRoot")}},_=function(){x.model=null,x.view&&(M.has("debug","session",!1)&&console.log(x.id,"Detaching root view"),x.view.detach(),""!==x.view.id&&console.warn("".concat(x.view," did not call super.detach()")),x.view=null),et.clearSessionMoniker()},O=function(){return(O=c(s.mark(function e(n){var o,i,c,l,h,f;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_(),!y.leaving){e.next=4;break}return y.leaving(!0),e.abrupt("return");case 4:for(o={snapshot:n,init:A,destroyerFn:E,options:m},i=0,c=Object.entries(u);i<c.length;i++)l=t(c[i],2),h=l[0],f=l[1],v.includes(h)&&(o[h]=f);return e.next=8,y.establishSession(r,o);case 8:x.model=e.sent.modelRoot,x.id=y.id,_n[x.id]=y,et.makeSessionWidgets(x.id),y.inViewRealm(function(){M.has("debug","session",!1)&&console.log(x.id,"Creating root view"),x.view=new a(x.model)});case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)},E=function(e){return O.apply(this,arguments)},l=function(e,t){return e===t||e.prototype instanceof t},i=I.length>1&&void 0!==I[1]?I[1]:Ut,a=I.length>2&&void 0!==I[2]?I[2]:Gt,u=I.length>3?I[3]:void 0,"string"!=typeof r?r=JSON.stringify(r)||"undefined":r||(r="unnamed"),l(i,Ut)){n.next=12;break}throw Error("ModelRoot must inherit from Croquet.Model");case 12:if(l(a,Gt)){n.next=19;break}if(!a||Object.getPrototypeOf(a)!==Object.prototype||void 0!==u){n.next=18;break}u=a,a=Gt,n.next=19;break;case 18:throw Error("ViewRoot must inherit from Croquet.View");case 19:u||(u={}),(h=M.reflector||u.reflector)&&(h.includes("://")?M.reflector=h:console.warn('Not a valid websocket url, ignoring reflector "'.concat(h,'"'))),u.debug&&(f=function(e){return"string"==typeof e&&(e=e.split(",")),e?Array.isArray(e)?e:[e]:[]},M.debug=[].concat(o(f(u.debug)),o(f(M.debug))).join(",")),d=null,"autoSleep"in u&&(M.autoSleep=u.autoSleep),T(),"expectedSimFPS"in u&&(In=Math.min(u.expectedSimFPS,Tn)),p=["tps"],v=["optionsFromUrl","login","autoSession"],Pn(),y=new En,m={},u.options&&Object.assign(m,JSON.parse(JSON.stringify(u.options)));for(g=0,w=Object.entries(u);g<w.length;g++)b=t(w[g],2),k=b[0],S=b[1],p.includes(k)&&(m[k]=S);return n.t0=function(e){"hidden"!==document.visibilityState&&(d=null,qn(e,y,x.view))},n.t1=function(){e.leave(x.id)},x={id:"",model:null,view:null,step:n.t0,leave:n.t1,get latency(){return y.latency},get latencies(){return y.latencies}},n.next=39,E();case 39:return"manual"!==u.step&&(C=function e(t){x.step(t),window.requestAnimationFrame(e)},window.requestAnimationFrame(C)),n.abrupt("return",x);case 41:case"end":return n.stop()}},n)})),function(e){return a.apply(this,arguments)})},{key:"leave",value:(i=c(s.mark(function e(t){var n,r,o;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=_n[t]){e.next=3;break}return e.abrupt("return",!1);case 3:if(delete _n[t],r=new Promise(function(e){return n.leaving=e}),(o=n.connection).connected){e.next=8;break}return e.abrupt("return",!1);case 8:return o.socket.close(1e3),e.abrupt("return",r);case 10:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)})}]),e}(),Mn=[0],Tn=120,In=60;function qn(e,t,n){t.checkForConnection(!0);var r=t.backlog,o=t.latency,i=t.starvation,a=t.activity;if(Me.animationFrame(e,{backlog:r,starvation:i,latency:o,activity:a,users:t.users}),t.island){var s=Date.now(),c=Mn.reduce(function(e,t){return e+t},0)/Mn.length;t.simulate(s+Math.min(c,200));var u=0===In?0:1e3/In*4;t.backlog>u&&t.simulate(s+200-c),Mn.push(Date.now()-s),Mn.length>4&&Mn.shift(),Me.begin("update"),t.processModelViewEvents(),Me.end("update"),n&&(Me.begin("render"),t.inViewRealm(function(){return n.update(e)}),Me.end("render"))}}var jn={};function Pn(){Object.isFrozen(jn)||(function e(t){if(!Object.isFrozen(t)){Object.freeze(t);for(var n=0,r=Object.values(t);n<r.length;n++){var o=r[n];!o||"object"!==i(o)&&"function"!=typeof o||e(o)}}}(jn),function(e){var t=JSON.stringify(e,function(e,t){return"function"==typeof t?""+t:t});if("{}"!==t){var n=JSON.parse(t),r=X(u(n));r.then(function(e){console.log("hashing Croquet.Constants(".concat(Object.keys(n).join(", "),"): ").concat(e)),W()&&(G[e].name="Croquet Constants")}),re.push(r)}}(jn))}exports.App=et,exports.Constants=jn,exports.Data=hn,exports.Model=Ut,exports.Session=An,exports.View=Gt,exports.gatherInternalClassTypes=function(e,t){var n={};return function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set,a=Object.values(t).filter(function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return("Object"===t||"Array"===t)&&!i.has(e)}),s=vt(a);try{for(s.s();!(n=s.n()).done;){var c=n.value;i.add(c);var u=r+"."+c.constructor.name;if(o[u]){if(o[u]!==c.constructor)throw new Error("Class with name "+u+" already gathered, but new one has different identity")}else o[u]=c.constructor}}catch(e){s.e(e)}finally{s.f()}var l,h=vt(a);try{for(h.s();!(l=h.n()).done;){e(l.value,r,o,i)}}catch(e){h.e(e)}finally{h.f()}}({root:e},t,n,new Set),n},exports.startSession=function(){return et.showMessage("Croquet.startSession() is deprecated, please use Croquet.Session.join()",{level:"warning",only:"once"}),An.join.apply(An,arguments)};
},{"@babel/runtime/helpers/slicedToArray":"qmoa","@babel/runtime/helpers/classCallCheck":"rsNN","@babel/runtime/helpers/createClass":"rYje","@babel/runtime/helpers/toConsumableArray":"wyMK","@babel/runtime/helpers/typeof":"RTfL","@babel/runtime/helpers/defineProperty":"PLl6","@babel/runtime/regenerator":"wCDd","@babel/runtime/helpers/asyncToGenerator":"zdnk","fast-json-stable-stringify":"vwDV","toastify-js":"D2QR","seedrandom/seedrandom":"u80Q","@babel/runtime/helpers/get":"V9yb","@babel/runtime/helpers/inherits":"NdUb","@babel/runtime/helpers/possibleConstructorReturn":"Guyn","@babel/runtime/helpers/getPrototypeOf":"Mrsy","fastpriorityqueue":"wmWq","@babel/runtime/helpers/toArray":"AhBs","@babel/runtime/helpers/construct":"lHWF","pako":"JWfd"}],"rjjY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@croquet/croquet");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});
},{"@croquet/croquet":"nlD3"}]},{},["rjjY"], "Croquet")
//# sourceMappingURL=croquet-0.3.0.min.js.map